31476080
How to query and apply filter on a field that has multi_field type
<p>I am going through the documentation and understood that multi_field is used to apply different analyzers on one field. </p>&#xA;&#xA;<pre><code>{&#xA;"tweet" : {&#xA;    "properties" : {&#xA;        "name" : {&#xA;            "type" : "multi_field",&#xA;            "fields" : {&#xA;                "name" : {"type" : "string", "index" : "analyzed"},&#xA;                "untouched" : {"type" : "string", "index" : "not_analyzed"}&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>}</p>&#xA;&#xA;<p>I have indexed the data as follows </p>&#xA;&#xA;<pre><code>/tweet/1   { &#xA;  "name" : "anil"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And I am searching for the same as follows.</p>&#xA;&#xA;<pre><code>/&lt;indexname&gt;/_search&#xA;</code></pre>&#xA;&#xA;<p>I am getting the data as follows. </p>&#xA;&#xA;<pre><code>hits : [&#xA;{&#xA;           "_index" : ...&#xA;           ....&#xA;           "_source" : {&#xA;                  "name" : "anil" &#xA;          }&#xA; }&#xA;]&#xA;</code></pre>&#xA;&#xA;<p>So far this is good. </p>&#xA;&#xA;<p>Now I am looking for match. </p>&#xA;&#xA;<pre><code>GET &lt;indexname&gt;/_search&#xA;   {&#xA;          "query": {&#xA;              "match": {&#xA;                 "name": "anil"&#xA;              }&#xA;           }&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>The above one works fine since I have the analyzer applied on it. </p>&#xA;&#xA;<p>My question is, If I want to apply filter with exact string, I am getting 0 hits. </p>&#xA;&#xA;<pre><code>GET &lt;indexname&gt;/_search&#xA;        {&#xA;           "query": {&#xA;                   "filtered": {&#xA;                         "query": {&#xA;                              "match_all": {}&#xA;                          },&#xA;                          "filter": {&#xA;                                  "term": {&#xA;                                        "name" : "anil"&#xA;                                    }&#xA;                          }&#xA;                   }&#xA;               }&#xA;         }&#xA;</code></pre>&#xA;&#xA;<p>Please suggest what to do. </p>&#xA;
<p>Have you tried this?</p>&#xA;&#xA;<pre><code>GET &lt;indexname&gt;/_search&#xA;    {&#xA;       "query": {&#xA;               "filtered": {&#xA;                     "query": {&#xA;                          "match_all": {}&#xA;                      },&#xA;                      "filter": {&#xA;                              "term": {&#xA;                                    "name.untouched" : "anil"&#xA;                                }&#xA;                      }&#xA;               }&#xA;           }&#xA;     }&#xA;</code></pre>&#xA;&#xA;<p>Also, you don't have to use multi_fields anymore, you can just use fields, as explained <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/_multi_fields.html?q=multi_fiel" rel="nofollow">here</a>, but I don't think that's the cause of your problem.</p>&#xA;
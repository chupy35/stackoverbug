32635456
Is it possible to limit a size of an Elasticsearch index?
<p>I have an Elasticsearch instance for indexing log records. Naturally the data grows over time and I would like to limit its size(about 10GB). Something like a mongoDb capped collection.</p>&#xA;&#xA;<p>I'm not interested in old log records anyway.</p>&#xA;&#xA;<p>I haven't found any config for this and I'm not sure that I can just remove data files.</p>&#xA;&#xA;<p>any suggestions ?</p>&#xA;
<p>From what I remember a capped collection in MongoDB was just a circular buffer type of collection that removes oldest entries when there's no more room? Unfortunately there's nothing like this out of the box in ElasticSearch, you have to add this functionality yourself either by removing single documents (or batches of documents) using ES's API. A more performant way is described in their documentation under <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/retiring-data.html?q=retiring%20data" rel="nofollow">retiring data.</a></p>&#xA;
<p>You can provide a per index/type default _ttl(time to live) value as follows:</p>&#xA;&#xA;<pre><code>{&#xA;    "tweet" : {&#xA;        "_ttl" : { "enabled" : true, "default" : "1d" }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>You will have more detail here: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-ttl-field.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-ttl-field.html</a></p>&#xA;&#xA;<p>Regards,&#xA;Alain</p>&#xA;
<p><strong>The Elasticsearch "way"</strong> of dealing with "old" data is to create time-based indices. Meaning, for each day or each week you create an index. Index everything belonging to that day/week in that index.</p>&#xA;&#xA;<p>You decide how many days you want to keep around and stick to that number. Let's say that the data for 7 days counts as 10 GB. In the 8th day you create the new index, as usual, then you delete the index from 8 days before.</p>&#xA;&#xA;<p>All the time you'll have in your cluster 7 indices.&#xA;Using <code>ttl</code> as the other poster suggested is not recommended, because is <strong>far</strong> more difficult and it creates additional pressure on the cluster. The <code>ttl</code> mechanism checks every <code>indices.ttl.interval</code> (60 seconds by default) for expired documents, it creates bulk requests out of them and deletes them. This means unnecessary requests coming to the cluster.</p>&#xA;&#xA;<p>Instead, deleting an index is very easy and quick.</p>&#xA;&#xA;<p>Take a look at <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/time-based.html" rel="nofollow">this</a> and how to easily manage time based indices with <a href="https://www.elastic.co/blog/curator-tending-your-time-series-indices" rel="nofollow">Curator</a>.</p>&#xA;
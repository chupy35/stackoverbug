33419541
elasticsearch: Proper config in 3 node cluster for each node to have full copy of index?
<p>3 node cluster of ElasticSearch 1.7.2 on CentOS</p>&#xA;&#xA;<p>In a traditional cluster perspective, for a 3 node environment, the approach is to allow the failure of any one node, and the cluster will still be operational.</p>&#xA;&#xA;<p>The default elasticsearch.yml reflects this, and all is well.</p>&#xA;&#xA;<p>In our environment, 3 nodes, we want any one node to be able to stand alone and operate even if both other nodes are lost.</p>&#xA;&#xA;<p>We believe the following achieves this:</p>&#xA;&#xA;<pre><code>index.number_of_replicas: 2             # in 3-node cluster, every node will have p or r copy of every shard &#xA;discovery.zen.minimum_master_nodes: 2   # reqd for 3 node env, but what happens when only 1 node survives?&#xA;</code></pre>&#xA;&#xA;<p>Any additions or changes to the above appro?</p>&#xA;
<p>We also have the three node cluster with all node being capable of becoming master. I guess apart from minimum master nodes, rest config remains the same as default. Just as a word of precaution, when the cluster has only one node working, then there are no replicas available on that node. Try not to have that situation in production when you are indexing data otherwise it takes good time to propogate all changes and reallocation of shards once other nodes are up if the data set is huge. Cheers.</p>&#xA;
<p>Distributed database are meant to be resistant to failures, but each node is not meant to be stand alone.  It would be possible to setup ES such that each node has 100% of the data from each of the indexes but that would mean extra replicas and less shards.  Both of those are going to lead to reduced performance from the cluster.  </p>&#xA;&#xA;<p>If you are really worried that 2 of your nodes will go down at the same time I suggest adding a 4th data node instead of setting it up so that the 3rd node is stand alone.</p>&#xA;
<p>The answer is:</p>&#xA;&#xA;<pre><code>index.number_of_replicas: 2&#xA;</code></pre>&#xA;&#xA;<p>On a 3 node system, this means every node will have a replica of every shard, so any 1 node can stand alone/has all the data.</p>&#xA;
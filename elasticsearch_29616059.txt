29616059
Elasticsearch update id of each document to a value of another field in the document
<p>In elasticsearch how can I replace the id of every document with the value of another field in the document?</p>&#xA;
<p>I don't think you can change the ids of existing documents in the index, but you can reindex them using the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-id-field.html#_path" rel="nofollow">path parameter</a> in your mapping. Here is a trivial example.</p>&#xA;&#xA;<p>I set up a simple index, using the <code>path</code> parameter in the <code>_id</code> definition in the mapping, and added a few docs:</p>&#xA;&#xA;<pre><code>PUT /test_index&#xA;{&#xA;    "mappings": {&#xA;        "doc":{&#xA;            "_id": {&#xA;                "path": "number"&#xA;            },&#xA;            "properties": {&#xA;                "text_field": {&#xA;                    "type": "string"&#xA;                },&#xA;                "number": {&#xA;                    "type": "integer"&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;POST /test_index/doc/_bulk&#xA;{"index":{}}&#xA;{"text_field": "Apple TV","number":3}&#xA;{"index":{}}&#xA;{"text_field": "Apple iPhone","number":2}&#xA;{"index":{}}&#xA;{"text_field": "Apple MacBook","number":1}&#xA;</code></pre>&#xA;&#xA;<p>Then if I search, I can see that the ids were set as I asked:</p>&#xA;&#xA;<pre><code>POST /test_index/_search&#xA;...&#xA;{&#xA;   "took": 2,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 3,&#xA;      "max_score": 1,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "1",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "text_field": "Apple MacBook",&#xA;               "number": 1&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "2",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "text_field": "Apple iPhone",&#xA;               "number": 2&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "3",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "text_field": "Apple TV",&#xA;               "number": 3&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here's the code I used:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/933bd839b2d524889e483f50c59c37ffaab2270a" rel="nofollow">http://sense.qbox.io/gist/933bd839b2d524889e483f50c59c37ffaab2270a</a></p>&#xA;
<p>You can do this by defining a mapping for <code>_id</code> as described here <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.4/mapping-id-field.html" rel="nofollow">id-mapping</a></p>&#xA;
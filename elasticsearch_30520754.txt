30520754
What's the size of 'field data' in Elasticsearch for a field with doc_values turned on
<p>I have the mapping like this: </p>&#xA;&#xA;<pre><code>PUT test&#xA;{&#xA;  "mappings": {&#xA;    "mydoc": {&#xA;      "properties": {&#xA;         "createdAt": {&#xA;         "type": "date",&#xA;         "format": "date_optional_time",&#xA;         "doc_values": true&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>After indexing can I find out the size of the 'field data' for this field on HDD? Elasticsearch docs say that with enabling <code>doc_values: true</code> they build 'field data' on during index process. </p>&#xA;&#xA;<p>Thank you in advance. </p>&#xA;
<p>There is no endpoint to know exactly the difference between fielddata and doc_values. </p>&#xA;&#xA;<p>The only way to find out is to index the same data 2 times : once with <code>doc_values</code> enabled, and once with <code>fielddata</code>.</p>&#xA;&#xA;<p>With the data provided is this <a href="https://www.elastic.co/blog/elasticsearch-storage-the-true-story" rel="nofollow">blogpost</a> about storage in ElasticSearch, you can see there is roughly 20-30% increase of the index size when doc_values are enabled.</p>&#xA;
<p>Since doc values are stored in <a href="https://lucene.apache.org/core/4_9_0/core/org/apache/lucene/codecs/lucene49/Lucene49DocValuesFormat.html" rel="nofollow"><code>dvd</code> and <code>dvm</code> Lucene files</a>, you could simply compute the size of those files on disk with the following command.</p>&#xA;&#xA;<pre><code>ls -laR $ES_HOME/data/* | grep "dv[d|m]" | awk '{ total += $5 }; END { print total }'&#xA;</code></pre>&#xA;&#xA;<ul>&#xA;<li><code>ls -laR</code> will simply list all files in your ES data folder</li>&#xA;<li><code>grep</code> will catch only the <code>dvd</code> and <code>dvm</code> files</li>&#xA;<li><code>awk</code> will fetch the 5th column (i.e. the file size in bytes) and add it to the <code>total</code> variable</li>&#xA;<li>finally the <code>total</code> is printed out and should represent the total size in bytes of all your doc values footprint on disk.</li>&#xA;</ul>&#xA;
31897546
Combine Elastic Search Queries
<p>I have the following 2 queries:</p>&#xA;&#xA;<pre><code>GET places/_search&#xA;{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "bool": {&#xA;          "should": [&#xA;            {&#xA;              "term": {&#xA;                "approved": false&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;&#xA;GET places/_search&#xA;{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "geo_bounding_box": {&#xA;          "loc": {&#xA;            "top_left": "54.6152065515344, -6.09334913041994",&#xA;            "bottom_right": "54.5754258987271, -5.76633420732423"&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Both work fine, however I am having issues combining the queries and was wondering if anyone could help. Basically I want to retuen all items within the bounding box specified, where the "approved" property is false.</p>&#xA;
<p>You can keep your <code>filtered</code> query and merge both conditions simply like this inside in a <code>bool/must</code>filter</p>&#xA;&#xA;<pre><code>curl -XPOST localhost:9200/places/_search -d '{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "bool": {&#xA;          "must": [&#xA;            {&#xA;              "term": {&#xA;                "approved": false&#xA;              }&#xA;            },&#xA;            {&#xA;              "geo_bounding_box": {&#xA;                "loc": {&#xA;                  "top_left": "54.6152065515344, -6.09334913041994",&#xA;                  "bottom_right": "54.5754258987271, -5.76633420732423"&#xA;                }&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;
33734816
limit number of documents in aggregation elasticsearch
<p>Query:</p>&#xA;&#xA;<pre><code>{&#xA;    "fields" : [],&#xA;    "size" : 0,&#xA;    "aggs" : {&#xA;        "top-terms" : {&#xA;            "terms": {&#xA;                "field" : "content",&#xA;                "size" : 10&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Response:</p>&#xA;&#xA;<pre><code>Array&#xA;(&#xA;    [took] =&gt; 20475&#xA;    [timed_out] =&gt; &#xA;    [_shards] =&gt; Array&#xA;        (&#xA;            [total] =&gt; 5&#xA;            [successful] =&gt; 5&#xA;            [failed] =&gt; 0&#xA;        )&#xA;&#xA;    [hits] =&gt; Array&#xA;        (&#xA;            [total] =&gt; 2652291&#xA;            [max_score] =&gt; 0&#xA;            [hits] =&gt; Array&#xA;                (&#xA;                )&#xA;&#xA;        )&#xA;&#xA;    [aggregations] =&gt; Array&#xA;        (&#xA;            [top-terms] =&gt; Array&#xA;                (&#xA;                    [doc_count_error_upper_bound] =&gt; 1214666&#xA;                    [sum_other_doc_count] =&gt; 831757781&#xA;                    [buckets] =&gt; Array&#xA;                        (&#xA;                            [0] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; the&#xA;                                    [doc_count] =&gt; 2645615&#xA;                                )&#xA;&#xA;                            [1] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; to&#xA;                                    [doc_count] =&gt; 2638675&#xA;                                )&#xA;&#xA;                            [2] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; of&#xA;                                    [doc_count] =&gt; 2637099&#xA;                                )&#xA;&#xA;                            [3] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; and&#xA;                                    [doc_count] =&gt; 2633262&#xA;                                )&#xA;&#xA;                            [4] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; a&#xA;                                    [doc_count] =&gt; 2625627&#xA;                                )&#xA;&#xA;                            [5] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; in&#xA;                                    [doc_count] =&gt; 2621823&#xA;                                )&#xA;&#xA;                            [6] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; for&#xA;                                    [doc_count] =&gt; 2523026&#xA;                                )&#xA;&#xA;                            [7] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; is&#xA;                                    [doc_count] =&gt; 2480382&#xA;                                )&#xA;&#xA;                            [8] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; on&#xA;                                    [doc_count] =&gt; 2450387&#xA;                                )&#xA;&#xA;                            [9] =&gt; Array&#xA;                                (&#xA;                                    [key] =&gt; that&#xA;                                    [doc_count] =&gt; 2447827&#xA;                                )&#xA;&#xA;                        )&#xA;&#xA;                )&#xA;&#xA;        )&#xA;&#xA;)&#xA;</code></pre>&#xA;&#xA;<p>Aggregation on 2652291 documents ([total] => 2652291)</p>&#xA;&#xA;<p>How can I limit number of documents to 1000?</p>&#xA;&#xA;<pre><code>size: 1000&#xA;</code></pre>&#xA;&#xA;<p>does not work</p>&#xA;&#xA;<p>"Ignore this text, i am just adding it here so stackoverflow lets me to post the question."</p>&#xA;
<p>Got it working by adding limit filter</p>&#xA;&#xA;<pre><code>"filtered": {&#xA;    "filter": {&#xA;        "limit": {&#xA;           "value": 200&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>A limit filter limits the number of documents (per shard) to execute on.&#xA;More info: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.3/query-dsl-limit-filter.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/1.3/query-dsl-limit-filter.html</a></p>&#xA;
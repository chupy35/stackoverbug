30044821
Make sure duplicates does not happen while automatic indexing in elasticsearch
<p>I have many feeds that are flowing in to my server.</p>&#xA;&#xA;<pre><code>Example document is as follows -&#xA;{&#xA;"company" : "sony",&#xA;"size" : "10X",&#xA;"name" : "Kakhee pants",&#xA;"color" : "red"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The fields "company" and "name" is to be kept unique. That is I do not want 2 documents with the same company and name but different color and size.&#xA;How i can establish this in Elasticsearch?</p>&#xA;
<p>The best strategy for this would be to create docID based on value of these three fields.&#xA;For instance , for this document - </p>&#xA;&#xA;<pre><code>{&#xA;"company" : "sony",&#xA;"size" : "10X",&#xA;"name" : "Kakhee pants",&#xA;"color" : "red"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Make the docID as sony+Kakhee_pants+red&#xA;And then abstract the size and color to attribute array.</p>&#xA;&#xA;<pre><code>{&#xA;  "company": "sony",&#xA;  "name": "Kakhee pants",&#xA;  "color": "red",&#xA;  "attributes": [&#xA;    {&#xA;      "size": "10X",&#xA;      "color": "red"&#xA;    }&#xA;  ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Now , when you are inserting documents make an <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html#upserts" rel="nofollow">upsert</a>&#xA;When you are indexing the document if document does not exist and you are updating attributes field when document do exist.</p>&#xA;
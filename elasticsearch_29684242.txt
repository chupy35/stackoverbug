29684242
Elasticsearch more like this query using like_text
<p>I'm having some frustration using the more like this query.</p>&#xA;&#xA;<p>Here is my index creation:</p>&#xA;&#xA;<pre><code>curl -XPUT 'http://127.0.0.1:9200/food/' -d &#xA;'{&#xA;  "mappings": {&#xA;    "fruit": {&#xA;      "properties": {&#xA;        "term": {&#xA;          "type": "string",&#xA;          "term_vector": "yes"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>And here is a sample piece of data in that index:</p>&#xA;&#xA;<pre><code>{&#xA;  "_index": "food",&#xA;  "_type": "fruit",&#xA;  "_id": "2",&#xA;  "_score": 1,&#xA;  "_source": {&#xA;    "term": "yellow",&#xA;    "property_ids": [&#xA;      1&#xA;    ],&#xA;    "id": 2&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Lastly here is the more like this query I use against it to attempt to return data:</p>&#xA;&#xA;<pre><code>curl -XGET 'http://127.0.0.1:9200/food/_search' -d '{&#xA;  "query": {&#xA;    "more_like_this": {&#xA;      "fields": [&#xA;        "term"&#xA;      ],&#xA;      "like_text": "yellow",&#xA;      "min_term_freq": 1,&#xA;      "max_query_terms": 12&#xA;    }&#xA;  }&#xA;}&#xA;'&#xA;</code></pre>&#xA;&#xA;<p>The issue is when I do this search I get no results back:</p>&#xA;&#xA;<pre><code>{"took":2,"timed_out":false,"_shards":{"total":5,"successful":5,"failed":0},"hits":{"total":0,"max_score":null,"hits":[]}}%&#xA;</code></pre>&#xA;&#xA;<p>If I do a standard wildcard query for just "yellow" I get that result back.  What am I missing?</p>&#xA;
<p>By default <code>min_doc_freq</code> is 5 (<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.5/query-dsl-mlt-query.html#_term_selection_parameters" rel="noreferrer">check doc</a>) so, your query is not working because your index doesn't contain at least 5 documents whose <code>term</code> property holds <code>yellow</code>. So, set <code>min_doc_freq</code> to 1 in your query and it should work. Example:</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "more_like_this": {&#xA;            "fields": [&#xA;                "term"&#xA;             ],&#xA;             "like_text": "yellow",&#xA;             "min_term_freq": 1,&#xA;             "min_doc_freq": 1,&#xA;             "max_query_terms": 12&#xA;         }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
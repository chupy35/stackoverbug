31113203
Elasticsearch completion field with jdbc river
<p>I am using JDBC River to load data:</p>&#xA;&#xA;<pre><code>curl -XPUT 'localhost:9200/_river/my_jdbc_river/_meta' -d '{&#xA;    "type": "jdbc",&#xA;        "jdbc": {&#xA;        "url": "jdbc:mysql://localhost:3306/test",&#xA;            "user": "root",&#xA;            "password": "root",&#xA;            "sql": "SELECT TAD.ID AS _id, TAD.APP_NAME AS appName FROM TOPIC_APP_DETAILS TAD ",&#xA;            "index": "app_index",&#xA;            "type": "app_type",&#xA;            "mappings": {&#xA;            "app_type": {&#xA;                "properties": {&#xA;                    "appName": {&#xA;                        "type": "completion"&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And when I execute below query getting <strong>ClassCastException[org.elasticsearch.index.mapper.core.StringFieldMapper cannot be cast to org.elasticsearch.index.mapper.core.CompletionFieldMapper]</strong>;</p>&#xA;&#xA;<pre><code>curl -X POST 'localhost:9200/app_index/_suggest?pretty' -d '{&#xA;    "app-suggest" : {&#xA;        "text" : "cri",&#xA;            "completion" : {&#xA;            "field" : "appName"&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Please suggest what I am missing here.</p>&#xA;
<p>I have resolved it by creating my own data loader class to fetch data from database for indexing into Elasticsearch.</p>&#xA;&#xA;<p><strong>Getting data from database.</strong></p>&#xA;&#xA;<p>String empName = rs.getString("EMP_NAME");<br>&#xA;String empId = rs.getInt("EMP_ID");</p>&#xA;&#xA;<p><strong>Load data into Elasticsearch</strong></p>&#xA;&#xA;<p>XContentBuilder appBuilder = XContentFactory.jsonBuilder().startObject();&#xA;appBuilder.field("empName", empName);&#xA;getClient().prepareIndex("Index", "Type", String.valueOf(empId)).setSource(appBuilder).execute().actionGet();</p>&#xA;
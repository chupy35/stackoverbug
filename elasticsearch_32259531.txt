32259531
How to boost elastic search results based on a field value
<p>I am using Query String to query elastic search and below is my sample query.</p>&#xA;&#xA;<pre><code>{&#xA;    "query_string" : {&#xA;        "query" : "Sharmila"&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I've field called FLAG in the documents. I want to boost the results if the FLAG== Y. As custom_score is deprecated, I want to use function_score </p>&#xA;&#xA;<pre><code>{&#xA;"query": {&#xA;    "function_score": {&#xA;        "query": {&#xA;            "query_string": {&#xA;                "query": "Sharmila"&#xA;            },&#xA;            "functions": [{&#xA;                "script_score": {&#xA;                    "script": "_score * (doc['FLAG'].value == 'Y' ? 1.2 : 1)"&#xA;                }&#xA;            }],&#xA;        }&#xA;    }&#xA;}&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I am getting exception saying <strong>No query registered for [script_score]]</strong></p>&#xA;&#xA;<p>I am using elasticsearch 1.2.2</p>&#xA;&#xA;<p>Any thoughts where I am doing wrong?</p>&#xA;
<p>You're almost there, you just need to move the <code>functions</code> property just below the <code>function_score</code> one and not bury it inside your <code>query</code>:</p>&#xA;&#xA;<pre><code>{&#xA;"query": {&#xA;    "function_score": {&#xA;        "functions": [{&#xA;            "script_score": {&#xA;                "script": "_score * (doc['FLAG'].value == 'Y' ? 1.2 : 1)"&#xA;            }&#xA;        }],&#xA;        "query": {&#xA;            "query_string": {&#xA;                "query": "Sharmila"&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;}&#xA;</code></pre>&#xA;
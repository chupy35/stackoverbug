28539474
How to Boost a field based on condition in ElasticSearch
<p>I am having a query structure like</p>&#xA;&#xA;<pre><code>{&#xA;  "sort": {},&#xA;  "query": {&#xA;    "bool": {&#xA;      "should": [&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_categories": "Grant Writing"&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "Census"&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "MDA"&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "OSD"&#xA;          }&#xA;        }&#xA;      ]&#xA;    }&#xA;  },&#xA;  "size": 500,&#xA;  "from": 0&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Suppose this will return a list of 10 users.</p>&#xA;&#xA;<p>What I need to get is, the user having <strong>Agency: 'Census'</strong> to be the first one in the search result (boost the results having Census as agency). How can we do this?</p>&#xA;
<p>The following will do it. I converted some of the <code>match_phrase</code> queries to <code>match</code> queries as they contain only single terms</p>&#xA;&#xA;<pre><code>{&#xA;  "sort": {},&#xA;  "query": {&#xA;    "bool": {&#xA;      "should": [&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_categories": "Grant Writing"&#xA;          }&#xA;        },&#xA;        {  &#xA;          "match": {&#xA;            "user_agencies": { &#xA;              "query": "Census",&#xA;              "boost": 3&#xA;            }&#xA;          }&#xA;        },&#xA;        {&#xA;          "match": {&#xA;            "user_agencies": {&#xA;              "query": "MDA",&#xA;          }&#xA;        },&#xA;        {&#xA;          "match": {&#xA;            "user_agencies": {&#xA;              "query": "OSD",&#xA;          }&#xA;        }&#xA;      ]&#xA;    }&#xA;  },&#xA;  "size": 500,&#xA;  "from": 0&#xA;}&#xA;</code></pre>&#xA;
<p>You should boost <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/query-time-boosting.html" rel="nofollow">at query time</a>, and give a big boost documents with "Census" in the agency field. If the boost is high enough, a document matching "Census" will always be on top, regardless of the values for the other fields.</p>&#xA;&#xA;<pre><code>{&#xA;  "sort": {},&#xA;  "query": {&#xA;    "bool": {&#xA;      "should": [&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_categories": "Grant Writing"&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "Census", "boost": 10&#xA;&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "MDA"&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase": {&#xA;            "user_agencies": "OSD"&#xA;          }&#xA;        }&#xA;      ]&#xA;    }&#xA;  },&#xA;  "size": 500,&#xA;  "from": 0&#xA;}&#xA;</code></pre>&#xA;
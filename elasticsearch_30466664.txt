30466664
Elastic Search: aggregation random order?
<p>is it possible to have aggregations with a random order?&#xA;It seems that there is only asc or desc possible?</p>&#xA;&#xA;<pre><code>{&#xA;"aggs" : {&#xA;    "genders" : {&#xA;        "terms" : {&#xA;            "field" : "gender",&#xA;            "order" : { &#xA;                "_count" : "asc" &#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
<p>Nope, according to the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.5/search-aggregations-bucket-terms-aggregation.html#search-aggregations-bucket-terms-aggregation-order" rel="nofollow">official documentation</a>, terms aggregations are always sorted one way or another. If not specified, aggregated terms are sorted by count descending.</p>&#xA;&#xA;<p>If at all needed, you can always shuffle the results on the client-side in some random order, though.</p>&#xA;
<p>Yes you can show random results&#xA;refer to the answer provided here:<br>&#xA;<a href="https://stackoverflow.com/questions/9796470/random-order-pagination-elasticsearch">Random order &amp; pagination Elasticsearch</a></p>&#xA;&#xA;<p>You can try something like this. I wanted to randomize the results inside buckets so I have used it.</p>&#xA;&#xA;<pre><code>{&#xA;  "aggs": {&#xA;    "genders": {&#xA;      "terms": {&#xA;        "field": "gender"&#xA;      },&#xA;      "aggs": {&#xA;        "search_second": {&#xA;          "top_hits": {&#xA;            "sort": {&#xA;              "_script": {&#xA;                "script": "Math.random()",&#xA;                "type": "number",&#xA;                "params": {},&#xA;                "order": "asc"&#xA;              }&#xA;            }&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;} &#xA;</code></pre>&#xA;
33174038
whole word search with elasticsearch
<p>Just started wtih elasticsearch. And stuck with first question:</p>&#xA;&#xA;<p>I have following strings in my es index:</p>&#xA;&#xA;<p>"favourites",&#xA;"favourites\a1"</p>&#xA;&#xA;<p>If I try to search only first with </p>&#xA;&#xA;<pre><code>'query' =&gt; [&#xA;    'match' =&gt; [&#xA;        'name' =&gt; 'favourites'&#xA;    ]&#xA;],&#xA;</code></pre>&#xA;&#xA;<p>or</p>&#xA;&#xA;<pre><code>'filtered' =&gt; [&#xA;    'filter' =&gt; [&#xA;        'term' =&gt; [&#xA;            'name' =&gt; 'favourites'&#xA;        ],&#xA;    ]&#xA;]&#xA;</code></pre>&#xA;&#xA;<p>It matchs both. How to solve it?</p>&#xA;
<p>Try using <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping-intro.html#_index_2" rel="nofollow"><code>"index": "not_analyzed"</code></a> in your mapping, and a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-term-filter.html" rel="nofollow">term filter</a> in your query (or a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-term-query.html" rel="nofollow">term query</a>).</p>&#xA;&#xA;<p>For example, I can set up a simple index like this:</p>&#xA;&#xA;<pre><code>PUT /test_index&#xA;{&#xA;    "mappings": {&#xA;        "doc": {&#xA;            "properties": {&#xA;                "name": {&#xA;                    "type": "string",&#xA;                    "index": "not_analyzed"&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>add a couple of docs</p>&#xA;&#xA;<pre><code>POST /test_index/doc/_bulk&#xA;{"index":{"_id":1}}&#xA;{"name": "favourites"}&#xA;{"index":{"_id":2}}&#xA;{"name": "favourites\\a1"}&#xA;</code></pre>&#xA;&#xA;<p>then this query will return only the first document:</p>&#xA;&#xA;<pre><code>POST /test_index/_search&#xA;{&#xA;   "query": {&#xA;      "term": {&#xA;         "name": {&#xA;            "value": "favourites"&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;...&#xA;{&#xA;   "took": 45,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 1,&#xA;      "max_score": 0.30685282,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "1",&#xA;            "_score": 0.30685282,&#xA;            "_source": {&#xA;               "name": "favourites"&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is some code I used for a quick test:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/accb3e9aedc43144a30bb96fd483115427c6c441" rel="nofollow">http://sense.qbox.io/gist/accb3e9aedc43144a30bb96fd483115427c6c441</a></p>&#xA;
31939052
Top 10% of results with sort
<p>I'm looking for a setup that actually returns the top 10% of results of a certain query. After the result we also want to sort the subset.</p>&#xA;&#xA;<p>Is there an easy way to do this?</p>&#xA;&#xA;<p>Can anyone provide a simple example for this.&#xA;I was thinking scaling the results scores between 0 and 1.0 and basically sepcifiying min_score to 0.9.</p>&#xA;&#xA;<p>I was trying to create function_score queries but those seem a bit complex for a simple requirement such as this one, plus I was not sure how sorting would effect the results, since I want the sort functions work always on the 10% most relevant articles of course.</p>&#xA;&#xA;<p>Thanks,&#xA;Peter</p>&#xA;
<p>As you want to slice response in % of overall docs count, you need to know that anyway. And using <code>from / size</code> params will cut off the required amount at query time.</p>&#xA;&#xA;<p>Assuming this, seems that easiest way to achieve your goal is to make 2 queries:</p>&#xA;&#xA;<ol>&#xA;<li>Filtered query with all filters, no queries and <code>search_type=count</code> to get overall document count.</li>&#xA;<li>Perform your regular matching query, applying <code>{"from": 0, "size": count/10}</code> with <em>count</em> got from 1st response.</li>&#xA;</ol>&#xA;&#xA;<p>Talking about tweaking the scoring. For me, it seems as bad idea, as getting multiple documents with the same score is pretty generic situation. So, cutting dataset by <code>min_score</code> will probably result in skewed data.</p>&#xA;
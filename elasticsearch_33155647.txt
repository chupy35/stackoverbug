33155647
Set the length of characters in aggregation in elasticsearch
<p>I am new to elasticsearch, I am getting confused over aggregation. Is it possible to set the length of the field. I mean</p>&#xA;&#xA;<pre><code>curl -XPOST "http://localhost:9200/market/product/_search" -d'&#xA;{&#xA;   "size": 0,&#xA;   "aggregations": {&#xA;      "name_count": {&#xA;         "terms": {&#xA;            "field": "name",&#xA;        "size":10&#xA;         }&#xA;&#xA;      }&#xA;   }&#xA;}' &#xA;</code></pre>&#xA;&#xA;<p>I this can I set the length the length of the field ("field":"name").</p>&#xA;&#xA;<p>On of the solution that I think can be, by using script.</p>&#xA;&#xA;<pre><code>curl -XPOST "http://localhost:9200/market/product/_search" -d'&#xA;{&#xA;   "size": 0,&#xA;   "aggregations": {&#xA;      "name_count": {&#xA;         "terms": {&#xA;            "field": "name",&#xA;        "size":10,&#xA;        "script" : "doc['name'].value.length &gt; 2"&#xA;         }&#xA;&#xA;      }&#xA;   }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>I am not sure, if I am answering myself. But I am little confused, So if anyone can answer me.</p>&#xA;&#xA;<p>Thanks</p>&#xA;
<p>If you want a count of records in Elasticsearch for each product name but do not want to consider product names that are shorter than three characters, you can try something like this:</p>&#xA;&#xA;<pre><code>{&#xA;    "size" : 0,&#xA;    "query" : {&#xA;        "regexp" : {&#xA;            "name" : ".{3,}"&#xA;        }&#xA;    },&#xA;    "aggregations": {&#xA;        "name_count": {&#xA;            "terms": {&#xA;                "field": "name",&#xA;                "size":10&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Specifying the regexp query will ensure that only docs with names of length > 2 are considered for your aggregation.</p>&#xA;&#xA;<p>I based this answer on another stackoverflow post (<a href="https://stackoverflow.com/questions/20830925/elasticsearchfiltering-documents-based-on-field-length">ElasticSearch:filtering documents based on field length</a>) where another user asked how they might filter results based on field length.</p>&#xA;
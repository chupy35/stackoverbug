34413678
elasticsearch "fields" parameter with dot notation
<p>Elasticsearch's search API supports a "fields" parameter to limit the fields returned from the hits. It supports dot notation for sub-properties of a document as well. For example, a query</p>&#xA;&#xA;<pre><code>{&#xA;    "fields" : ["user.lastname"],&#xA;    "query" : {&#xA;        "term" : { "_id" : 1 }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>will return hits as:</p>&#xA;&#xA;<pre><code>{&#xA;   "hits": [&#xA;        {"_id": 1,&#xA;         "user.lastname": "Smith"}&#xA;  ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I am wondering if there is an option to make it return as this instead:</p>&#xA;&#xA;<pre><code>{&#xA;   "hits": [&#xA;        {"_id": 1,&#xA;         "user": {"lastname": "Smith"}}&#xA;  ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The benefit of the second one is maintaining the same structure as the full document, as that the following data access logic is consistent.</p>&#xA;
<p>Yes, if you use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-source-filtering.html" rel="nofollow">source filtering</a> instead (i.e. <code>_source</code> instead of <code>fields</code>), you'll get the expected results, i.e.</p>&#xA;&#xA;<pre><code>POST index/_search&#xA;{&#xA;    "_source" : ["user.lastname"],&#xA;    "query" : {&#xA;        "term" : { "_id" : 1 }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Results:</p>&#xA;&#xA;<pre><code>{&#xA;   "hits": [&#xA;      {&#xA;         "_id": 1,&#xA;         "_source": {&#xA;             "user": {"lastname": "Smith"}&#xA;         }&#xA;      }&#xA;  ]&#xA;}&#xA;</code></pre>&#xA;
28830684
Elasticsearch - searching across multiple multiple types of a index and its different types
<p>I have indexed data in elasticsearch  . Index name is "demo" .&#xA;I have two types (mappings) for "demo" , one is "user" and other is "blog".&#xA;"user" type have fields - name , city , country other fields and blog have - "title" , description" , "author_name" etc.&#xA;Now I want to search across "demo". If I want to search "java"  then it will bring all the documents which have "java" in any fields of any type , either "user" or "blog".</p>&#xA;
<p>You can use the <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/root-object.html#all-field" rel="noreferrer"><code>"_all"</code> field</a> for that index. By default each of your fields will be included in the <code>"_all"</code> field for each type. Then you can just run a <code>match</code> query against the <code>"_all"</code> field. Also, when searching the index, just don't specify a type and all types will be searched.</p>&#xA;&#xA;<p>Here is an example: </p>&#xA;&#xA;<pre><code>DELETE /test_index&#xA;&#xA;PUT /test_index&#xA;{&#xA;   "settings": {&#xA;      "number_of_shards": 1&#xA;   },&#xA;   "mappings": {&#xA;      "user": {&#xA;         "properties": {&#xA;             "name" : { "type": "string" },&#xA;             "city" : { "type": "string" },&#xA;             "country" : { "type": "string" }&#xA;         }&#xA;      },&#xA;      "blog": {&#xA;         "properties": {&#xA;             "title" : { "type": "string" },&#xA;             "description" : { "type": "string" },&#xA;             "author_name" : { "type": "string" }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;&#xA;POST /test_index/_bulk&#xA;{"index":{"_index":"test_index","_type":"user"}}&#xA;{"name":"Bob","city":"New York","country":"USA"}&#xA;{"index":{"_index":"test_index","_type":"user"}}&#xA;{"name":"John","city":"Jakarta","country":"Java/Indonesia"}&#xA;{"index":{"_index":"test_index","_type":"blog"}}&#xA;{"title":"Python/ES","description":"using Python with Elasticsearch","author_name":"John"}&#xA;{"index":{"_index":"test_index","_type":"blog"}}&#xA;{"title":"Java/ES","description":"using Java with Elasticsearch","author_name":"Bob"}&#xA;&#xA;POST /test_index/_search&#xA;{&#xA;    "query": {&#xA;        "match": {&#xA;           "_all": "Java"&#xA;        }&#xA;    }&#xA;}&#xA;...&#xA;{&#xA;   "took": 2,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 1,&#xA;      "successful": 1,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 2,&#xA;      "max_score": 0.68289655,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "blog",&#xA;            "_id": "hNJ-AOG2SbS0nw4IPBuXGQ",&#xA;            "_score": 0.68289655,&#xA;            "_source": {&#xA;               "title": "Java/ES",&#xA;               "description": "using Java with Elasticsearch",&#xA;               "author_name": "Bob"&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "user",&#xA;            "_id": "VqfowNx8TTG69buY9Vd_MQ",&#xA;            "_score": 0.643841,&#xA;            "_source": {&#xA;               "name": "John",&#xA;               "city": "Jakarta",&#xA;               "country": "Java/Indonesia"&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;
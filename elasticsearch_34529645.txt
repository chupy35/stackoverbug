34529645
Elastic search class_cast_exception on PUT command
<p><strong>The command I am executing. It is for creating a new customer. Please see below for how i am creating Customer with PUT command on Sense (<a href="http://localhost:9200" rel="nofollow">http://localhost:9200</a>)</strong>    </p>&#xA;&#xA;<pre><code> PUT /crud_sample/Customer_Info/1&#xA;        {&#xA;          "name": "PH"&#xA;        }&#xA;</code></pre>&#xA;&#xA;<p><strong>The error I get:</strong></p>&#xA;&#xA;<pre><code>{&#xA;       "error": {&#xA;          "root_cause": [&#xA;             {&#xA;                "type": "class_cast_exception",&#xA;                "reason": "java.lang.String cannot be cast to java.lang.Number"&#xA;             }&#xA;          ],&#xA;          "type": "class_cast_exception",&#xA;          "reason": "java.lang.String cannot be cast to java.lang.Number"&#xA;       },&#xA;       "status": 500&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p><strong>The properties and type of object being created. The customer type.</strong></p>&#xA;&#xA;<pre><code> "properties": { &#xA;            "_id":{&#xA;             "type": "long"&#xA;            },&#xA;            "name":{&#xA;              "type": "string",&#xA;              "index" : "not_analyzed"&#xA;            }&#xA;          }&#xA;</code></pre>&#xA;
<p>The problem comes from the fact that you're defining a field called <code>_id</code> with an initial underscore in your mapping and ES won't allow it because it clashes with the default field called <code>_id</code> (<a href="https://github.com/elastic/elasticsearch/issues/9059" rel="nofollow">more info</a>). You either need to remove that field or rename it to <code>id</code>.</p>&#xA;&#xA;<p>You need to wipe your index and re-create it with a clean mapping, like this:</p>&#xA;&#xA;<pre><code>curl -XDELETE localhost:9200/crud_sample&#xA;&#xA;curl -XPUT localhost:9200/crud_sample -d '{&#xA;    "mappings": {&#xA;        "Customer_Info": {&#xA;           "properties": { &#xA;              "id":{&#xA;                 "type": "long"&#xA;              },&#xA;              "name":{&#xA;                 "type": "string",&#xA;                 "index" : "not_analyzed"&#xA;              }&#xA;           }&#xA;        }&#xA;    }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>Then you'll be able to create your sample document without error:</p>&#xA;&#xA;<pre><code>curl -XPUT localhost:9200/crud_sample/Customer_Info/1 -d '{&#xA;    "name": "PH"&#xA;}'&#xA;</code></pre>&#xA;
31557310
Differences in Elasticsearch' Types of Fields
<p>So there are source fields, document fields and stored fields. But what's the difference in them? I read <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.3/modules-scripting.html#_document_fields" rel="nofollow">the documentation</a> about it, but they are still all the same to me. And then there are also <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.3/search-request-script-fields.html" rel="nofollow">script fields</a>.</p>&#xA;&#xA;<p>Maybe as a starting point:</p>&#xA;&#xA;<pre><code>$ curl -XPUT 'http://localhost:9200/my-index/my-type/1' -d '{&#xA;    "@timestamp": "2015-07-22T09:00:00.000Z",&#xA;    "user": "sjngm",&#xA;    "message": "It's kinda warm in here",&#xA;    "happiness": 89&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>and this query:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "script": {&#xA;          "script": "doc['happiness'].value &gt; 50" }}}}}&#xA;</code></pre>&#xA;&#xA;<p>compared to</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "script": {&#xA;          "script": "_source['happiness'] &gt; 50" }}}}}&#xA;</code></pre>&#xA;&#xA;<p>This throws a NullPointerException:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "script": {&#xA;          "script": "_fields['happiness'].value &gt; 50" }}}}}&#xA;</code></pre>&#xA;&#xA;<p>What do those types stand for? Where do they come from? When do I use what?</p>&#xA;&#xA;<p>And maybe a bonus question: Is it possible to generate additional fields into "hits/hits/_source" in the response with any of the above? Maybe with a variation of script fields?</p>&#xA;&#xA;<p>Can anyone please provide an explanation in simple English?</p>&#xA;
<ul>&#xA;<li><code>doc["my-field"].value</code> provides <code>*.raw</code>, loads all the values in fielddata completely independent of filters => fast, uses lots of RAM</li>&#xA;<li><code>_source["my-field"]</code> loads the document as compressed JSON from disk and parses it for the field => may take some time, parsing is done by streaming => later fields take longer to be found</li>&#xA;<li><code>_fields["my-field"].value</code> accesses only special fields marked in the index' mappings as <code>"store": true</code></li>&#xA;</ul>&#xA;
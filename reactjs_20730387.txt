20730387
Render sub-component error using React.js
<p>I'm following the React.js Facebook from <a href="http://facebook.github.io/react/docs/tutorial.html" rel="nofollow">this tutorial</a>.&#xA;I added a more LikeButton component here:</p>&#xA;&#xA;<pre><code>var LikeButton = React.createClass({&#xA;getInitialState: function() {&#xA;  return {liked: this.props.liked, id: this.props.id};&#xA;},&#xA;handleClick: function(event) {&#xA;  // post to server using ajax here&#xA;  this.setState({liked: !this.state.liked, id: this.prop.id});&#xA;},&#xA;render: function() {&#xA;var text = this.state.liked ? 'like' : 'unlike';&#xA;return (&#xA;  &lt;p onClick={this.handleClick}&gt;&#xA;    You {text} this. Click to toggle.&#xA;  &lt;/p&gt;&#xA;);&#xA;}});&#xA;</code></pre>&#xA;&#xA;<p>and then i put the component inside the comment block:</p>&#xA;&#xA;<pre><code>var CommentList = React.createClass({&#xA;  render: function() {&#xA;    var commentNodes = this.props.data.map(function (comment) {&#xA;      return &lt;div&gt;&#xA;      &lt;Comment author={comment.author}&gt;&#xA;      {comment.content}&lt;/Comment&gt;&lt;LikeButton liked={comment.liked} id={comment.id} / &lt;/div&gt;;&#xA;    }); &#xA;</code></pre>&#xA;&#xA;<p>At last i use setInterval in CommentBox to realtime update using polling.</p>&#xA;&#xA;<pre><code>var CommentBox = React.createClass({&#xA;    componentDidMount: function() {&#xA;    this.loadCommentsFromServer();&#xA;    setInterval(this.loadCommentsFromServer, this.props.pollInterval);&#xA;  }&#xA;React.renderComponent(&#xA;  &lt;CommentBox url='comments.json' pollInterval={3000}/&gt;,&#xA;  document.getElementById('content')&#xA;);&#xA;</code></pre>&#xA;&#xA;<p>When i click like, the LikeButton component could render correctly, but when using setInterval, in server side, i manually changed the liked attribute of a comment, but the LikeButton component couldn't render correctly.&#xA;Do you know how to fix the problem ?&#xA;Thank you very much.</p>&#xA;
<p>You have to persist on server side you are only setting the state so change your handleClick function like this using <a href="https://github.com/mzabriskie/axios/" rel="nofollow noreferrer"><strong><code>axios</code></strong></a></p>&#xA;&#xA;<pre><code>handleClick: function(event) {&#xA;  // post to server using ajax here&#xA;  this.setState({liked: !this.state.liked, id: this.prop.id});&#xA;  liked = this.state.liked;&#xA;  id = this.prop.id;&#xA;  axios.post('/YOUR_LIKE_UNLIKE_API_END_POINT', {&#xA;    liked: liked,&#xA;    id: id&#xA;  }).catch(function (error) {&#xA;    this.setState({liked: !this.state.liked, id: this.prop.id});&#xA;  });&#xA;},&#xA;</code></pre>&#xA;
30151566
Why are documents in elasticsearch immutable?
<p>I am trying to get a hang of elasticsearch. Was reading through the <a href="http://www.elastic.co/guide/en/elasticsearch/guide/current/index.html" rel="nofollow">definitive guide</a>.</p>&#xA;&#xA;<p>They've mentioned that the update API does a retrieve-change-reindex cycle &#xA;each time I update something in a document. And I completely get that this is done because they say that "Documents are immutable"(see <a href="http://www.elastic.co/guide/en/elasticsearch/guide/current/update-doc.html" rel="nofollow">this</a>). What I am questioning here is why have it immutable in the first place. Wouldn't there be an advantage of allowing update and index of just a particular field hadn't this been the constraint?</p>&#xA;
<p>First , it's better to tell segments are immutable than telling documents are immutable. To understand the reason. You need to understand how lucene works. Lucerne is a java library on top of which elasticsearch is built. Under the hood a single shard is a lucene instance and it does the actual work of documents storage and search . Elasticsearch is more of a distributed REST based server layer on top of lucene.</p>&#xA;&#xA;<p>In lucene in order to achieve high Indexing speed we have segment architecture. A bunch of files are kept in a segment where each segment is a single file in the disk. As file in between write operation is very heavy , a segment is made immutable so that all subsequent writes go to New segments.</p>&#xA;
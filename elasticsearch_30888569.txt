30888569
range between two dates in elastic Search
<p>i have a question with filter, range and or with elastic search.</p>&#xA;&#xA;<p>I have de document in elasticSearch with </p>&#xA;&#xA;<pre><code>    {&#xA;      startDate : myDate&#xA;      endDate : onOtherDateOr Nothing&#xA;&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>I Want to search for a range where now is after startDate, or Between startDate and endDate if endDate is defined. How can i do that ? </p>&#xA;
<p>You can do it like this with two <code>bool/should</code> filters containing two nested <code>bool/must</code> filters: </p>&#xA;&#xA;<pre><code>curl -XPOST localhost:9200/_search -d '{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "bool": {&#xA;          "should": [&#xA;            {&#xA;              "bool": {&#xA;                "must": [            &lt;--- if endDate exists, check both bounds&#xA;                  {&#xA;                    "exists": {&#xA;                      "field": "endDate"&#xA;                    }&#xA;                  },&#xA;                  {&#xA;                    "range": {&#xA;                      "startDate": {&#xA;                        "lte": "now"&#xA;                      }&#xA;                    }&#xA;                  },&#xA;                  {&#xA;                    "range": {&#xA;                      "endDate": {&#xA;                        "gte": "now"&#xA;                      }&#xA;                    }&#xA;                  }&#xA;                ]&#xA;              }&#xA;            },&#xA;            {&#xA;              "bool": {&#xA;                "must": [            &lt;--- if endDate missing, only check startDate&#xA;                  {&#xA;                    "missing": {&#xA;                      "field": "endDate"&#xA;                    }&#xA;                  },&#xA;                  {&#xA;                    "range": {&#xA;                      "startDate": {&#xA;                        "lte": "now"&#xA;                      }&#xA;                    }&#xA;                  }&#xA;                ]&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;
30269160
ElasticSearch basic query, why doesn't it work
<p>I am trying to learn how to query ElasticSearch. My background is in database development and I keep thinking about sql way of doing it. I did read ES docs about different types of query, but many of it still won't make sense to me. I have several question and really hope someone can shed some light to help me out.</p>&#xA;&#xA;<ol>&#xA;<li>Is there a difference between _search and _search?search_type=count?</li>&#xA;<li>Is there a way I can query mapping, so I can see field names and types?</li>&#xA;<li>I need to bring back app, cat and sub fields from all documents where app="AAA". </li>&#xA;</ol>&#xA;&#xA;<p>Why wouldn't something like this work?</p>&#xA;&#xA;<pre><code>{&#xA;  "fields":["app","cat","sub"],&#xA;  "query":{&#xA;        "field" : {&#xA;            "app.raw": "AAA"&#xA;        }&#xA;    },&#xA;  "from": 0,&#xA;  "size": 10&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Thanks</p>&#xA;
<blockquote>&#xA;  <ol>&#xA;  <li>Is there a difference between _search and _search?search_type=count?</li>&#xA;  </ol>&#xA;</blockquote>&#xA;&#xA;<p>Yes, the latter which will <strong>not</strong> return the actual hits. If you only need to know how many documents it would have matched or if you only need the result of the filters/aggregations, then the latter is for you.</p>&#xA;&#xA;<blockquote>&#xA;  <ol start="2">&#xA;  <li>Is there a way I can query mapping, so I can see field names and types?</li>&#xA;  </ol>&#xA;</blockquote>&#xA;&#xA;<p>Use the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-get-mapping.html" rel="nofollow">get mapping</a> endpoint: <a href="http://localhost:9200/index/type/_mapping?pretty" rel="nofollow">http://localhost:9200/index/type/_mapping?pretty</a></p>&#xA;&#xA;<p>The syntax has various incarnations, I used <code>type/_mapping</code> but you also can call it as <code>_mapping/type</code></p>&#xA;&#xA;<blockquote>&#xA;  <ol start="3">&#xA;  <li>I need to bring back app, cat and sub fields from all documents where app="AAA".</li>&#xA;  </ol>&#xA;</blockquote>&#xA;&#xA;<p>Without knowing your mapping it's hard to <em>guess</em> what really went wrong.</p>&#xA;&#xA;<p>Since you're using <code>app.raw</code> I assume you went along with maybe <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.5/mapping-core-types.html" rel="nofollow">Core Types</a>, which is a <code>not_analyzed</code> field and thus you probably should use a query which works best with it which would be the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.5/query-dsl-term-query.html" rel="nofollow">Term Query</a>:</p>&#xA;&#xA;<pre><code>{&#xA;  "query":{&#xA;    "term" : {&#xA;      "app.raw": "AAA"&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>If the above doesn't solve it, please provide the output of <code>yourindex/yourtype/_mapping?pretty</code>.</p>&#xA;&#xA;<p>Mastering the query DSL is important to make anything useful. I recommend reading <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html" rel="nofollow">Query DSL reference</a>, going through the <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/search-in-depth.html" rel="nofollow">"Search in Deptht"-Guide</a> and I can also the recommend the pretty recent video <a href="https://www.elastic.co/webinars/elasticsearch-query-dsl" rel="nofollow">Query DSL not just for Wizards</a>, de-mystifying some of the weird parts.</p>&#xA;
28515687
Modify Query Score with Elastic Search
<p>I am trying to modify a search score in elasticsearch by multiplying the _score by the square root of a single value stored with each document. Below is the JSON query I am using. Where have I gone wrong?</p>&#xA;&#xA;<pre><code>{&#xA;"index": "resources",&#xA;"type": "page",&#xA;"from": "0",&#xA;"size": "20",&#xA;"body": {&#xA;    "query": {&#xA;        "match": {&#xA;            "content": "baseball"&#xA;        },&#xA;        "function_score": {&#xA;            "functions": [{&#xA;                "script_score": {&#xA;                    "params": [],&#xA;                    "script": "_score * sqrt(page['obls'].value)"&#xA;                }&#xA;            }]&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>}</p>&#xA;&#xA;<p>Thanks in advance for your help!</p>&#xA;
<p>If you are using 1.4.X I would use <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html#_field_value_factor" rel="nofollow">field value factor</a> function as follows:</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "function_score": {&#xA;            "query": {&#xA;                "match": {&#xA;                    "content": "baseball"&#xA;                }&#xA;            },&#xA;            "functions": [&#xA;                {&#xA;                    "field_value_factor": {&#xA;                        "field": "obls",&#xA;                        "factor": 1,&#xA;                        "modifier": "sqrt"&#xA;                    }&#xA;                }&#xA;            ]&#xA;        }&#xA;    },&#xA;    "from": "0",&#xA;    "size": "20"&#xA;}&#xA;</code></pre>&#xA;
32544419
return distance with _source using Elasticsearch inside function_score
<p>Can anyone please tell me In ElasticSearch how to return distance using function_score my code is given below.</p>&#xA;&#xA;<pre><code>function_score: {&#xA;          query: {&#xA;            query_string: {&#xA;              query: shop_search,&#xA;              fields: [ 'shop_name', 'address.state', 'address.city', 'address.country', 'address.street'] &#xA;            }&#xA;          },&#xA;//          boost: 5.0,&#xA;            gauss: {&#xA;              _score,&#xA;              location: { &#xA;                origin: { lat:  12.8748964,&#xA;                  lon: 77.6413239&#xA;                },&#xA;                scale: "0.1km",&#xA;                offset: "0km",&#xA;                decay: "0.000005"&#xA;              }&#xA;            }&#xA;        }&#xA;</code></pre>&#xA;
<p>You need to use script fields to achieve this.&#xA;Something like below should work for you - </p>&#xA;&#xA;<pre><code>{&#xA;    "query" : {&#xA;        ...&#xA;    },&#xA;    "script_fields" : {&#xA;        "distance" : {&#xA;            "script" : "doc['location'].distanceInKm(12.8748964, 77.6413239)"&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Please go through <a href="https://qbox.io/blog/computing-distance-from-a-reference-point-with-script-fields-and-the-explain-api" rel="nofollow">this</a> and <a href="http://blog.qbox.io/logging-and-scripted_fields-in-elasticsearch" rel="nofollow">this</a>  to get a better idea.</p>&#xA;
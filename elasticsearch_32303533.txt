32303533
Matching multiple attribs with elasticsearch
<p>So i have a bunch of records like <code>{A: x, B: y}</code>.</p>&#xA;&#xA;<p>I would like to construct a search query that match both <code>A</code> and <code>B</code> attrib.</p>&#xA;&#xA;<p>However, adding 1 more criteria into <code>match</code>, the query would fail to parse.</p>&#xA;&#xA;<p>This works.</p>&#xA;&#xA;<pre><code>{&#xA;   "query" : {&#xA;       "match": {&#xA;           "A": "x"&#xA;       }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>This doesn't.</p>&#xA;&#xA;<pre><code>{&#xA;   "query" : {&#xA;       "match": {&#xA;           "A": "x",&#xA;           "B": "y"&#xA;       }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;
<p>Using term query, try this:</p>&#xA;&#xA;<pre><code>{&#xA;   "query": {&#xA;       "bool": {&#xA;          "should": [&#xA;              {&#xA;                "term": {"A": "x"}&#xA;              },&#xA;              {&#xA;                "term": {"B": "y"}&#xA;              }&#xA;          ]&#xA;       }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>or match query can do this:</p>&#xA;&#xA;<pre><code>{&#xA;   "query": {&#xA;       "bool": {&#xA;          "should": [&#xA;              {&#xA;                 "match": {"A": "x"}&#xA;              },&#xA;              {&#xA;                 "match": {"B": "y"}&#xA;              }&#xA;           ]&#xA;        }&#xA;     }&#xA; }&#xA;</code></pre>&#xA;
<p>It should be like this:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;   "bool": {&#xA;      "must": [&#xA;          {&#xA;             "match": {"A": "x"}&#xA;          },&#xA;          {&#xA;             "match": {"B": "y"}&#xA;          }&#xA;       ]&#xA;    }&#xA;   }&#xA; }&#xA;</code></pre>&#xA;&#xA;<p>Use <code>must</code> to <code>AND</code> all your match clauses, use <code>should</code> to <code>OR</code> all match clauses.</p>&#xA;
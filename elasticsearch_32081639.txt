32081639
How to define the shards number on ElasticSearch?
<p>I've installed, a elasticsearch cluster with three nodes, i pretend to use for search emails.</p>&#xA;&#xA;<p>On my platform i'll have 40k mails per month. So my question is How to define the shards number and replicas number on ElasticSearch?</p>&#xA;&#xA;<p>Are there best practices for the measure?</p>&#xA;&#xA;<p>Thanks in advance.</p>&#xA;
<p>You can define it in the elasticsearch.yml file or when you create a template for an index.  </p>&#xA;
<p>The best would be to have an index per timeframe like one index per month or week. This will help because we cant increase the number of shards per index once its created.</p>&#xA;&#xA;<p>Now you need to define the maping and settings of the indices that are going to be created in future. So you need to define an <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates.html" rel="nofollow">index template</a> which will in turn define these.</p>&#xA;&#xA;<p>The best practice would be to define the shard number and replica number in the template.</p>&#xA;&#xA;<p>Following is a sample template which would be applied to any index who is not created and has a name starting with te.</p>&#xA;&#xA;<pre><code>curl -XPUT localhost:9200/_template/te_prefix -d '{&#xA;    "template" : "te*",&#xA;        "settings" : {&#xA;            "number_of_shards" : 3,&#xA;            "number_of_replicas" : 1&#xA;        },&#xA;    "mappings" : {&#xA;        "_default_" : {&#xA;            "_all" : { "enabled" : false }&#xA;        }&#xA;    }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>Or if you want to create just one index and settings , you can use the following - &#xA;Here index name is stats.</p>&#xA;&#xA;<pre><code>curl -X PUT "http://localhost/stats" -d '{&#xA;  "settings": {&#xA;    "index": {&#xA;      "number_of_shards": 1,&#xA;      "number_of_replicas": 1&#xA;    },&#xA;    "analysis": {&#xA;      "analyzer": {&#xA;        "flat": {&#xA;          "type": "custom",&#xA;          "tokenizer": "keyword",&#xA;          "filter": "lowercase"&#xA;        }&#xA;      }&#xA;    }&#xA;  },&#xA;  "mappings": {&#xA;    "stats": {&#xA;      "properties": {&#xA;        "DocCount": {&#xA;          "type": "long"&#xA;        },&#xA;        "Query": {&#xA;          "type": "string",&#xA;          "analyzer": "flat"&#xA;        },&#xA;        "ResponseTime": {&#xA;          "type": "long"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;
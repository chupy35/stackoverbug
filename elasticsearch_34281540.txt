34281540
Elasticsearch how to order by filter query
<p><strong>i have the following query the result is satisfying but the order of result not according to  filter applied.</strong></p>&#xA;&#xA;<p>the order of results should be:&#xA;a1.in&#xA;a2.in&#xA;a3.in</p>&#xA;&#xA;<p>but the results are not ordered by the filters.</p>&#xA;&#xA;<p>my question is how i can order by the results as per the filters applied?</p>&#xA;&#xA;<p>thanks in advance.</p>&#xA;&#xA;<p><strong>Following is the query i am using</strong></p>&#xA;&#xA;<pre><code>post /mycity/_search?_source=meta_description,url,h1tag&#xA;{&#xA;"query": {&#xA;    "function_score":{&#xA;     "query":{&#xA;          "match_phrase_prefix": {&#xA;       "meta_description.edgegrm": {&#xA;        "query": "best restaurant",&#xA;        "prefix_length": 1,&#xA;        "max_expansions": 5,&#xA;        "slop":10,&#xA;        "minimum_should_match":"75%"&#xA;&#xA;       }&#xA;    }   &#xA;     },&#xA;     "query":{&#xA;        "match_phrase_prefix": {&#xA;       "content.edgegrm": {&#xA;        "query": "best restaurant",&#xA;        "prefix_length": 1,&#xA;        "max_expansions": 5,&#xA;        "slop":10,&#xA;        "minimum_should_match":"75%"&#xA;&#xA;       }&#xA;    }&#xA;     },&#xA;     "functions":[&#xA;         {&#xA;             "filter":{"term": {&#xA;            "host": "www.a1.in/city"&#xA;         }},&#xA;         "weight":100&#xA;&#xA;         },&#xA;         {&#xA;             "filter":{&#xA;              "term": {&#xA;                 "host": "www.a2.in/city"&#xA;              }   &#xA;             },&#xA;             "weight":50&#xA;         },&#xA;              {&#xA;             "filter":{&#xA;              "term": {&#xA;                 "host": "www.a3.in/city"&#xA;              }   &#xA;             },&#xA;             "weight":25&#xA;         }&#xA;&#xA;&#xA;         ],&#xA;         "score_mode": "sum"&#xA;&#xA;&#xA;    }&#xA;&#xA;},&#xA;&#xA;"from":0,&#xA;"size":100&#xA;}&#xA;</code></pre>&#xA;
<p>Try setting boost_mode to sum as well.</p>&#xA;
31262054
How to get total score specific to each row
<p>I need, Elasticsearch GET query to view the total score of each and every students by adding up the marks earned by them in all the subject rather I am getting total score of all the students in every subject.</p>&#xA;&#xA;<pre><code>GET /testindex/testindex/_search&#xA;{&#xA;  "query" : {&#xA;    "filtered" : {&#xA;        "query" : { &#xA;          "match_all" : {}&#xA;        }&#xA;    }&#xA; },&#xA; "aggs": {&#xA;    "total": {&#xA;        "sum": {&#xA;           "script" : "doc['physics'].value + doc['maths'].value + doc['chemistry'].value"&#xA;         }&#xA;     }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Output</p>&#xA;&#xA;<pre><code>  {&#xA;    ....&#xA;   "hits": [&#xA;     {&#xA;        "_index": "testindex",&#xA;        "_type": "testindex",&#xA;        "_id": "1",&#xA;        "_score": 1,&#xA;        "_source": {&#xA;           "personalDetails": {&#xA;              "name": "viswa",&#xA;              "age": "33"&#xA;           },&#xA;           "marks": {&#xA;              "physics": 18,&#xA;              "maths": 5,&#xA;              "chemistry": 34&#xA;           },&#xA;           "remarks": [&#xA;              "hard working",&#xA;              "intelligent"&#xA;           ]&#xA;        }&#xA;     },&#xA;     {&#xA;        "_index": "testindex",&#xA;        "_type": "testindex",&#xA;        "_id": "2",&#xA;        "_score": 1,&#xA;        "_source": {&#xA;           "personalDetails": {&#xA;              "name": "bob",&#xA;              "age": "13"&#xA;           },&#xA;           "marks": {&#xA;              "physics": 48,&#xA;              "maths": 45,&#xA;              "chemistry": 44&#xA;           },&#xA;           "remarks": [&#xA;              "hard working",&#xA;              "intelligent"&#xA;           ]&#xA;        }&#xA;     }&#xA;  ]&#xA;  },&#xA;  "aggregations": {&#xA;     "total": {&#xA;        "value": 194&#xA;     }&#xA;  }&#xA; }&#xA;</code></pre>&#xA;&#xA;<p>Expected Output:</p>&#xA;&#xA;<p>I would like to get total mark earned in subjects of each and every student rather than total of all the students.</p>&#xA;&#xA;<p>What changes I need to do in the query to achieve this. </p>&#xA;
<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "query": {&#xA;        "match_all": {}&#xA;      }&#xA;    }&#xA;  },&#xA;  "aggs": {&#xA;    "student": {&#xA;      "terms": {&#xA;        "field": "personalDetails.name",&#xA;        "size": 10&#xA;      },&#xA;      "aggs": {&#xA;        "total": {&#xA;          "sum": {&#xA;            "script": "doc['physics'].value + doc['maths'].value + doc['chemistry'].value"&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>But, be careful, for <code>student</code> <code>terms</code> aggregation you need a "unique" (something that makes that student unique - like a personal ID or something) field, maybe the <code>_id</code> itself, but you need to <code>store</code> it.</p>&#xA;
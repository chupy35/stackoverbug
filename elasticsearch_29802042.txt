29802042
ElasticSearch sort order for multiple fields
<p>What is the best way to specify the <a href="http://www.elastic.co/guide/en/elasticsearch/guide/current/_sorting.html" rel="nofollow">sort order in ElasticSearch</a> for multiple fields? The query string format does not seem to work at all:</p>&#xA;&#xA;<pre><code>http://elasticsearch_url/index/_search?sort=field1:asc&amp;sort=field2:desc&amp;size=100&#xA;</code></pre>&#xA;&#xA;<p>One would like to sort first by field1, then by field2, but only one of the fields seems to be sorted correctly. The full notations works better, but the first entries have occasionally the wrong search order:</p>&#xA;&#xA;<pre><code>curl -s -XGET http://elasticsearch_url/index/_search -d '&#xA;{&#xA;    "sort": [&#xA;        { "field1": { "order": "desc" }},&#xA;        { "field2": { "order": "desc" }}&#xA;    ],&#xA;    "size": 100&#xA;}'&#xA;</code></pre>&#xA;
<p>Apparently the second, full notation works better.</p>&#xA;&#xA;<p>There was another problem that one of the fields contained urls, which was parsed in odd ways by ElasticSearch. Even normal <a href="http://awesomism.co.uk/sorting-string-fields-with-elasticsearch/" rel="nofollow noreferrer">string fields</a> can be difficult to sort, <a href="https://stackoverflow.com/questions/18977834/indexing-website-url-in-elastic-search">indexing a url in ElasticSearch</a> is even more difficult.</p>&#xA;
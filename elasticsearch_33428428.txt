33428428
Synonym analyzer not giving results
<p>I have the following custom analyzer defined:</p>&#xA;&#xA;<pre><code>{&#xA;  "analysis": {&#xA;    "analyzer": {&#xA;      "products-alike": {&#xA;        "filter": [&#xA;          "lowercase",&#xA;          "product-db"&#xA;        ],&#xA;        "tokenizer": "standard"&#xA;      }&#xA;    },&#xA;    "filter": {&#xA;      "product-db": {&#xA;        "type": "synonym",&#xA;        "synonyms": [&#xA;          "Xiaomi,Mi,Mi3,Mi4,Redmi",&#xA;          "OnePlus,OnePlusOne,OnePlus1,OnePlus2"&#xA;        ]&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Now I have mapped this to the required field and done the querying. But there are results only for exact matches, like if I query <code>Xiaomi</code>, there are results, but <code>Mi</code> or <code>Mi3</code> won't get me any. Why is this happening and can any one help to make this working?</p>&#xA;
<p>You simply need to write all your synonyms in lowercase instead of CamelCase, like this:</p>&#xA;&#xA;<pre><code>{&#xA;  "analysis": {&#xA;    "analyzer": {&#xA;      "products-alike": {&#xA;        "filter": [&#xA;          "lowercase",&#xA;          "product-db"&#xA;        ],&#xA;        "tokenizer": "standard"&#xA;      }&#xA;    },&#xA;    "filter": {&#xA;      "product-db": {&#xA;        "type": "synonym",&#xA;        "synonyms": [&#xA;          "xiaomi,mi,mi3,mi4,redmi",&#xA;          "oneplus,oneplusone,oneplus1,oneplus2"&#xA;        ]&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>After this, it will work, i.e. if you query for <code>Mi3</code>, you'll match all the synonym tokens:</p>&#xA;&#xA;<pre><code>curl -XGET 'localhost:9200/your_index/_analyze?analyzer=products-alike&amp;pretty' -d 'Mi3'&#xA;</code></pre>&#xA;&#xA;<p>Results:</p>&#xA;&#xA;<pre><code>{&#xA;  "tokens" : [ {&#xA;    "token" : "xiaomi",&#xA;    "start_offset" : 0,&#xA;    "end_offset" : 3,&#xA;    "type" : "SYNONYM",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "mi",&#xA;    "start_offset" : 0,&#xA;    "end_offset" : 3,&#xA;    "type" : "SYNONYM",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "mi3",&#xA;    "start_offset" : 0,&#xA;    "end_offset" : 3,&#xA;    "type" : "SYNONYM",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "mi4",&#xA;    "start_offset" : 0,&#xA;    "end_offset" : 3,&#xA;    "type" : "SYNONYM",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "redmi",&#xA;    "start_offset" : 0,&#xA;    "end_offset" : 3,&#xA;    "type" : "SYNONYM",&#xA;    "position" : 1&#xA;  } ]&#xA;}&#xA;</code></pre>&#xA;
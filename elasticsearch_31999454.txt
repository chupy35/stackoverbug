31999454
Disable query normalization in Elasticsearch
<p>I have an elasticsearch index with documents, which have nested documents with an "importance" field.</p>&#xA;&#xA;<p>I try to query for the nested documents and get a score for the parent document, which is the sum of the "importance" field of the nested documents (I do this with a "function_score" query)</p>&#xA;&#xA;<p>The problem now is: I have a dynamic count of terms I search with. So the query normalisation has a different factor everytime. And this makes it hard to debug my query.</p>&#xA;&#xA;<p>Example</p>&#xA;&#xA;<pre><code>device_1&#xA;    component_1 (importance: 1)&#xA;    component_2 (importance: 0.5)&#xA;    component_3 (importance: 0.2)&#xA;    component_4 (importance: 1.5)&#xA;&#xA;device_2&#xA;    component_1 (importance: 0.3)&#xA;    component_3 (importance: 2)&#xA;    component_4 (importance: 1)&#xA;</code></pre>&#xA;&#xA;<p>The device is the document, the components are nested documents. </p>&#xA;&#xA;<p>Now, when I search for "component_3" and "component_2" I want to have the following result:</p>&#xA;&#xA;<pre><code>device_1, score: 0.7 (0.2 + 0.5)&#xA;device_2, score: 2 (2)&#xA;</code></pre>&#xA;&#xA;<p>But the query normalisation factor is different when I search for one component, or two or three. So I always get different scores, and it is hard to debug and find out if the query does what it should.</p>&#xA;&#xA;<p>Is it possible, to disable the query normalisation? Are there other ideas to deal with fixed scores? I don`t need my queries to be comparable, I need them to be comprehensible.</p>&#xA;
<p>You can try to use "replace" as "boost_mode"&#xA;<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html</a></p>&#xA;
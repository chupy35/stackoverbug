33872216
Elastic Search max on string fields
<p>In SQL, it is possible to use MAX() on string fields to get a distinct value (assuming the group by is correct).</p>&#xA;&#xA;<p>However this is not possible in ElasticSearch, since MAX only works on numeric fields. However I want to retrieve the values of some string fields after my aggregations, so I can display these values.</p>&#xA;&#xA;<p>eg assuming a generic books structure</p>&#xA;&#xA;<pre><code>{&#xA;  "aggs" : {&#xA;     "group_by_author" : { "terms" : { "field" : "author"},&#xA;     "aggs" : { &#xA;      "books_published" : { "sum" : { "field" : "name"}},&#xA;      "distinct_title" : { "max" : {"field" : "some_relevant_field_name"}}&#xA;    }&#xA;  }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here I cannot perform the max on some_relevant_field_name since it is a string. Is there an alternative way to do this apart from more aggregations ?</p>&#xA;
<p>If you want to find the distinct book titles for each author, maybe should your try to use the "terms" aggregation in the "distinct_title" field:</p>&#xA;&#xA;<pre><code>{&#xA;    "aggs":{&#xA;        "group_by_author":{&#xA;            "terms":{&#xA;                "field":"author"&#xA;            },&#xA;            "aggs":{&#xA;                "books_published":{&#xA;                    "sum":{&#xA;                        "field":"name"&#xA;                    }&#xA;                },&#xA;                "distinct_title":{&#xA;                    "terms":{&#xA;                        "field":"some_relevant_field_name"&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }   &#xA;}&#xA;</code></pre>&#xA;&#xA;<p>It should create buckets of book titles for each author as described in the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html" rel="nofollow">documentation</a>.</p>&#xA;
31500282
Elasticsearch filter multiple fields
<p>I have following data set indexed in my elasticsearch</p>&#xA;&#xA;<pre><code>{&#xA;"title": "Professor",&#xA;"class": [6001, 6015, 6018],&#xA;"subject": [5010, 5012, 5013],&#xA;"salary": 12500&#xA;}&#xA;&#xA;{&#xA;"title": "Professor",&#xA;"class": [6012, 6013, 6014],&#xA;"subject": [5010, 5005, 5004],&#xA;"salary": 16600&#xA;}&#xA;&#xA;{&#xA;"title": "Principal",&#xA;"class": [7001, 7010, 6018],&#xA;"subject": [5010, 5012, 5013],&#xA;"salary": 14750&#xA;}&#xA;&#xA;{&#xA;"title": "Asst Professor",&#xA;"class": [6012, 6013, 6014],&#xA;"subject": [5010, 5005, 5004],&#xA;"salary": 16600&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I'm trying to search</p>&#xA;&#xA;<p><em>class  - 6001 OR 6018 OR 6013&#xA;AND&#xA;subject - 5013 OR 5004&#xA;AND&#xA;salary (range) - 12000 to 15000</em></p>&#xA;&#xA;<p>I'm using below query </p>&#xA;&#xA;<pre><code>{&#xA;   "query" : {&#xA;      "filtered" : {&#xA;         "filter" : {&#xA;            "bool" : {            &#xA;                  "must" : [&#xA;                    { "term" : {"class" : [6001, 6018, 6013]}}, &#xA;                    { "term" : {"subject" : [5013, 5004]}},&#xA;                    {"range" : {"salary" : {"gte": 12000,"lte": 15000}}}&#xA;                  ]&#xA;                }}}}}&#xA;</code></pre>&#xA;&#xA;<p>But I'm not getting the result that Im expecting, what is wrong in this?</p>&#xA;
<p>You need to use <strong>terms</strong> filter instead of the <strong>term</strong> filter.</p>&#xA;&#xA;<p>As per the docs:</p>&#xA;&#xA;<blockquote>&#xA;  <p>Term Filter: Filters documents that have fields that contain a term.</p>&#xA;  &#xA;  <p>Terms Filter: Filters documents that have fields that match any of the&#xA;  provided terms.</p>&#xA;</blockquote>&#xA;&#xA;<pre><code>{&#xA;   "query" : {&#xA;      "filtered" : {&#xA;         "filter" : {&#xA;            "bool" : {            &#xA;                  "must" : [&#xA;                    { "terms" : {"class" : [6001, 6018, 6013]}}, &#xA;                    { "terms" : {"subject" : [5013, 5004]}},&#xA;                    { "range" : {"salary" : {"gte": 12000,"lte": 15000}}}&#xA;                  ]&#xA;                }}}}}&#xA;</code></pre>&#xA;
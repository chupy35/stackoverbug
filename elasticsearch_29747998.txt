29747998
GroovyScriptCompilationException : MultipleCompilationErrorsException startup failed
<p>I am new to elastic search and recently migrated the AWS instance running ES to another one. &#xA;I am facing the following issue - </p>&#xA;&#xA;<pre><code>Possibly unhandled Error: SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[_8uw3w4VQqux9ako2Yc1kw][twitter-2009][0]: SearchParseException[[twitter-2009][0]: query[(+created_time:[1426809600000 TO 1429488000000] brand_id:taruntahiliani)~1],from[-1],size[-1]: Parse Failure [Failed to parse source [{"query":{"bool":{"must":[{"range":{"created_time":{"gte":"2015-03-20T00:00:00.000Z","lte":"2015-04-20T00:00:00.000Z"}}}],"should":[{"match":{"brand_id":"TarunTahiliani"}}],"minimum_should_match":1}},"aggs":{"posts_over_days":{"terms":{"script":"Date date = new Date(doc['created_time'].date.getMillis() + 19800000) ;java.text.SimpleDateFormat format = new java.text.SimpleDateFormat('u');format.format(date)","order":{"_term":"asc"}}},"posts_over_hours":{"terms":{"script":"Date date = new Date(doc['created_time'].date.getMillis() + 19800000) ;java.text.SimpleDateFormat format = new java.text.SimpleDateFormat('HH');format.format(date)","order":{"_term":"asc"},"size":24}},"users_most_replied":{"terms":{"script":"return if(doc['reply'].empty) {} else {doc['in_reply_to_screen_name.raw'].value}","size":4}},"users_most_retweeted":{"terms":{"script":"return if(doc['retweet'].empty) {} else {doc['retweeted_user_screen_name.raw'].value+'|'+doc['retweeted_user_name.raw'].value+'|'+doc['retweeted_user_image.raw'].value}","size":4}},"users_most_mentioned":{"terms":{"field":"mention_entries.raw","size":4}}}}]]]; nested:&#xA; GroovyScriptCompilationException[MultipleCompilationErrorsException[startup failed:&#xA;at respond (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/transport.js:233:15)&#xA;at checkRespForFailure (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/transport.js:201:7)&#xA;at HttpConnector.&lt;anonymous&gt; (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/connectors/http.js:147:7)&#xA;at IncomingMessage.bound (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/node_modules/lodash-node/modern/internals/baseBind.js:56:17)&#xA;at IncomingMessage.EventEmitter.emit (events.js:117:20)&#xA;at _stream_readable.js:920:16&#xA;at process._tickDomainCallback (node.js:459:13)&#xA;&#xA;at Function.Promise$Defer (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/node_modules/bluebird/js/main/promise.js:296:13)&#xA;at Transport.defer (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/transport.js:102:18)&#xA;at Transport.request (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/transport.js:291:18)&#xA;at exec (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/client_action.js:284:20)&#xA;at Object.action (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/elasticsearch/src/lib/client_action.js:28:14)&#xA;at Object.module.exports.getTwitterTweetsAnalytics (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/api/controllers/AnalyticsController.js:2159:10)&#xA;at bound (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/sails/node_modules/lodash/dist/lodash.js:729:21)&#xA;at routeTargetFnWrapper (/home/harshil/working_dir/prophesee/dashboard-backend/PropheseeDashboard/node_modules/sails/lib/router/bind.js:179:5)&#xA;</code></pre>&#xA;&#xA;<p>The ES version I'm currently using is 1.5.1. Can anyone point me in the right direction regarding how to solve this?</p>&#xA;
<p>Can refer to my notes, about groovy abnormalities, the most likely is that it requires more stringent:</p>&#xA;&#xA;<p><a href="https://note.youdao.com/share/?id=b7aa6a0f76f460d8c91512d4fd164a7d&amp;type=note#/" rel="nofollow noreferrer">https://note.youdao.com/share/?id=b7aa6a0f76f460d8c91512d4fd164a7d&amp;type=note#/</a></p>&#xA;
<p>Exception in thread "main" org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:&#xA;script15223772316671720760001.groovy: 1: unexpected token: stopWatch @ line 1, column 1070. </p>&#xA;&#xA;<p>The question was caused by groovy itself,The solution is that you can your code add ";" in the "}" behind;eg:</p>&#xA;&#xA;<p><a href="https://i.stack.imgur.com/QGI2h.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/QGI2h.png" alt="enter image description here"></a></p>&#xA;
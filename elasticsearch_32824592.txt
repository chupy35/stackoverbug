32824592
Cant index desired number of docs
<p>I am indexing 1000 json docs in elastic search one by one (just for testing purposes) like this</p>&#xA;&#xA;<pre><code>deleteIndex(myIndex);&#xA;List&lt;XContentBuilder&gt; docs = new ArrayList&lt;XContentBuilder&gt;();&#xA;for (int i=0;i&lt; 1000; i++)&#xA;{&#xA;   docs.add(createJsonDoc());&#xA;}&#xA;for (int i = 0; i &lt; 1000; i++)    &#xA;{&#xA;   client.prepareIndex(myindex, mytype)&#xA;            .setSource(docs.get(i))&#xA;            .execute();&#xA;            //Thread.sleep(10);           &#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I noticed that every time I run this code it always indexes less than 1000 docs.&#xA;The only way I can get it to index 1000 is if I uncomment the thread.sleep line above.</p>&#xA;&#xA;<p>Why is that?</p>&#xA;
<p>Inspect the response that comes back from ES, some of them are most likely failing.  Here is an extension method we use on all our calls:</p>&#xA;&#xA;<pre><code>    internal IRestResponse&lt;T&gt; VerifyResponse&lt;T&gt;(IRestResponse&lt;T&gt; response, Action okAction)&#xA;    {&#xA;        response.ThrowIfNull("response");&#xA;&#xA;        if (response.StatusCode == HttpStatusCode.OK)&#xA;        {&#xA;            if (okAction != null)&#xA;            {&#xA;                okAction();&#xA;            }&#xA;&#xA;            return response;&#xA;        }&#xA;&#xA;        if (response.StatusCode == HttpStatusCode.BadRequest)&#xA;        {&#xA;            throw new BadRequestException(response);&#xA;        }&#xA;&#xA;        throw new Exception(string.Format("Unhandled API result: {0}\r\n{1}", response.StatusCode, response.Content));&#xA;    }&#xA;</code></pre>&#xA;
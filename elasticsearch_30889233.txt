30889233
elasticsearch aggregation group by null key
<p>here is the data in my elasticsearch server:</p>&#xA;&#xA;<pre><code>{"system": "aaa"},&#xA;{"system": "bbb"},&#xA;{"system": null}&#xA;</code></pre>&#xA;&#xA;<p>I want to get the statistics for system. then I did the query:</p>&#xA;&#xA;<pre><code>{&#xA;    "aggs" : {&#xA;        "myAggrs" : {&#xA;            "terms" : { "field" : "system" }&#xA;        } &#xA;}&#xA;</code></pre>&#xA;&#xA;<p>it gives me the result:</p>&#xA;&#xA;<pre><code>    {&#xA;       "key": "aaa",&#xA;       "doc_count": 1&#xA;    },&#xA;    {&#xA;       "key": "bbb",&#xA;       "doc_count": 1&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>but the <code>"key" : null</code> is not included in the result, how can I get it? &#xA;here is my expect result:</p>&#xA;&#xA;<pre><code>{&#xA;   "key": "aaa",&#xA;   "doc_count": 1&#xA;},&#xA;{&#xA;   "key": "bbb",&#xA;   "doc_count": 1&#xA;},&#xA;{&#xA;   "key": null,&#xA;   "doc_count": 1&#xA;}&#xA;</code></pre>&#xA;
<p>I don't think you can do this with <code>terms</code>. Try with another aggregation:</p>&#xA;&#xA;<pre><code>{&#xA;  "aggs": {&#xA;    "myAggrs": {&#xA;      "terms": {&#xA;        "field": "system"&#xA;      }&#xA;    },&#xA;    "missing_system": {&#xA;      "missing": {&#xA;        "field": "system"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And the result will be:</p>&#xA;&#xA;<pre><code>   "aggregations": {&#xA;      "myAggrs": {&#xA;         "doc_count_error_upper_bound": 0,&#xA;         "sum_other_doc_count": 0,&#xA;         "buckets": [&#xA;            {&#xA;               "key": "aaa",&#xA;               "doc_count": 1&#xA;            },&#xA;            {&#xA;               "key": "bbb",&#xA;               "doc_count": 1&#xA;            }&#xA;         ]&#xA;      },&#xA;      "missing_system": {&#xA;         "doc_count": 1&#xA;      }&#xA;   }&#xA;</code></pre>&#xA;
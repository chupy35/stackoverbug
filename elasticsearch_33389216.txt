33389216
How to ignore must condition for specified terms in elastic search?
<p>Is there any way that we can ignore applying must condition in elastic search queries for specified fields</p>&#xA;&#xA;<pre><code>"query": {&#xA;  "filtered": {&#xA;     "filter": {&#xA;        "bool": {&#xA;           "must": [&#xA;              {&#xA;                 "term": {&#xA;                    "user": "abc@xyz.com"&#xA;                 }&#xA;              }&#xA;           ]&#xA;        }&#xA;     }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>In the above query i am trying to filter all the records based on the particular user. </p>&#xA;&#xA;<p>Requirement is, in one term i.e field i want to return all the records irrespective of user.</p>&#xA;&#xA;<p>Ex : </p>&#xA;&#xA;<pre><code>"query": {&#xA;  "filtered": {&#xA;     "filter": {&#xA;        "bool": {&#xA;           "must": [&#xA;              {&#xA;                 "term": {&#xA;                    "user": "abc@xyz.com"&#xA;                 },&#xA;                 "term":{&#xA;                    "field":"events",&#xA;                    "size":0&#xA;                 }&#xA;              }&#xA;           ]&#xA;        }&#xA;     }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Is it possible? </p>&#xA;&#xA;<p>Currently i am handling it with 2 queries, But is there any chance of doing it in single query? </p>&#xA;&#xA;<p>Thanks in advance...</p>&#xA;
<p>Maybe something like this, if I understood well the question:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "bool": {&#xA;          "should": [&#xA;            {&#xA;              "bool": {&#xA;                "must": [&#xA;                  {&#xA;                    "term": {&#xA;                      "user": "abc@xyz.com"&#xA;                    }&#xA;                  }&#xA;                ],&#xA;                "must_not": [&#xA;                  {&#xA;                    "term": {&#xA;                      "field": "events"&#xA;                    }&#xA;                  }&#xA;                ]&#xA;              }&#xA;            },&#xA;            {&#xA;              "bool": {&#xA;                "must": [&#xA;                  {&#xA;                    "term": {&#xA;                      "field": "events"&#xA;                    }&#xA;                  }&#xA;                ]&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
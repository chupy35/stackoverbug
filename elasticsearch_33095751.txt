33095751
multivalue or array indexing in elasticsearch
<p>I'd like to know a bit more about the next situation. I'm trying to index a document like this:</p>&#xA;&#xA;<pre><code>PUT 'server/index/test/1'&#xA;{&#xA;    to: "to1",&#xA;    to: "to2",&#xA;    to: "to3"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Seemingly, elasticsearch swallows this document. Ok , no problem. Nevertheless, I would like to know which are the differences between an array of values.</p>&#xA;&#xA;<p>How the searches are made?</p>&#xA;&#xA;<p><strong>EDITED:</strong></p>&#xA;&#xA;<p>I've tried this searches:</p>&#xA;&#xA;<pre><code>GET 'server/index/test/_search?q=to:to1&amp;pretty'&#xA;GET 'server/index/test/_search?q=to:to2&amp;pretty'&#xA;GET 'server/index/test/_search?q=to:to3&amp;pretty'&#xA;</code></pre>&#xA;&#xA;<p>and ES shows me the document after each execution:</p>&#xA;&#xA;<pre><code>{&#xA;   "took" : 44,&#xA;   "timed_out" : false,&#xA;   "_shards" : {&#xA;       "total" : 5,&#xA;       "successful" : 5,&#xA;       "failed" : 0&#xA;   },&#xA;   "hits" : {&#xA;   "total" : 1,&#xA;   "max_score" : 1.0,&#xA;       "hits" : [ {&#xA;           "_index" : "index",&#xA;           "_type" : "test",&#xA;           "_id" : "1",&#xA;           "_score" : 1.0,&#xA;           "_source":&#xA;           {&#xA;               to: "to1",&#xA;               to: "to2",&#xA;               to: "to3"&#xA;           }&#xA;       } ]&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Seemingly, ES indexes every repeated field value also... Is it really like this? Or I'm performing or doing something wrong?</p>&#xA;
<p>In a JSON document you cannot have two fields with the same name, but ES will silently "fix" your document and only index a single <code>to</code> field. Moreover, since a JSON document is basically a map, which is inherently unordered, you have no guarantee as to which one of the three <code>to</code> fields get indexed.</p>&#xA;&#xA;<p>So if you index that document, it will work, but you'll only see a single <code>to</code> field in it, which is probably <strong>not what you want</strong>:</p>&#xA;&#xA;<pre><code>PUT 'server/test/1'&#xA;{&#xA;    to: "to1",&#xA;    to: "to2",&#xA;    to: "to3"&#xA;}&#xA;&#xA;GET 'server/test/1'&#xA;{&#xA;    to: "to3"            &lt;--- could also be to1 or to2&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>However, if you make <code>to</code> an array of values then all the values will be indexed</p>&#xA;&#xA;<pre><code>PUT 'server/test/1'&#xA;{&#xA;    to: ["to1", "to2", "to3"]&#xA;}&#xA;&#xA;GET 'server/test/1'&#xA;{&#xA;    to: ["to1", "to2", "to3"]&#xA;}&#xA;</code></pre>&#xA;
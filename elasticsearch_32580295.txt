32580295
elasticsearch match all words from document in the search query
<p>We can search for ALL words in a specific document.field like this:</p>&#xA;&#xA;<pre><code>{ "query" : { "match" : { "title": { "query" : "Black Nike Mens", "operator" : "and" } } } }&#xA;</code></pre>&#xA;&#xA;<p>This will search for the words <code>Black</code>, <code>Nike</code> and <code>Mens</code> in the field <code>title</code> such that only those documents are returned that will have ALL these words in the <code>title</code> field.</p>&#xA;&#xA;<p>But what I am trying to do is a little different.</p>&#xA;&#xA;<p>I want to lookup such that if all the words of the <code>title</code> field of the document are present in my search query then it will return that document.</p>&#xA;&#xA;<p>For e.g.</p>&#xA;&#xA;<p>suppose there is a document with <code>title : "Nike Free Sparq Mens White"</code> in the elasticsearch database</p>&#xA;&#xA;<p>now if I search with a <code>query : "Nike Free Sparq 09 - Mens - White/Black/Varsity Red"</code> then it should return this document, because all the words in the document.title do exist in my query</p>&#xA;&#xA;<p>but if I search with a <code>query : "Nike Free Lebron - Mens - White/Black"</code> then it should NOT return the document because my query has the word <code>Sparq</code> missing</p>&#xA;&#xA;<p>this is a sort of reverse-and-operator search</p>&#xA;&#xA;<p>Is this possible? If yes, then how?</p>&#xA;
<p>I finally got it to work but not with a direct method!</p>&#xA;&#xA;<p>This is what I do:</p>&#xA;&#xA;<ul>&#xA;<li>Create a clean list of words from the source query, by:&#xA;&#xA;<ul>&#xA;<li>change to lower case</li>&#xA;<li>replacing any special chars and punctuation with space</li>&#xA;<li>remove duplicate words</li>&#xA;</ul></li>&#xA;<li>Search using normal match with OR operator for the words joined as a string</li>&#xA;<li>Now we will find the best relevant hits in result</li>&#xA;<li>We take those hits one by one and do a word to word search in php (or whatever programming language you use)</li>&#xA;<li>This word search will check for all the words of a document from the hits we just found, and match them with the words in source query; such that all words from hit document should be present in the source query string</li>&#xA;</ul>&#xA;&#xA;<p>This worked for me well enough!</p>&#xA;&#xA;<p>Unless someone has a direct method from elasticsearch query language.</p>&#xA;
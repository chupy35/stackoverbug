28445304
Strip HTML tags before indexing into elasticsearch
<p>I am working to index HTML files into elastic using Nodejs. However even before using the Nodejs, I tried to run following manual indexing which doesn't seems working. What I am missing?</p>&#xA;&#xA;<p>Index sample HTML tag using html_strip filter:</p>&#xA;&#xA;<pre><code>curl -XPOST 'localhost:9200/bhs/articles/_analyzer?tokenizer=standard&amp;char_filters=html_strip' -d '&#xA;{&#xA;    "content" : "&lt;title&gt;Dilip Kumar&lt;/title&gt;"&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>Search to get all documents:</p>&#xA;&#xA;<pre><code>http://localhost:9200/bhs/articles/_search&#xA;</code></pre>&#xA;&#xA;<p>It gives following as result:</p>&#xA;&#xA;<pre><code>{&#xA;  "took": 4,&#xA;  "timed_out": false,&#xA;  "_shards": {&#xA;    "total": 5,&#xA;    "successful": 5,&#xA;    "failed": 0&#xA;  },&#xA;  "hits": {&#xA;    "total": 1,&#xA;    "max_score": 1,&#xA;    "hits": [&#xA;      {&#xA;        "_index": "bhs",&#xA;        "_type": "articles",&#xA;        "_id": "AUt2TGl9aadd5iLJ3mue",&#xA;        "_score": 1,&#xA;        "_source": {&#xA;          "content": "&lt;title&gt;Dilip Kumar&lt;/title&gt;"&#xA;        }&#xA;      }&#xA;    ]&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Ideally it should not index  tag as I have used html_filter to strip tags.</p>&#xA;
<p>What you are seeing in the returned search result is the stored content, i.e. this is not the individual terms that have been indexed.</p>&#xA;&#xA;<pre><code>"content": "&lt;title&gt;Dilip Kumar&lt;/title&gt;"&#xA;</code></pre>&#xA;&#xA;<p>To see what has been indexed is a little more challenging - the indexed terms are not designed to be returned to a user and instead only used when search.</p>&#xA;&#xA;<p>However you can access and view them by using a script:</p>&#xA;&#xA;<pre><code>curl 'http://localhost:9200/bhs/articles/_search?pretty=true' -d '{&#xA;  "query" : {&#xA;    "match_all" : { }&#xA;  },&#xA;  "script_fields": {&#xA;    "terms" : {&#xA;        "script": "doc[field].values",&#xA;        "params": {&#xA;            "field": "content"&#xA;        }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;
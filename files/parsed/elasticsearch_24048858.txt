24048858 Query value starting with dash causes elasticsearch count api to fail

This works:

    
    
    GET /box/item/_count?q=name%3Aabcdef
    

This doesn't:

    
    
    GET /box/item/_count?q=name%3A-abcdef
    

(The difference is the dash)

Reply from elasticsearch is: "Cannot parse 'name:-abcdeft'"

box/item is not_analyzed.

What to do?

Escaping it with a backslash works for me:

    
    
    GET /box/item/_count?q=name%3A\-abcdef
    

so does using quotes:

    
    
    GET /box/item/_count?q=name%3A"-abcdef"
    

The hyphen is a special character and like others needs to be escaped:

> reserved characters

>

> If you need to use any of the characters which function as operators in your
query itself (and not as operators), then you should escape them with a
leading backslash. For instance, to search for (1+1)=2, you would need to
write your query as \\(1\\+1\\)=2.

>

> The reserved characters are: + - && || ! ( ) { } [ ] ^ " ~ * ? : \ /

>

> Failing to escape these special characters correctly could lead to a syntax
error which prevents your query from running.


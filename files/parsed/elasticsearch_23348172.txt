23348172 elasticsearch index_name with multi_field

I have 2 separate indexes, each containing a different type I want to get
combined records from both.

The problem is that one type has field ' **email** ', the other has '
**work_email** '. However I want to treat them as the same thing for sorting
purposes. That is why I try to use **index_name** in one of the types.

Here are mappings:

**Index1:**

    
    
      "mappings": {
         "people": {
            "properties": {
               "work_email": {
                  "type": "string",
                  "index_name": "email",
                  "fields": {
                     "raw": {
                        "type": "string",
                        "index": "not_analyzed"
                     }
                  }
               }
            }
         }
      }
    

**Index2:**

    
    
      "mappings": {
         "companies": {
            "properties": {
               "email": {
                  "type": "string",
                  "fields": {
                     "raw": {
                        "type": "string",
                        "index": "not_analyzed"
                     }
                  }
               }
            }
         }
      }
    

I expect this to work:

    
    
    GET /index1,index2/people,companies/_search?
    {
      "sort": [
        {
          "email.raw": {
            "order": "asc"
          }
        }
      ]
    }
    

But, I get an error that there is no such field in the 'people' type. Am I
doing something wrong, or is there a better way to achieve what I need?

Here you can find a recreation script that illustrates the problem:
<https://gist.github.com/pmishev/11375297>

There is problem in the way you map the multi field..Check out the below
mapping and try to index..You should get the results

    
    
    "mappings": {
     "people": {
        "properties": {
               "work_email":{
                "type": "multi_field", 
                "fields": {
                    "work_email":{
                        "type": "string",
                        "index_name": "email"
                    },
                    "raw":{
                        "type": "string",
                        "index": "not_analyzed"
                    }
                }
            }
            }
            }
            }
    

We should specify the type to multi_field and under the fields we should
specify the required fields....

I ended up adding a 'copy_to' property in my mapping:

    
    
     "mappings": {
     "people": {
        "properties": {
           "work_email": {
              "type": "string",
              "copy_to": "email",
              "fields": {
                 "raw": {
                    "type": "string",
                    "index": "not_analyzed"
                 }
              }
           }
        }
     }
    

}

So now I can address both fields as **email**. It's not ideal, as this means
that the email field is actually indexed twice, but that was the only thing
that worked.


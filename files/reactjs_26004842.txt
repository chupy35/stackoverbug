26004842
How to get information from children
<p>I'm very new to reactjs (three days, in fact). I want to construct a component that lays out its children according to a policy (implemented by the component) and certain children properties. Some properties are passed directly to the children as props upon creation; some other properties, such as its dimensions, are intrinsic to each child. That is, this Layout component will be used like:</p>&#xA;&#xA;<pre><code>&lt;Layout&gt;&#xA;    &lt;Child1 propx=... propy=...&gt;...&lt;/Child1&gt;&#xA;    &lt;Child2 propz=...&gt;...&lt;/Child2&gt;&#xA;    ...&#xA;&lt;/Layout&gt;&#xA;</code></pre>&#xA;&#xA;<p>and the position of the children will depend on propx, propy, propz, ..., and the children sizes.</p>&#xA;&#xA;<p>Well, the Layout component needs to know the values of its children props and their sizes. At first, I gave the children classes a method 'getProperties' to return the relevant properties and I invoked the method in React.Children.forEach(this.props.children, fn) but I found that the object passed to fn is not the component instance so I cannot call getProperties on it. Then I tried to pass each Layout child an extra property 'uploadProperties' with a callback to be called by the child to tell the Layout what it needs to know. I know I cannot call setProps in the children, so I came up with this:</p>&#xA;&#xA;<pre><code>var Layout = React.createClass({&#xA;    storeChildProperties: function (properties) {&#xA;        this.childData = this.childData || [];&#xA;        this.childData.push(properties);&#xA;    },&#xA;    render: function () {&#xA;        var self = this;&#xA;        var children = [];&#xA;        React.Children.forEach(this.props.children, function (child) {&#xA;            var clone = React.addons.cloneWithProps(&#xA;                child,&#xA;                {key: child.props.key, uploadProperties: self.storeChildProperties});&#xA;            children.push(clone);&#xA;        });&#xA;        this.props.children = children;&#xA;        return &lt;div&gt;{this.props.children}&lt;/div&gt;;&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>It seems to work, but I feel uneasy about two things. First, I don't like attaching 'childData' to the Layout instance (I didn't know where else to put it). Second, I don't know if it's ok to replace this.props.children. Actually, it works even if I don't and I just</p>&#xA;&#xA;<pre><code>return &lt;div&gt;{children}&lt;/div&gt;;&#xA;</code></pre>&#xA;&#xA;<p>Anyway, is this a reasonable way to get info from children?</p>&#xA;
<p>You can access children's props via <code>this.props.children[0].props</code>.</p>&#xA;
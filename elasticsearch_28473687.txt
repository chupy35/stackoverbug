28473687
Elasticsearch Cluster - No known master node, scheduling a retry
<p>I have a server running elasticsearch and kibana. I have added a second node to form a cluster but only want that second node to replicate data from the master node.</p>&#xA;&#xA;<p>Based on limited documentation on how to do this, I am running into issue on second with following error</p>&#xA;&#xA;<pre><code>[DEBUG][action.admin.indices.get ] [Match] no known master node, scheduling a retry&#xA;</code></pre>&#xA;&#xA;<p>I am unable to determine the best configuration for both servers to achieve this but this is what I have done so far:</p>&#xA;&#xA;<p>Master Node Config:</p>&#xA;&#xA;<pre><code>cluster.name: elasticsearch&#xA;node.master: true&#xA;path.data: /local00/elasticsearch/&#xA;path.work: /local00/el_temp/&#xA;network.host: 0.0.0.0&#xA;http.port: 9200&#xA;script.disable_dynamic: true&#xA;</code></pre>&#xA;&#xA;<p>Node 2</p>&#xA;&#xA;<pre><code>cluster.name: elasticsearch&#xA;node.master: false&#xA;node.data: true&#xA;index.number_of_shards: 5&#xA;index.number_of_replicas: 1&#xA;path.data: /local00/elasticsearch/&#xA;path.work: /local00/el_temp/&#xA;network.host: 0.0.0.0&#xA;http.port: 9200&#xA;script.disable_dynamic: true&#xA;</code></pre>&#xA;&#xA;<p>I am assuming I am missing additional config somewhere. Any help will be much appreciated.</p>&#xA;
<p>Got it working with following changes answered here <a href="https://stackoverflow.com/questions/16821101/how-to-set-up-es-cluster">How to set up ES cluster?</a>:</p>&#xA;&#xA;<p>Node 1:</p>&#xA;&#xA;<pre><code>cluster.name: mycluster&#xA;node.name: "node1"&#xA;node.master: true&#xA;node.data: true&#xA;discovery.zen.ping.multicast.enabled: false&#xA;discovery.zen.ping.unicast.hosts: ["node1.example.com"]&#xA;</code></pre>&#xA;&#xA;<p>Node 2:</p>&#xA;&#xA;<pre><code>cluster.name: mycluster&#xA;node.name: "node2"&#xA;node.master: false&#xA;node.data: true&#xA;discovery.zen.ping.multicast.enabled: false&#xA;discovery.zen.ping.unicast.hosts: ["node1.example.com"]&#xA;</code></pre>&#xA;
<p>If you are trying to connect additional node to already existed ES cluster, make sure that this node also have all the same ES plugins as another nodes. If not - node cant be fully connected (other nodes can show it as connected but http-commands cant be launched on it) to ES cluster with error like:</p>&#xA;&#xA;<pre><code>[2016-07-21 11:56:59,564][DEBUG][action.admin.cluster.health] [dev-marvel1] no known master node, scheduling a retry&#xA;[2016-07-21 11:57:05,313][INFO ][rest.suppressed          ] /_cluster/health Params: {pretty=true}&#xA;MasterNotDiscoveredException[waited for [30s]]&#xA;        at org.elasticsearch.action.support.master.TransportMasterNodeAction$4.onTimeout(TransportMasterNodeAction.java:154)&#xA;        at org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:239)&#xA;        at org.elasticsearch.cluster.service.InternalClusterService$NotifyTimeout.run(InternalClusterService.java:574)&#xA;        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&#xA;        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&#xA;        at java.lang.Thread.run(Thread.java:745)&#xA;</code></pre>&#xA;&#xA;<p>In my case problem was with license plugin. After removing it everything became fine.</p>&#xA;
<p>If you are searching for this because you are working on your local machine then the quickest solution is to free up nodes that are hung by individually killing all the processes. I searched for these processes using.</p>&#xA;&#xA;<pre><code>ps -alx | grep elastic&#xA;kill -9 {pid}&#xA;</code></pre>&#xA;
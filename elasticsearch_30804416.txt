30804416
Elasticsearch error : Root type mapping not empty after parsing! Remaining fields
<p>I am trying to insert a new type 'place' in elasticsearch using its curl API. But it keeps failing.&#xA;The command I'm using is:</p>&#xA;&#xA;<pre><code>curl -XPUT host/my_index/_mapping/place --data&#xA;'{&#xA;    "place": {&#xA;        "_id": {&#xA;            "path": "place_id"&#xA;        },&#xA;        "properties": {&#xA;            "place_id":{&#xA;                "type": "string",&#xA;                "index": "not_analyzed",&#xA;                "store": true&#xA;            },&#xA;            "location": {&#xA;                "type": "geo_point",&#xA;                "store": true&#xA;            },&#xA;            "name": {&#xA;                "type": "string",&#xA;                "store": true&#xA;            },&#xA;            "address": {&#xA;                "type": "string",&#xA;                "store": true&#xA;            },&#xA;            "city": {&#xA;                "type": "string",&#xA;                "store": true&#xA;            },&#xA;            "state": {&#xA;                "type": "string",&#xA;                "store": true&#xA;            },&#xA;            "postal_code": {&#xA;                "type": "string",&#xA;                "store": true&#xA;            },&#xA;            "phone": {&#xA;                "type": "string",&#xA;                "analyzer": "phone_number",&#xA;                "store": true&#xA;            },&#xA;            "update_time": {&#xA;                "format": "dateOptionalTime",&#xA;                "type": "date"&#xA;            }&#xA;        }&#xA;    }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>And I am getting the following error:</p>&#xA;&#xA;<pre><code>{"error":"MapperParsingException[Root type mapping not empty after parsing! Remaining fields:   [place : {_id={path=place_id}, properties={place_id={type=string, index=not_analyzed, store=true}, location={type=geo_point, store=true}, name={type=string, store=true}, address={type=string, store=true}, city={type=string, store=true}, state={type=string, store=true}, postal_code={type=string, store=true}, phone={type=string, analyzer=phone_number, store=true}, update_time={format=dateOptionalTime, type=date}}}]]","status":400}% &#xA;</code></pre>&#xA;&#xA;<p>Nothing looks wrong to me ... What is the problem?</p>&#xA;&#xA;<p>Thanks for the help!</p>&#xA;&#xA;<p><strong>UPDATE</strong>:</p>&#xA;&#xA;<p>This is the current mapping of the index</p>&#xA;&#xA;<pre><code>{&#xA;  index: {&#xA;    mappings: {&#xA;      image: {&#xA;        _id: {&#xA;          path: "image_id"&#xA;        },&#xA;        properties: {&#xA;          caption: {&#xA;            type: "string"&#xA;          },&#xA;          comments: {&#xA;            properties: {&#xA;              count: {&#xA;                type: "integer"&#xA;              }&#xA;            }&#xA;          },&#xA;          creation_time: {&#xA;            type: "date",&#xA;            format: "dateOptionalTime"&#xA;          },&#xA;          is_tag_search: {&#xA;            type: "boolean"&#xA;          },&#xA;          image_id: {&#xA;            type: "string",&#xA;            index: "not_analyzed"&#xA;          },&#xA;          likes: {&#xA;            properties: {&#xA;              count: {&#xA;                type: "integer"&#xA;              }&#xA;            }&#xA;          },&#xA;          location: {&#xA;            type: "geo_point",&#xA;            lat_lon: true&#xA;          },&#xA;          logos: {&#xA;            type: "string"&#xA;          },&#xA;          social_score: {&#xA;            type: "float"&#xA;          },&#xA;          source: {&#xA;            type: "string",&#xA;            analyzer: "keyword_lowercase"&#xA;          },&#xA;          tags: {&#xA;            type: "string",&#xA;            analyzer: "tags",&#xA;            fields: {&#xA;              raw: {&#xA;                type: "string",&#xA;                index: "not_analyzed"&#xA;              }&#xA;            }&#xA;          },&#xA;          url: {&#xA;            type: "string",&#xA;            index: "no"&#xA;          }&#xA;        }&#xA;      },&#xA;      tag: {&#xA;        _id: {&#xA;        path: "tag_id"&#xA;      },&#xA;      properties: {&#xA;        name: {&#xA;          type: "string"&#xA;        },&#xA;        suggest: {&#xA;          type: "completion",&#xA;          analyzer: "simple",&#xA;          payloads: true,&#xA;          preserve_separators: true,&#xA;          preserve_position_increments: true,&#xA;          max_input_length: 50&#xA;        },&#xA;        tag_id: {&#xA;          type: "string"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
<p>It might be as simple as removing the newline character you have between the first and the second line:</p>&#xA;&#xA;<p>From this:</p>&#xA;&#xA;<pre><code>curl -XPUT host/my_index/_mapping/place --data&#xA;'{&#xA;</code></pre>&#xA;&#xA;<p>To this:</p>&#xA;&#xA;<pre><code>curl -XPUT host/my_index/_mapping/place --data '{&#xA;</code></pre>&#xA;&#xA;<p>I copy/pasted your exact command above and it failed for me. Then I removed the newline and it worked.</p>&#xA;
34597147
Elasticsearch filter when term mix letters and numbers
<p>I'm doing the following query to search some itens:</p>&#xA;&#xA;<pre><code>{&#xA;  "filtered" : {&#xA;    "query" : {&#xA;      "match" : {&#xA;        "name_db" : {&#xA;          "query" : "Human",&#xA;          "type" : "boolean"&#xA;        }&#xA;      }&#xA;    },&#xA;    "filter" : {&#xA;      "terms" : {&#xA;        "cat" : [ "B8E" ],&#xA;        "execution" : "bool"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>See that "cat" field? When it's something like "B8E" there are no results (even though it should), while when it's something like "320" the results are correct. What could be wrong? Why mixing letters and number would be a problem?</p>&#xA;&#xA;<p>Thanks in advance.</p>&#xA;&#xA;<p>PS: I'm new to elasticsearch</p>&#xA;
<p>I'm pretty sure your field <code>cat</code> is an <code>analyzed</code> string and hence is being indexed in lowercase (and that makes no difference for numbers). If you try this query instead you'll get results.</p>&#xA;&#xA;<pre><code>{&#xA;  "filtered" : {&#xA;    "query" : {&#xA;      "match" : {&#xA;        "name_db" : {&#xA;          "query" : "Human",&#xA;          "type" : "boolean"&#xA;        }&#xA;      }&#xA;    },&#xA;    "filter" : {&#xA;      "terms" : {&#xA;        "cat" : [ "b8e" ],         &lt;--- search in lowercase&#xA;        "execution" : "bool"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p><strong>UPDATE</strong></p>&#xA;&#xA;<p>If you want to index the <code>cat</code> field in uppercase so that you can search it using uppercase (e.g. <code>"B8E"</code>), you need to change its mapping to being <code>not_analyzed</code>, like this:</p>&#xA;&#xA;<pre><code>"cat": {&#xA;    "type": "string",&#xA;    "index": "not_analyzed"&#xA;}&#xA;</code></pre>&#xA;
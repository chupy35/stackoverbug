30154190
How to search pattern with colon in elasticsearch?
<p>I have a field in Elasticsearch with the value <code>"ft:05/08/2015 13:01:27.358,cgn:4189"</code> .&#xA;When I want to search with query string "cgn:4189" i have no result .&#xA;I try to escape the colon like "cgn:4189" but i have a syntax error .&#xA;I don't know how to do this .</p>&#xA;&#xA;<pre><code>{"query":{"bool":{"must":[{"query_string":{"default_field":"fluentd.message","query":"cgn:"}}],"must_not":[],"should":[]}},"from":0,"size":10,"sort":[],"facets":{}}&#xA;</code></pre>&#xA;&#xA;<p>Results :</p>&#xA;&#xA;<pre><code>"error": "SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures&#xA;</code></pre>&#xA;&#xA;<p>And</p>&#xA;&#xA;<pre><code>{"query":{"bool":{"must":[{"query_string":{"default_field":"fluentd.message","query":"cgn\:"}}],"must_not":[],"should":[]}},"from":0,"size":10,"sort":[],"facets":{}}&#xA;</code></pre>&#xA;&#xA;<p>Results :</p>&#xA;&#xA;<pre><code>JSON.parse: bad escaped character at line 1 column 91 of the JSON data&#xA;</code></pre>&#xA;&#xA;<p>Can you help me please?</p>&#xA;
<p>Try this query and see if it works for you:</p>&#xA;&#xA;<pre><code>{&#xA;   "query": {&#xA;      "bool": {&#xA;         "must": [&#xA;            {&#xA;               "query_string": {&#xA;                  "default_field": "fluentd.message",&#xA;                  "query": "cgn\\:4189"&#xA;               }&#xA;            }&#xA;         ],&#xA;         "must_not": [],&#xA;         "should": []&#xA;      }&#xA;   },&#xA;   "from": 0,&#xA;   "size": 10,&#xA;   "sort": [],&#xA;   "facets": {}&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is some Sense code I used to test it:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/1c90964da37d3dfec47d76288885db5793f38415" rel="noreferrer">http://sense.qbox.io/gist/1c90964da37d3dfec47d76288885db5793f38415</a></p>&#xA;&#xA;<p>If that doesn't work for you, then it probably has something to do with your mapping and/or analysis setup. So if you could post your mapping, including any custom analyzers, in your question it will help. Also, properly formatting your code blocks would make them much easier to read.</p>&#xA;
<p>Referring to <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.2/ip.html#_querying_literal_ip_literal_fields" rel="nofollow noreferrer">elastic search documentation</a> you can just add escaped double quotes to the query as such:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "query_string" : {&#xA;      "query": "ip_addr:\"2001:db8::/48\""&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
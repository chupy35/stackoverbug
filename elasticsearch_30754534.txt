30754534
elasticsearch -check if array contains a value
<p>I want to check on an field of an array long type that includes some values.&#xA;the only way I found is using script: <a href="https://stackoverflow.com/questions/22566079/elasticsearch-scripting-check-if-array-contains-a-value">ElasticSearch Scripting: check if array contains a value</a></p>&#xA;&#xA;<p>but it still not working fore me:&#xA;Query:</p>&#xA;&#xA;<pre><code>  {&#xA;    "query": {&#xA;        "filtered": {&#xA;            "query": {&#xA;                "match_all": {}&#xA;            },&#xA;            "filter": {&#xA;                "script": {&#xA;                    "script": "doc['Commodity'].values.contains(param1)",&#xA;                    "params": {&#xA;                        "param1": 50&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>but I get 0 hits. while I have the records:</p>&#xA;&#xA;<pre><code>{&#xA;"_index" : "aaa",&#xA;"_type" : "logs",&#xA;"_id" : "2zzlXEOgRtujWiCGtX6s9Q",&#xA;"_score" : 1,&#xA;"_source" : {&#xA;&#xA;   "Commodity" : [&#xA;     50&#xA;    ],&#xA;   "Type" : 1,&#xA;    "SourceId" : "fsd",&#xA;      "Id" : 123&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
<p>Try this instead of that script:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "terms": {&#xA;          "Commodity": [&#xA;            55,&#xA;            150&#xA;          ],&#xA;          "execution": "and"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
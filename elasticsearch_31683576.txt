31683576
Why is elasticsearch trying to parse a timestamp found in a field consisting of (and mapped as) strings to a date, and how do I stop it?
<p>How do you prevent Elasticsearch from attempting to parse dates it finds in string fields? </p>&#xA;&#xA;<p>I have a simple json document like this: </p>&#xA;&#xA;<pre><code>{&#xA;  key: val, &#xA;  key2: val, &#xA;  text_blob: ["hello", "world", "something else", "2015-01-01T00:00:00+1", "sentence"]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The timestamp's existence in the <code>text_blob</code> field is totally arbitrary. It was just present in the data and doesn't really mean anything. However, because it's there, Elastic seemingly thinks it's special and tries to map it to <code>dateOptionalTime</code>. I want it to just keep on being a plain ol' string! </p>&#xA;&#xA;<p>I tried explicitly declaring a mapping on that field before loading in my data. </p>&#xA;&#xA;<pre><code>POST myindex &#xA;&#xA;{&#xA;  "mappings": {&#xA;    "mytype": {&#xA;      "_source": {"enabled": true}, &#xA;      "properties": {&#xA;        "text_blob": {"type": "String"}        &#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>But it seems to have no effect. As soon as Elastic finds that datestring among the other strings it tries to apply a new mapping and explodes with:</p>&#xA;&#xA;<pre><code>MapperParsingException[failed to parse [text_blob]]; nested: MapperParsingException[failed to parse date field [None], tried both date format [dateOptionalTime], and timestamp number with locale []];&#xA;</code></pre>&#xA;&#xA;<p>But this error is really somewhat of a red herring in my opinion. It's exploding because it can't parse the timestamp string that contains an offset. However, the core issue is <em>why</em> it's trying to parse it as a date <em>at all</em>. </p>&#xA;
<p>Change your mapping to this</p>&#xA;&#xA;<pre><code>POST myindex &#xA;&#xA;{&#xA;  "mappings": {&#xA;    "mytype": {&#xA;      "_source": {"enabled": true}, &#xA;      "properties": {&#xA;        "text_blob": {&#xA;            "type": "String"&#xA;            "index":"not_analyzed"&#xA;        }        &#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>This will stop elasticsearch from analyzing the field in any way whatsoever. String fields by default are analyzed.</p>&#xA;
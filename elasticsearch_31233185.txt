31233185
How to check for true condition in elasticsearch scripting?
<p>I have documents with a boolean field&#xA;Say </p>&#xA;&#xA;<pre><code> {&#xA;    "field1" : true&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Now I want to check, whether the "field1" is true or not, and run a query if it is true.&#xA;How can I do that using scripts in Elasticsearch?</p>&#xA;
<p>It sounds like you wish to use a filtered query, to query only on documents where field1 is true.</p>&#xA;&#xA;<p>If you create a filtered query, you apply a filter <strong>before</strong> you run a query, so you will be querying only those documents that pass your filter, you can setup a filtered query as below.</p>&#xA;&#xA;<pre><code>{&#xA;  "query":{&#xA;    "filtered":{&#xA;      "query":{&#xA;        //Your query&#xA;      },&#xA;      "filter":{&#xA;        "term":{"field1":true}&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
<p>Daniel's approach is superior to literally using scripts because it will be significantly faster, but if you had a need to do it within a script, then you need to check if the value <em>indexed</em> is <code>'T'</code> or <code>'F'</code> in Elasticsearch 1.x. In Elasticsearch 2.x and above, Lucene changed to using the more traditional <code>1</code> and <code>0</code>.</p>&#xA;&#xA;<p>ES 2.x (and above):</p>&#xA;&#xA;<pre><code>{&#xA;  "query" : {&#xA;    "bool" : {&#xA;      "filter" : [ {&#xA;        "script" : {&#xA;          "inline" : "doc['field1'].value == 1"&#xA;        }&#xA;      } ]&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>ES 1.x:</p>&#xA;&#xA;<pre><code>{&#xA;  "query" : {&#xA;    "filtered" : {&#xA;      "filter" : {&#xA;        "script" : {&#xA;          "script" : "doc['field1'].value == 'T'"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>It's a bad idea to ever use a script unless you are required to do something that cannot be done without one, such as compare to fields simultaneously to ensure that they have the same value.</p>&#xA;
<p>You should use a <code>bool</code> query to match a boolean condition as you want. Look at my example.  </p>&#xA;&#xA;<pre><code>{&#xA;   "query" : {&#xA;      "bool" : {&#xA;         "must" : &#xA;            {&#xA;            "term" : {&#xA;               "field1" : true&#xA;            }&#xA;         }            &#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Hope it helps!</p>&#xA;
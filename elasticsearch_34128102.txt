34128102
Highlight not working along with term lookup filter
<p>I'm new to elastic search and have started exploring it from the past few days. My requirement is to get the matched keywords highlighted.</p>&#xA;&#xA;<p>So I have 2 indices</p>&#xA;&#xA;<pre><code>http://localhost:9200/lookup/type/1?pretty&#xA;Output&#xA;{&#xA;"_index" : "lookup",&#xA;"_type" : "type",&#xA;"_id" : "1",&#xA;"_version" : 1,&#xA;"found" : true,&#xA;"_source":{"terms":["Apache&#xA;Storm","Kafka","MR","Pig","Hive","Hadoop","Mahout"]}&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And another one as following:-</p>&#xA;&#xA;<pre><code>http://localhost:9200/skillsetanalyzer/resume/_search?fields=keySkills&#xA;output&#xA;{"took":19,"timed_out":false,"_shards":{"total":5,"successful":5,"failed":0},"hits":{"total":3,"max_score":1.0,"hits":[{"_index":"skillsetanalyzer","_type":"resume","_id":"1","_score":1.0,"fields":{"keySkills":["Core&#xA;Java","J2EE","Struts 1.x","SOAP based&#xA;Web Services using JAX-WS","Maven","Ant","JMS","Apache&#xA;Storm","Kafka","RDBMS&#xA;(MySQL","Tomcat","Weblogic","Eclipse","Toad","TIBCO&#xA;product Suite (Administrator","Business&#xA;Work","Designer","EMS)","CVS","SVN"]}},&#xA;</code></pre>&#xA;&#xA;<p>And below query returns the correct results but does not highlight the matched keywords.</p>&#xA;&#xA;<pre><code>curl -XGET 'localhost:9200/skillsetanalyzer/resume/_search?pretty' -d '&#xA;{&#xA;&#xA;"query":&#xA;{"filtered":&#xA;       {"filter":&#xA;         {"terms":&#xA;            {"keySkills":&#xA;                {"index":"lookup",&#xA;                  "type":"type",&#xA;                   "id":"1",&#xA;                  "path":"terms"&#xA;                },&#xA;            "_cache_key":"1"&#xA;        }&#xA;      }&#xA;   }&#xA;},&#xA;"highlight": {&#xA;         "fields":{&#xA;              "keySkills":{}&#xA;              }&#xA;    }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>Field "KeySkills" is not analyzed and its type is String. I'm not able to make out what is wrong with the&#xA;query.&#xA;Please help in providing the necessary pointers.</p>&#xA;&#xA;<p>~Shweta</p>&#xA;
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-highlighting.html" rel="nofollow">Highlighting</a> works against the <strong>Query</strong>, you are just <strong>filtering</strong> the results. You need to specify <code>highlight_query</code> along with your filters like this </p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "terms": {&#xA;          "keySkills": [&#xA;            "MR","Pig","Hive"&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  },&#xA;  "highlight": {&#xA;    "fields": {&#xA;      "keySkills": {&#xA;        "highlight_query": {&#xA;          "terms": {&#xA;            "keySkills": [&#xA;              "MR","Pig","Hive"&#xA;            ]&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I hope this helps.</p>&#xA;
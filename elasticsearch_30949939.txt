30949939
How to filter results based on frequency of repeating terms in an array in elasticsearch
<p>I have an array field with a lot of keywords and i need to sort the documents on the basis on how many times a particular keyword repetation in those arrays. &#xA;For eg,if my field name is "nationality" and for document 1, it consists of the following&#xA;doc1 &#xA;nationality : </p>&#xA;&#xA;<pre><code>["US","UK","Australia","India","US","US"]&#xA;</code></pre>&#xA;&#xA;<p>and for doc2&#xA;nationality: </p>&#xA;&#xA;<pre><code>["US","UK","US","US","US","China"]&#xA;</code></pre>&#xA;&#xA;<p>I want only those documents to be shown where the term "US" occurs more than 3 times. That would make only doc2 to be shown. How to do this?</p>&#xA;
<p>You can use scripting for this to be implemented. </p>&#xA;&#xA;<pre><code>{&#xA;      "query": {&#xA;        "filtered": {&#xA;          "filter": {&#xA;            "script": {&#xA;              "script": "_index['nationality']['US'].tf() &gt; 3"&#xA;            }&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>Here in this scripy the array "nationality" is checked for the term "US" and the count is taken by tf (term frequency). Now only the documents with term frequency greater than three are shown in the results. You can learn more about the filter operations <a href="http://blog.qbox.io/elasticsearch-scripting-filtering" rel="nofollow">here</a></p>&#xA;
32494095
All the data suddenly removed from the Elasticsearch cluster
<p>Our Elasticsearch cluster consists of 8 nodes (1 master and 7 data). </p>&#xA;&#xA;<p>It was having 6 indexes with average of 2.5 million documents indexed per day. The cluster was configured to have 7 shards per index and 1 replica for each. </p>&#xA;&#xA;<p>Suddenly the cluster was not respond to any query. Checking the cluster health, there was about 27 pending tasks and the number increases gradually. </p>&#xA;&#xA;<p>As there is no one experienced in ES, the sys admin suggested to restart the service on the master node. </p>&#xA;&#xA;<p>This action leads to something very weird. </p>&#xA;&#xA;<p>All the data in the cluster suddenly removed. We did not find any data in any index. The only thing we can think in is that the shards are destroyed  after the restart of the master node but this is not something easy either to happen or to discover. </p>&#xA;&#xA;<p>Checking the logs of the master node, we found a lot of warnings about failure in creating shards </p>&#xA;&#xA;<blockquote>&#xA;  <p>[2015-09-09 09:00:19,579][WARN ][cluster.action.shard     ]&#xA;  [elastic-node01.css.org] [isis][6] received shard failed for&#xA;  [isis][6], node[R2rPmGpcTsKGO0q9UPuvIQ], [P], s[INITIALIZING],&#xA;  indexUUID [4kSRZcYeRFK8pgknhmd-Fg], reason [shard failure [failed to&#xA;  create shard][IndexShardCreationException[[isis][6] failed to create&#xA;  shard]; nested: LockObtainFailedException[Can't lock shard [isis][6],&#xA;  timed out after 5000ms]; ]]</p>&#xA;</blockquote>&#xA;&#xA;<p>Question 1: Is there any scenario (like ours) that may cause the data in the cluster to be removed like what happened with us?</p>&#xA;&#xA;<p>Question 2: We have the logs of the 8 machines, what should we look for to investigate in this issue? </p>&#xA;
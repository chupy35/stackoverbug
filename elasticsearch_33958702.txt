33958702
Elasticsearch: filter by any field
<p>I am playing with filters in elasticsearch (we use old version 1.3.1), and I need to filter my search results by any field. With query, this can be done like this:</p>&#xA;&#xA;<pre><code>"query": {&#xA;  "query_string": {&#xA;    "query": "_all:test"&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>But filters seems to not work with <strong>_all</strong> statement. What can I do? Would newer elasticsearch version solve my problem?</p>&#xA;&#xA;<p>Thanks in advance!</p>&#xA;&#xA;<p><strong>PS:</strong> I need to search exact values, so I cannot use queries. There is difference between queries and filters - if you search for <code>my brown</code>, then you can expect results like:</p>&#xA;&#xA;<p><code>my brown</code></p>&#xA;&#xA;<p><code>This is my brown dog.</code></p>&#xA;&#xA;<p><code>someone stolen my brown wallet</code></p>&#xA;&#xA;<p>But filter will return only <code>my brown</code>, and that is what I need.</p>&#xA;
<p>You might want to read up a little on the distinction between <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/_queries_and_filters.html" rel="nofollow">queries and filters</a>. What you're doing there is a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html" rel="nofollow">query string query</a>.</p>&#xA;&#xA;<p>If you do actually want to filter against exact text tokens (read up on <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/analysis-intro.html" rel="nofollow">analysis</a> if you don't know what I mean by "tokens"), AND you have your mapping set up such that the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-all-field.html" rel="nofollow"><code>"_all"</code> field</a> behaves as you're expecting then try something like this:</p>&#xA;&#xA;<pre><code>POST /test_index/_search&#xA;{&#xA;   "query": {&#xA;      "filtered": {&#xA;         "filter": {&#xA;            "term": {&#xA;               "_all": "test"&#xA;            }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>If, on the other hand, you want to allow some analysis (so that <code>"Test"</code> is tokenized to <code>"test"</code>, for example), you may want this instead:</p>&#xA;&#xA;<pre><code>POST /test_index/_search&#xA;{&#xA;   "query": {&#xA;      "match": {&#xA;         "_all": "Test"&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is some code I used to play around with it:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/44adf2c2ade8abd6758f0e08ed2e40434850fc1c" rel="nofollow">http://sense.qbox.io/gist/44adf2c2ade8abd6758f0e08ed2e40434850fc1c</a></p>&#xA;
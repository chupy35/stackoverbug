29012918
elasticsearch 1.4.4 error using script filter with script_file
<p>Using Elasticsearch 1.4.4, I have this script -</p>&#xA;&#xA;<pre><code>doc[field].date.getMinuteOfDay() &gt;= gte &amp;&amp; doc[field].date.getMinuteOfDay() &lt;= lte&#xA;</code></pre>&#xA;&#xA;<p>Stored here - <strong>config/script/minuteOfDayRange.groovy</strong></p>&#xA;&#xA;<p>I run this query:</p>&#xA;&#xA;<pre><code>POST test_index/_search&#xA;{&#xA;  "filter": {&#xA;    "script": {&#xA;      "script_file": "minuteOfDayRange",&#xA;      "params": {&#xA;        "field": "start_time",&#xA;        "gte": 0,&#xA;        "lte": 1439&#xA;      }&#xA;    }&#xA;  },&#xA;  "size": 0&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>and get an error.  Here is part of the error (it's really big so I tried to show only the parts that looked the most helpful):</p>&#xA;&#xA;<p><strong>"error": "SearchPhaseExecutionException[Failed to execute phase [query], all shards failed;......nested: QueryParsingException[[test_index] [script] filter does not support [script_file]];......</strong></p>&#xA;&#xA;<p>It sounds like this part of the error with <strong>[script] filter does not support [script_file]</strong> is saying script filters don't work with <strong>script_file</strong>.  Is that correct?  I've used <strong>script_file</strong> to generate terms with success on this same index.  Previous to updating to 1.4.4 this same filter worked using dynamic scripts, but I am now using the <strong>script_file</strong> method since updating to 1.4.4.  Is it possible for me to use a script filter in a file, and if so, how?</p>&#xA;
<p>It worked by changing <strong>script_file</strong> to just <strong>script</strong> in the query.</p>&#xA;&#xA;<p>I found a similar issue on github that was a clue to try this: <a href="https://github.com/elastic/elasticsearch/issues/10007" rel="nofollow">https://github.com/elastic/elasticsearch/issues/10007</a></p>&#xA;
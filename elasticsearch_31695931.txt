31695931
How can I sort the result of Elasticsearch suggest?
<p>I am using the Elasticsearch suggest function.&#xA;And I want to sort the result.</p>&#xA;&#xA;<p>For instance, I want to index like these datas to the Elasticsearch.  </p>&#xA;&#xA;<pre><code>| itemname  | total_pv  |&#xA;| Apple     | 100       |&#xA;| Lemon     | 200       |&#xA;| Orange    | 50        |&#xA;| Banana    | 120       |&#xA;| Lime      | 100       |&#xA;</code></pre>&#xA;&#xA;<p>When users input "L" in the input tags, I want to sort the result as "total_pv".&#xA;In this case, the order "Lemon", "Lime" is what I want.</p>&#xA;&#xA;<p>It is also same meaning if I write it as SQL.</p>&#xA;&#xA;<pre><code>SELECT itemname FROM sometable WHERE itemname LIKE 'L%' ORDER BY total_pv DESC&#xA;</code></pre>&#xA;&#xA;<p>I have tried to index below request, but I could not get correct answer when I request to the Elasticsearch with word of "L".</p>&#xA;&#xA;<pre><code>{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "8120" } }&#xA;{ "suggest" : "Apple", "weight" : "100"}&#xA;{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "8020" } }&#xA;{ "suggest" : "Lemon", "weight" : "200"}&#xA;{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "8021" } }&#xA;{ "suggest" : "Orange", "weight" : "50"}&#xA;{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "8110" } }&#xA;{ "suggest" : "Banana", "weight" : "120"}&#xA;{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "4080" } }&#xA;{ "suggest" : "Lime", "weight" : "100"}&#xA;</code></pre>&#xA;&#xA;<p>The indexing setting is like this.  </p>&#xA;&#xA;<pre><code>{&#xA;  "settings": {&#xA;    "analysis": {&#xA;      "filter": {&#xA;        "katakana_stemmer": {&#xA;          "type": "kuromoji_stemmer"&#xA;        },&#xA;        "katakana_readingform" : {&#xA;          "type" : "kuromoji_readingform",&#xA;          "use_romaji" : false&#xA;        }&#xA;      },&#xA;      "tokenizer": {&#xA;        "kuromoji_tokenizer": {&#xA;          "type": "kuromoji_tokenizer",&#xA;          "mode":"search",&#xA;          "user_dictionary": "user_dict.txt"&#xA;        }&#xA;      },&#xA;      "analyzer": {&#xA;        "kuromoji_analyzer": {&#xA;          "type":"custom",&#xA;          "tokenizer":"kuromoji_tokenizer",&#xA;          "char_filter":["html_strip", "kuromoji_iteration_mark",    "icu_normalizer"],&#xA;          "filter": ["lowercase", "cjk_width", "katakana_stemmer", "kuromoji_part_of_speech", "kuromoji_baseform", "katakana_readingform"]&#xA;        }&#xA;      }&#xA;    }&#xA;  },&#xA;  "mappings": {&#xA;    "keyword": {&#xA;      "properties": {&#xA;        "suggest": {&#xA;          "type": "completion",&#xA;          "index_analyzer": "kuromoji_analyzer",&#xA;          "search_analyzer": "kuromoji_analyzer"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And then the search query is like this.  </p>&#xA;&#xA;<pre><code>{&#xA;  "index": "ss_suggest",&#xA;  "body": {&#xA;    "keyword": {&#xA;      "text": "L",&#xA;      "completion": {&#xA;        "field": "suggest"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Could anyone tell me how can I do it ?<br>&#xA;Thanks.  </p>&#xA;
<p>I got the answer. &#xA;The format should be like this. </p>&#xA;&#xA;<pre><code>{ "index" : { "_index" : "ss_suggest", "_type" : "keyword", "_id" : "8120" } }    &#xA;{ "suggest" : { "input" : "Apple", "weight" : "100" } }&#xA;</code></pre>&#xA;
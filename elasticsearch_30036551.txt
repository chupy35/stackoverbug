30036551
How many master in three node cluster
<p>I was stumbled at this question that how many masters can be there in a three node cluster. I came across this point in one of a article on internet that search and index requests are not to be sent to elected master. Is that correct? So , if i have three nodes acting as master(out of which one node is elected master) should i point out incoming logs to be indexed and searched onto other master nodes apart from elected master?Please clarify.Thanks in advance</p>&#xA;
<p>In a three node cluster, all nodes most likely hold data and are master-eligible. That is the most simple situation in which you don't have to worry about anything else.</p>&#xA;&#xA;<p>If you have a larger cluster, you can have a couple of nodes which are configured as dedicated master nodes. That is, they are master-eligible and they don't hold any data. For example you would have 3 dedicated master nodes and 7 data nodes (not master-eligible). Exactly one of the dedicated master nodes will always be the elected master. </p>&#xA;&#xA;<p>The point is that since the dedicated master nodes don't hold data, they will not directly service index and search request. If you send an index or search request to them there's no other way for them than to delegate to one of the 7 data nodes.</p>&#xA;&#xA;<p>From the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.5/modules-node.html" rel="noreferrer">Elasticsearch Reference for Modules - Node</a>:</p>&#xA;&#xA;<blockquote>&#xA;  <p><strong>dedicated master</strong> nodes are nodes with the settings node.data: false&#xA;  and node.master: true. We actively promote the use of dedicated master&#xA;  nodes in critical clusters to make sure that there are 3 dedicated&#xA;  nodes whose only role is to be master, a lightweight operational&#xA;  (cluster management) responsibility. By reducing the amount of&#xA;  resource intensive work that these nodes do (in other words, do not&#xA;  send index or search requests to these dedicated master nodes), we&#xA;  greatly reduce the chance of cluster instability.</p>&#xA;</blockquote>&#xA;&#xA;<p>A related question is how many master nodes there should be in a cluster. The answer essentially is at least 3 in order to prevent split-brain (a situation when due to a network error, two masters are elected simultaneously). </p>&#xA;&#xA;<p>The <a href="http://www.elastic.co/guide/en/elasticsearch/guide/master/_important_configuration_changes.html#_minimum_master_nodes" rel="noreferrer">Elasticsearch Guide has a section on Minimum Master Nodes</a>, an excerpt:</p>&#xA;&#xA;<blockquote>&#xA;  <p>When you have a split brain, your cluster is at danger of losing data.&#xA;  Because the master is considered the supreme ruler of the cluster, it&#xA;  decides when new indices can be created, how shards are moved, and so&#xA;  forth. If you have two masters, data integrity becomes perilous, since&#xA;  you have two nodes that think they are in charge.</p>&#xA;  &#xA;  <p>This setting tells Elasticsearch to not elect a master unless there&#xA;  are enough master-eligible nodes available. Only then will an election&#xA;  take place.</p>&#xA;  &#xA;  <p>This setting should always be configured to a quorum (majority) of&#xA;  your master-eligible nodes. A quorum is (number of master-eligible&#xA;  nodes / 2) + 1. Here are some examples:</p>&#xA;  &#xA;  <ul>&#xA;  <li>If you have ten regular nodes (can hold data, can become master), a&#xA;  quorum is 6. </li>&#xA;  <li>If you have three dedicated master nodes and a hundred data nodes, the quorum is 2, since you need to count only nodes that are master eligible. &#xA;  <ul>&#xA;  <li>If you have two regular nodes, you are in a conundrum. A quorum would be 2, but this means a loss of one node will&#xA;  make your cluster inoperable. A setting of 1 will allow your cluster&#xA;  to function, but doesnâ€™t protect against split brain. It is best to&#xA;  have a minimum of three nodes in situations like this.</li>&#xA;  </ul></li>&#xA;  </ul>&#xA;</blockquote>&#xA;
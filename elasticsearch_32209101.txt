32209101
In ElasticSearch, how to combine a `span_near` and a `term`?
<p>The following query returns hits:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "span_near": {&#xA;      "clauses": [&#xA;        {&#xA;          "span_term": {&#xA;            "file.contents": "charstreams"&#xA;          }&#xA;        }&#xA;      ],&#xA;      "slop": 0,&#xA;      "in_order": true&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>So does the following:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "term": {&#xA;          "file.extension": "java"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>What's the query that combines the two such that both conditions are satisfied?</p>&#xA;
<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "query": {&#xA;        "span_near": {&#xA;          "clauses": [&#xA;            {&#xA;              "span_term": {&#xA;                "file.contents": "charstreams"&#xA;              }&#xA;            }&#xA;          ],&#xA;          "slop": 0,&#xA;          "in_order": true&#xA;        }&#xA;      },&#xA;      "filter": {&#xA;        "term": {&#xA;          "file.extension": "java"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Also, since you're setting <code>slop</code> to <code>0</code> and <code>in_order</code> to <code>true</code>, you might want to consider using <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/phrase-matching.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/guide/current/phrase-matching.html</a> instead.</p>&#xA;
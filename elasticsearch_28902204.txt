28902204
What exactly is lost when _source is disabled?
<p>What is the exact consequences of disabling the <code>_source</code> field in an Elasticsearch mapping?</p>&#xA;&#xA;<p>The surprisingly brief <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping-source-field.html" rel="nofollow" title="documentation">documentation</a> on the <code>_source</code> field itself merely states that</p>&#xA;&#xA;<blockquote>&#xA;  <p>Though very handy to have around, the source field does incur storage overhead within the index. For this reason, it can be disabled.</p>&#xA;</blockquote>&#xA;&#xA;<p>What exactly becomes «less handy» when it is disabled is not explained.  Let's follow the link to the <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-get.html" rel="nofollow" title="get api">get api</a>:</p>&#xA;&#xA;<blockquote>&#xA;  <p>By default, the get operation returns the contents of the _source field unless you have used the fields parameter or if the _source field is disabled.</p>&#xA;</blockquote>&#xA;&#xA;<p>Again, how is doing get different when <code>_source</code> is disabled?  Will the documents themselves be unavailable at all (only aggregates are left)?  Does the system fall back to some costly process of reassembling the document from individual fields?</p>&#xA;&#xA;<p>This is so puzzling.  Many documents across the web devoted to optimizing Elasticsearch performance suggest disabling <code>_source</code> «if you don't need it».  How do I even know it I need it?</p>&#xA;
<p>The Elasticsearch documentation does have a section that comments on the benefits and functionality afforded by retaining <code>_source</code> <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/root-object.html#source-field" rel="nofollow">here</a>.  The two benefits that have been most impactful for me (which are enumerated in the linked documentation) are these:</p>&#xA;&#xA;<blockquote>&#xA;  <p>Partial update requests will not function without the _source field.</p>&#xA;  &#xA;  <p>When your mapping changes and you need to reindex your data, you can do so directly from Elasticsearch instead of having to retrieve all of your documents from another (usually slower) data store.</p>&#xA;</blockquote>&#xA;&#xA;<p>There are of course all of the other points that are discussed in the documentation, but if your use case requires support of incremental document-level updates, then you will almost certainly need to have <code>_source</code> enabled.</p>&#xA;&#xA;<p>If you have a significant volume of data and find that your mappings tend to be quite volatile and change frequently, you will almost certainly want to have <code>_source</code> enabled to mitigate the cost of reindexing.  One of my current projects is in the initial prototyping/development phase, so this benefit is definitely applicable.</p>&#xA;
<p>You <em>search</em> Elasticsearch based on what has been indexed.  Data is <em>returned</em> by what is stored.  By default, <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping-core-types.html" rel="nofollow">fields are not stored</a>.  To view them, they need to be re-parsed out of _source.</p>&#xA;&#xA;<p>So, you can disable _source, but make sure you're storing the fields you need to view.</p>&#xA;&#xA;<p>More tradeoffs are given <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/root-object.html" rel="nofollow">here</a>.</p>&#xA;
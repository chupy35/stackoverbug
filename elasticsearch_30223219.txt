30223219
How to get stats of search operations groups in elasticsearch?
<p>In elasticsearch 1.1.1, I'm trying to get stats gathered by search operations groups.</p>&#xA;&#xA;<p>In <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.x/indices-stats.html" rel="nofollow">documentation</a>, it's said you can set a custom group at search time for your search operation, and you can then get stats from these groups using the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.x/indices-stats.html" rel="nofollow">stats API</a>.</p>&#xA;&#xA;<p>Here what I'm doing on an existing myIndex index:</p>&#xA;&#xA;<pre><code>&gt; curl -XGET http://host:9200/myIndex/myType/_search -d '{&#xA;    "size":1,"query":{"match_all":{}},"stats":["group1","group2"]}'&#xA;{&#xA;   "_shards": {&#xA;        "failed": 0,&#xA;        "successful": 5,&#xA;        "total": 5&#xA;    },&#xA;    "hits": {&#xA;        "hits": [&#xA;            {[...]}&#xA;        ],&#xA;        "max_score": 1.0,&#xA;        "total": 52&#xA;    },&#xA;    "timed_out": false,&#xA;    "took": 1&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>After some time I'm getting stats:</p>&#xA;&#xA;<pre><code>&gt; curl -XGET http://host:9200/myIndex/_stats/search?groups=group1,group2&#xA;{&#xA;    "_all": {&#xA;        "primaries": {&#xA;            "search": {&#xA;                "fetch_current": 0,&#xA;                "fetch_time_in_millis": 5676,&#xA;                "fetch_total": 2468,&#xA;                "open_contexts": 0,&#xA;                "query_current": 0,&#xA;                "query_time_in_millis": 31166,&#xA;                "query_total": 4530&#xA;            }&#xA;        },&#xA;        "total": {&#xA;            "search": {&#xA;                "fetch_current": 0,&#xA;                "fetch_time_in_millis": 5676,&#xA;                "fetch_total": 2468,&#xA;                "open_contexts": 0,&#xA;                "query_current": 0,&#xA;                "query_time_in_millis": 31166,&#xA;                "query_total": 4530&#xA;            }&#xA;        }&#xA;    },&#xA;    "_shards": {&#xA;        "failed": 0,&#xA;        "successful": 5,&#xA;        "total": 10&#xA;    },&#xA;    "indices": {&#xA;        "myIndex": {&#xA;            "primaries": {&#xA;                "search": {&#xA;                    "fetch_current": 0,&#xA;                    "fetch_time_in_millis": 5676,&#xA;                    "fetch_total": 2468,&#xA;                    "open_contexts": 0,&#xA;                    "query_current": 0,&#xA;                    "query_time_in_millis": 31166,&#xA;                    "query_total": 4530&#xA;                }&#xA;            },&#xA;            "total": {&#xA;                "search": {&#xA;                    "fetch_current": 0,&#xA;                    "fetch_time_in_millis": 5676,&#xA;                    "fetch_total": 2468,&#xA;                    "open_contexts": 0,&#xA;                    "query_current": 0,&#xA;                    "query_time_in_millis": 31166,&#xA;                    "query_total": 4530&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I see nowhere any trace of my groups in the stats payload. I get the exact same result without my groups in the requert: <code>curl -XGET http://host:9200/myIndex/_stats/search</code></p>&#xA;&#xA;<p>Do you know how to retrieve the stats of group1 and group2?</p>&#xA;&#xA;<p>My elasticsearch version:</p>&#xA;&#xA;<pre><code>{&#xA;    status: 200,&#xA;    name: "myclustername",&#xA;    version: {&#xA;    number: "1.1.1",&#xA;    build_hash: "f1585f096d3f3985e73456debdc1a0745f512bbc",&#xA;    build_timestamp: "2014-04-16T14:27:12Z",&#xA;    build_snapshot: false,&#xA;    lucene_version: "4.7"&#xA;    },&#xA;    tagline: "You Know, for Search"&#xA;}&#xA;</code></pre>&#xA;
<p>This  is a bug in <a href="https://github.com/elastic/elasticsearch/pull/6390" rel="nofollow">1.1.1</a> which was fixed in<a href="https://www.elastic.co/downloads/past-releases/elasticsearch-1-3-0" rel="nofollow">1.3.0</a> .  </p>&#xA;
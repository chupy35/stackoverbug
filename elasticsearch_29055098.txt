29055098
Elasticsearch: get multiple specified documents in one request?
<p>I am new to Elasticsearch and hope to know whether this is possible.</p>&#xA;&#xA;<p>Basically, I have the values in the "code" property for multiple documents. Each document has a unique value in this property. Now I have the codes of multiple documents and hope to retrieve them in one request by supplying multiple codes.</p>&#xA;&#xA;<p>Is this doable in Elasticsearch?</p>&#xA;&#xA;<p>Regards.</p>&#xA;&#xA;<p><strong>Edit</strong></p>&#xA;&#xA;<p>This is the mapping of the field:</p>&#xA;&#xA;<pre><code>"code" : { "type" : "string", "store": "yes", "index": "not_analyzed"},&#xA;</code></pre>&#xA;&#xA;<p>Two example values of this property:</p>&#xA;&#xA;<pre><code>0Qr7EjzE943Q&#xA;GsPVbMMbVr4s&#xA;</code></pre>&#xA;&#xA;<p>What is the ES syntax to retrieve the two documents in ONE request?</p>&#xA;
<p>First, you probably don't want <code>"store":"yes"</code> in your mapping, unless you have <code>_source</code> disabled (see <a href="https://stackoverflow.com/questions/17103047/why-do-i-need-storeyes-in-elasticsearch">this post</a>).</p>&#xA;&#xA;<p>So, I created a simple index like this:</p>&#xA;&#xA;<pre><code>PUT /test_index&#xA;{&#xA;   "mappings": {&#xA;      "doc": {&#xA;         "properties": {&#xA;            "code": {&#xA;               "type": "string",&#xA;               "index": "not_analyzed"&#xA;            }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>added the two docs with the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html" rel="nofollow noreferrer">bulk API</a>:</p>&#xA;&#xA;<pre><code>POST /test_index/_bulk&#xA;{"index":{"_index":"test_index","_type":"doc","_id":1}}&#xA;{"code":"0Qr7EjzE943Q"}&#xA;{"index":{"_index":"test_index","_type":"doc","_id":2}}&#xA;{"code":"GsPVbMMbVr4s"}&#xA;</code></pre>&#xA;&#xA;<p>There are a number of ways I could retrieve those two documents. The most straightforward, especially since the field isn't analyzed, is probably a with <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-terms-query.html" rel="nofollow noreferrer">terms query</a>:</p>&#xA;&#xA;<pre><code>POST /test_index/_search&#xA;{&#xA;    "query": {&#xA;        "terms": {&#xA;           "code": [&#xA;              "0Qr7EjzE943Q",&#xA;              "GsPVbMMbVr4s"&#xA;           ]&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>both documents are returned:</p>&#xA;&#xA;<pre><code>{&#xA;   "took": 21,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 2,&#xA;      "max_score": 0.04500804,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "1",&#xA;            "_score": 0.04500804,&#xA;            "_source": {&#xA;               "code": "0Qr7EjzE943Q"&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "2",&#xA;            "_score": 0.04500804,&#xA;            "_source": {&#xA;               "code": "GsPVbMMbVr4s"&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is the code I used:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/a3e3e4f05753268086a530b06148c4552bfce324" rel="nofollow noreferrer">http://sense.qbox.io/gist/a3e3e4f05753268086a530b06148c4552bfce324</a></p>&#xA;
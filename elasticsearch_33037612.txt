33037612
Terms aggregation not giving buckets
<p>I'm trying a simple terms aggregation but the result is not creating buckets.  Here is a sample document:</p>&#xA;&#xA;<pre><code>   "hits": {&#xA;      "total": 27330,&#xA;      "max_score": 0.8293952,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "policy",&#xA;            "_type": "policy",&#xA;            "_id": "W0051311PNWO",&#xA;            "_score": 0.8293952,&#xA;            "_source": {&#xA;               "productname": "UK CARGO",&#xA;               "alternateproductname": "ABC39393939",&#xA;               "brokername": "Name***",&#xA;               "agentname": "Name***",&#xA;               "policyref": "ABC33333",&#xA;               "client": "International Cargo Limited",&#xA;               "addressline1": "",&#xA;               "post/zipcode": "",&#xA;               "telephone": null,&#xA;               "bapolicyendorseid": 123334,&#xA;               "prevcertnum": "",&#xA;               "policystatus": "Endorsed",&#xA;               "@version": "1",&#xA;               "@timestamp": "2015-10-09T11:11:02.018Z"&#xA;            }&#xA;         },&#xA;</code></pre>&#xA;&#xA;<p>Here is the aggregate search (in sense):</p>&#xA;&#xA;<pre><code>get policy/policy/_search&#xA;{&#xA;  "aggs": {&#xA;    "statuses": {&#xA;      "terms": {&#xA;        "field": "policystatus"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I'm trying to get the equivalent of:</p>&#xA;&#xA;<pre><code>select policystatus, count(*) from policy group by policystatus&#xA;</code></pre>&#xA;&#xA;<p>The result is not showing buckets.  It is showing regular document results:</p>&#xA;&#xA;<pre><code>{&#xA;   "took": 6,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 227398,&#xA;      "max_score": 1,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "policy",&#xA;            "_type": "policy",&#xA;            "_id": "04/QQQ/04UKI0018",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "productname": "2 RES 01/09/04",&#xA;               "alternateproductname": "2 RES 01/09/04",&#xA;               "brokername": "Blah LTD",&#xA;               "agentname": "Insurance",&#xA;               "policyref": "blah",&#xA;               "client": "blah",&#xA;               "addressline1": "blah",&#xA;               "post/zipcode": "blah",&#xA;               "telephone": null,&#xA;               "bapolicyendorseid": 21427,&#xA;               "prevcertnum": "04UKI0018",&#xA;               "policystatus": "Pending",&#xA;               "@version": "1",&#xA;               "@timestamp": "2015-10-09T11:10:10.146Z"&#xA;            }&#xA;         },&#xA;</code></pre>&#xA;
<p>Try this:</p>&#xA;&#xA;<pre><code>GET /policy/policy/_search?search_type=count&#xA;{&#xA;  "aggs": {&#xA;    "statuses": {&#xA;      "terms": {&#xA;        "field": "policystatus"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>meaning capital letters <code>GET</code> and <code>search_type=count</code> to get only the buckets, not also the <code>hits</code>.</p>&#xA;
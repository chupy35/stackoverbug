28974274
Multi-field, multi-type search in Elasticsearch
<p>I have 2 types <code>Author</code> and <code>Book</code>.  I want to search both types and return matches from the fields <code>Author.name</code> and <code>Book.title</code>.  How would I complete this query?</p>&#xA;&#xA;<p><code>GET /bookstore/author,book/_search</code> ...</p>&#xA;
<p>There are a few approaches based on what you're trying to accomplish.</p>&#xA;&#xA;<ol>&#xA;<li>You could model your data so that you&#xA;store indexed values for the author in the book type, and possibly a&#xA;reference to that author.</li>&#xA;<li>Otherwise you should be able to query 2 types, however you cannot&#xA;specify which value to search for in which type. These would&#xA;technically be 2 separate queries, and you'd have to mix the 2&#xA;results yourself if this is what you desire.</li>&#xA;</ol>&#xA;&#xA;<p>It is possible to search both given that book doesn't have an attribute "name", and author doesn't have an attribute "title". If you search for a field that doesn't exist elasticsearch will still try given that the data in the model is schema-less, and a mapping simply defines how to index fields but doesn't necessarily define the structure of the documents.</p>&#xA;&#xA;<p>If you're trying to make a single search for both book and author then I'd recommend doing 2 separate queries, as you'll get 2 separate types of documents which may need to be treated accordingly.</p>&#xA;
<p>You can make a query to the index, not only the type: /yourindex/_search.</p>&#xA;&#xA;<p>Now, you should use a multi match query to control your results better:</p>&#xA;&#xA;<pre><code>{ &#xA;    "multi_match" : { &#xA;        "query": "Will Smith", "fields": [&#xA;            "type1.title", "type2.name" &#xA;        ]  &#xA;    } &#xA;}&#xA;</code></pre>&#xA;&#xA;<p>More info: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-multi-match-query.html" rel="noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-multi-match-query.html</a></p>&#xA;
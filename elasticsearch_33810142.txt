33810142
Elasticsearch mapping not working
<p>Trying to create mapping under Elasticsearch 2 with the following command, but it fails:</p>&#xA;&#xA;<pre><code>POST /my_blog    &#xA;{&#xA;    "settings": {&#xA;        "index" : {&#xA;            "number_of_shards" : 10&#xA;        }&#xA;    },     &#xA;    "mappings": {&#xA;        "post" : {        &#xA;            "_routing" : {&#xA;                "required": false,&#xA;                "path" : "post_date"&#xA;            },&#xA;            "properties": {&#xA;                "user_id" :{&#xA;                    "type": "integer"                    &#xA;                },&#xA;                "post_text" : {&#xA;                    "type": "string"                    &#xA;                },&#xA;                "post_date": {&#xA;                    "type" : "date",&#xA;                    "format" : "YYYY-MM-DD"&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Response:</p>&#xA;&#xA;<pre><code>{&#xA;   "error": {&#xA;      "root_cause": [&#xA;         {&#xA;            "type": "mapper_parsing_exception",&#xA;            "reason": "Mapping definition for [_routing] has unsupported parameters:  [path : post_date]"&#xA;         }&#xA;      ],&#xA;      "type": "mapper_parsing_exception",&#xA;      "reason": "mapping [post]",&#xA;      "caused_by": {&#xA;         "type": "mapper_parsing_exception",&#xA;         "reason": "Mapping definition for [_routing] has unsupported parameters:  [path : post_date]"&#xA;      }&#xA;   },&#xA;   "status": 400&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>It doesn't matter what field I choose for the path, integer/string or date, it always gives the same error reply (see above). Any ideas?</p>&#xA;
<p>Take a look at the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/breaking_20_mapping_changes.html#migration-meta-fields">type meta-field changes in 2.0</a>. What you're trying to do can't be done anymore.</p>&#xA;&#xA;<p>You'll have to create the index like this:</p>&#xA;&#xA;<pre><code>POST /my_blog    &#xA;{&#xA;    "settings": {&#xA;        "index" : {&#xA;            "number_of_shards" : 10&#xA;        }&#xA;    },     &#xA;    "mappings": {&#xA;        "post" : {        &#xA;            "_routing" : {&#xA;                "required": false&#xA;            },&#xA;            "properties": {&#xA;                "user_id" :{&#xA;                    "type": "integer"                    &#xA;                },&#xA;                "post_text" : {&#xA;                    "type": "string"                    &#xA;                },&#xA;                "post_date": {&#xA;                    "type" : "date",&#xA;                    "format" : "YYYY-MM-DD"&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Then specify the routing in the query string of each indexed document, like:</p>&#xA;&#xA;<pre><code>PUT /my_blog/post/1?routing=2015-11-19&#xA;{&#xA;    "user_id": 1,&#xA;    "post_text": "Lorem ipsum",&#xA;    "post_date": "2015-11-19"&#xA;}&#xA;</code></pre>&#xA;
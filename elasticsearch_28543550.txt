28543550
Elasticsearch Date Histogram Aggregation Date Format
<p>I have some documents in an index. my document look like this:</p>&#xA;&#xA;<pre><code>{&#xA;  "_index" : "news_collection",&#xA;  "_type" : "news",&#xA;  "_id" : "54dafbf0e4b0e3cf93676007",&#xA;  "_score" : 0.2631625,&#xA;  "_source":{"title":"some title","content":"example content"&#xA;             ,"publication_date":"Dec 31, 2006 11:11:00 PM"},&#xA; {&#xA;  "_index" : "news_collection",&#xA;  "_type" : "news",&#xA;  "_id" : "54dafbf0e4b0e3cf93676007",&#xA;  "_score" : 0.2631625,&#xA;  "_source":{"title":"some title","content":"example content"&#xA;            ,"publication_date":"Dec 31, 2006 11:11:00 PM"},&#xA;</code></pre>&#xA;&#xA;<p>I want to group my document in month interval. I tried to do this code:</p>&#xA;&#xA;<pre><code>curl -XPOST 'localhost:9200/news_collection/_search?pretty' -d '&#xA;{ &#xA;  "aggs" : {&#xA;    "articles_over_time" : {&#xA;        "date_histogram" : {&#xA;            "field" : "publication_date",&#xA;            "interval" : "day",&#xA;            "format" : "MMM dd, yyyy h:mm:ss aa" &#xA;        }&#xA;    }&#xA;  } &#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>but elastic search get me an error:</p>&#xA;&#xA;<pre><code> "error" : "SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[_6V06L2iS4672onsoOixbA]    [news_collection][0]:   ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndex     FieldData cannot be cast to  &#xA;</code></pre>&#xA;&#xA;<p>org.elasticsearch.index.fielddata.IndexNumericFieldData]} ...</p>&#xA;&#xA;<p>I very tried to change date format and field name but not woking.</p>&#xA;
<p>The date format has to be given during indexing and not while searching.&#xA;You need to define this field as <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping-core-types.html#date" rel="nofollow">date core type</a> in the schema and then index the documents.&#xA;After that you can do aggregation on that field. The format specified in the aggregation is the format to which you want the output as and not the field format of already indexed document.</p>&#xA;
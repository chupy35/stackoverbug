31001485
Add filter in request. ElasticSearch
<p>I have my request:</p>&#xA;&#xA;<pre><code>*{&#xA;&#xA;"query": {&#xA;"range": {&#xA;"@timestamp": {&#xA;"gt": "now-8h"&#xA;}&#xA;}&#xA;},&#xA;&#xA;"filter" :{&#xA;"term": {&#xA;"user-id": "661474"&#xA;} &#xA;},&#xA;&#xA;"sort": [&#xA;{&#xA;"@timestamp": {&#xA;"order": "asc"&#xA;}&#xA;}&#xA;]&#xA;}*&#xA;</code></pre>&#xA;&#xA;<p>and I want to add filter for display only document with strings "log out" and "log in" in "message" field.&#xA;But i can't understand where i have to put this filter in my request. </p>&#xA;
<p>If you wish to set these values as a filter and not a query, the following filter would function.</p>&#xA;&#xA;<p>This will combine your existing filter of a numeric value on the userid field with a terms filter on the message field, the bool and must keywords signifying that both filters must evaluate to true to be returned.</p>&#xA;&#xA;<p>You should read the docs on <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/combining-filters.html" rel="nofollow">combining</a> filters and the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-terms-filter.html" rel="nofollow">terms</a> filter to understand how it functions.</p>&#xA;&#xA;<pre><code>"filter": {&#xA;            "bool" : {&#xA;                "must" : [&#xA;                    {"term" : { "user-id" : "661474" } },&#xA;                    {"terms" : { "message" : ["log out", "log in"] } },&#xA;                ]&#xA;             }&#xA;         }&#xA;</code></pre>&#xA;&#xA;<p>Edit to reflect clarification in comments:</p>&#xA;&#xA;<pre><code>"query": {&#xA;    "query_string": {&#xA;      "default_field": "message",&#xA;      "query": "log in OR log out"&#xA;    }&#xA;  }&#xA;</code></pre>&#xA;&#xA;<p>Query string syntax docs can be found <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.3/query-dsl-query-string-query.html#query-string-syntax" rel="nofollow">here</a>.</p>&#xA;
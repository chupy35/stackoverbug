32342497
How to set ttl for elasticsearch with the official nodejs library?
<p>So i have an existing index. I close it to updateSettings and then reopen.</p>&#xA;&#xA;<pre><code>client.indices.putSettings({&#xA;    index: 'myindex',&#xA;    type: 'mytype',&#xA;    body: {&#xA;        '_ttl': {&#xA;            "enabled" : true,&#xA;            'default': '1m'&#xA;        }&#xA;    }&#xA;})&#xA;.then(function (result) {&#xA;    console.log('result', result)&#xA;})&#xA;</code></pre>&#xA;&#xA;<p>And then i create a new document to see if ttl is actually working but it doesn't work.</p>&#xA;&#xA;<p>What i see from the index</p>&#xA;&#xA;<p><img src="https://dl.dropboxusercontent.com/s/8ii4u8uo6mcje2e/2015-09-02%20at%206.39%20AM.png" alt=""></p>&#xA;&#xA;<p>Any idea on what i did wrong?</p>&#xA;
<p>The <code>_ttl</code> shall be set on the mapping type directly and not on the index so you want to use <code>putMapping</code> instead of <code>putSettings</code>.</p>&#xA;&#xA;<pre><code>client.indices.putMapping({&#xA;    index: 'myindex',&#xA;    type: 'mytype',&#xA;    body: {&#xA;        'mytype': {&#xA;            '_ttl': {&#xA;                "enabled" : true,&#xA;                'default': '1m'&#xA;            }&#xA;        }&#xA;    }&#xA;})&#xA;.then(function (result) {&#xA;    console.log('result', result)&#xA;})&#xA;</code></pre>&#xA;&#xA;<p>It is the equivalent of this REST call:</p>&#xA;&#xA;<pre><code>curl -XPUT 'http://localhost:9200/myindex/_mapping/mytype' -d '{&#xA;    "mytype": {&#xA;        "_ttl": {&#xA;             "enabled": true, "default": "1m"&#xA;        }&#xA;    }&#xA;}'&#xA;</code></pre>&#xA;
30023320
sort by number of words of a field in elasticsearch
<p>I have a string field in my document. Now I need to sort my documents based on the word counts of that field. How do I accomplish that in elasticsearch?</p>&#xA;
<p>Use <strong><a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html" rel="nofollow">term aggregation</a></strong> like as :</p>&#xA;&#xA;<pre><code>curl -H GET http://loclahost:9200/index name/_search?pretty=1 -d' &#xA;    {&#xA;        "aggs": {&#xA;            "genders": {&#xA;                "terms": {&#xA;                    "field": "gender"&#xA;                }&#xA;            }&#xA;        }&#xA;    }'&#xA;</code></pre>&#xA;&#xA;<blockquote>&#xA;  <p>Note : for curl command <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.x/search-search.html" rel="nofollow">check this</a></p>&#xA;</blockquote>&#xA;&#xA;<p>Here search for field <code>gender</code> and get result of all gender in aggregation bucket and default result is sorted order.</p>&#xA;
<p>Your best bet is to store the token count alongside the original field. See the documentation in the Core Types here: <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.4/mapping-core-types.html#token_count" rel="nofollow">http://www.elastic.co/guide/en/elasticsearch/reference/1.4/mapping-core-types.html#token_count</a></p>&#xA;&#xA;<p>Then you would sort by field.word_count (where field is the 'parent' property).</p>&#xA;
<p>The best approach to this would be to use the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.4/mapping-core-types.html#token_count" rel="nofollow">token count type</a>.&#xA;But then we need to make sure that we are not disrupting the orginal string. For this , we need to use <a href="http://www.elastic.co/guide/en/elasticsearch/reference/0.90/mapping-multi-field-type.html" rel="nofollow">multi field</a> and add additional field to keep track of the tokens alone.</p>&#xA;&#xA;<p>Now a mapping like below should work best for us</p>&#xA;&#xA;<pre><code>{&#xA;    "tweet" : {&#xA;        "properties" : {&#xA;            "name" : {&#xA;                "type" : "multi_field",&#xA;                "fields" : {&#xA;                    "wordCount" : {"type" : "token_count"},&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
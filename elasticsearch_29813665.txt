29813665
ElasticSearch mapping "not working" v1.1.1
<p>I have been struggling over what must be a simple syntax issue, trying to make a basic ES mapping work. This is version 1.1.1</p>&#xA;&#xA;<p>I have a gist to be able to create everything from scratch: </p>&#xA;&#xA;<p><a href="https://gist.github.com/jrmadsen67/1fc5e296e26e7a5edae0" rel="nofollow">https://gist.github.com/jrmadsen67/1fc5e296e26e7a5edae0</a></p>&#xA;&#xA;<p>The mapping query is:</p>&#xA;&#xA;<pre><code>PUT /movies/movie/_mapping&#xA;{&#xA;   "movie": {&#xA;      "properties": {&#xA;         "director": {&#xA;            "type": "multi_field",&#xA;            "fields": {&#xA;                "director": {"type": "string"},&#xA;                "original": {"type" : "string", "index" : "not_analyzed"}&#xA;            }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I ran:</p>&#xA;&#xA;<pre><code>curl localhost:9200/movies/movie/_mapping?pretty=true&#xA;</code></pre>&#xA;&#xA;<p>to confirm the mapping is actually there</p>&#xA;&#xA;<p>the query:</p>&#xA;&#xA;<pre><code>POST /movies/movie/_search&#xA;{&#xA;    "query": {&#xA;        "constant_score": {&#xA;            "filter": {&#xA;                "term": { "director.original": "Francis Ford Coppola" }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>does not get any hits. {"director": "francis"} works as expected.</p>&#xA;&#xA;<p>Greatly appreciate another set of eyes that can tell me what's wrong with this!</p>&#xA;
<p>The current mapping which match yours documents is :</p>&#xA;&#xA;<pre><code>{&#xA;    "movie" : {&#xA;        "properties" : {&#xA;            "director" : {&#xA;                "type" : "string"&#xA;            },&#xA;            "genres" : {&#xA;                "type" : "string"&#xA;            },&#xA;            "title" : {&#xA;                "type" : "string"&#xA;            },&#xA;            "year" : {&#xA;                "type" : "long"&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>To match yours mapping and query, documents should be looking like :</p>&#xA;&#xA;<pre><code>{&#xA;    "director": {&#xA;        "director": "Francis Ford Coppola",&#xA;        "original": "xxxxxx"&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
<p>This issue was nothing more than the need to re-index the data after adding the mapping.</p>&#xA;&#xA;<p>Here's an excellent walkthrough for others having this trouble:</p>&#xA;&#xA;<p><a href="https://www.found.no/foundation/mapping-workflow/" rel="nofollow">https://www.found.no/foundation/mapping-workflow/</a></p>&#xA;
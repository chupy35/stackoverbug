33375763
combine fields of different documents in same index
<p>I have 2 fields type in my index;</p>&#xA;&#xA;<p>doc1</p>&#xA;&#xA;<pre><code>{&#xA;"category":"15",&#xA;"url":"http://stackoverflow.com/questions/ask"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>doc2</p>&#xA;&#xA;<pre><code>  {&#xA;    "url":"http://stackoverflow.com/questions/ask"&#xA;    "requestsize":"231",&#xA;    "logdate":"22/12/2012",&#xA;    "username":"mehmetyeneryilmaz"&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>now I need such a query that filter in same url field and returns fields both of documents: </p>&#xA;&#xA;<p>result:</p>&#xA;&#xA;<pre><code>        {&#xA;        "category":"15",&#xA;        "url":"http://stackoverflow.com/questions/ask"&#xA;        "requestsize":"231",&#xA;        "logdate":"22/12/2012",&#xA;        "username":"mehmetyeneryilmaz"&#xA;        }&#xA;</code></pre>&#xA;
<p>The results given by elasticsearch are always per document, means that if there are multiple documents satisfying your query/filter, they would always appear as a different documents in the result and never merged into a single document. Hence merging them at client side is the one option which you can use. To avoid getting complete document and just to get the relevant fields, you can use "fields" in your query.</p>&#xA;&#xA;<p>If this is not what you need and still needs narrowing down the result from the query itself, you can use top hit aggregations. It will give you the complete list of documents under a single bucket. But it would also have source field which would contain the complete documents itself.</p>&#xA;&#xA;<p>Try giving a read to page:&#xA;<a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-aggregations-metrics-top-hits-aggregation.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-aggregations-metrics-top-hits-aggregation.html</a></p>&#xA;
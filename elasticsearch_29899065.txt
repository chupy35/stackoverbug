29899065
Elasticsearch: Count how often a term is in each document
<p>For an entry, I can easily find out how often a specific term is used using the termvector api.</p>&#xA;&#xA;<p>Now I want to know how often a term is in each document of my index.</p>&#xA;&#xA;<pre><code>term    | ID1 | ID2 | ID3 | ID4  [...]&#xA;'hello' |  2  |  4  |  0  |  12  [...]&#xA;</code></pre>&#xA;&#xA;<p>Is there a better/more efficient way to get this statistic besides searching for my term and calling the termvector for every result?</p>&#xA;
<p>You can use scripting to achieve this.&#xA;Follow the documentation <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-advanced-scripting.html#_term_statistics_2" rel="nofollow">here</a> and <a href="http://blog.qbox.io/elasticsearch-scripting-sorting" rel="nofollow">here</a>.&#xA;Also have a good idea on <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-script-fields.html" rel="nofollow">scripted field</a> too , it helps you get additional field per document.</p>&#xA;&#xA;<p>Sample query - </p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "match": {&#xA;      "provider": "qbox"&#xA;    }&#xA;  },&#xA;  "script_fields": {&#xA;    "test1": {&#xA;      "script": "_index['provider']['qbox'].tf()"&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Where provider is the field and qbox is the value.</p>&#xA;
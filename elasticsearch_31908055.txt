31908055
Elasticsearch, how to convert ip long to string, to get ip subnets aggs
<p>there is a field named ip, which mapped to ip type, now i want to aggs as /24 subnets, i use script "doc['ip'].value &amp; 0xffffff00" to get long value of ip, how to next to convert it to ip string???</p>&#xA;&#xA;<pre><code>{&#xA;  "_source": [&#xA;    "host",&#xA;    "ip"&#xA;  ],&#xA;  "aggs": {&#xA;    "ip_subnet": {&#xA;      "terms": {&#xA;        "script": "doc['ip'].value &amp; 0xffffff00"&#xA;      }&#xA;    }&#xA;  },&#xA;  "size": 0&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I didn't found any result from elastic website, I wonder know if there is another way to receive the subnets aggs?</p>&#xA;&#xA;<p>Thank you very much, and forgive my pool english ;)</p>&#xA;
<p>Finally, I finished by define a longToIp similar script... Maybe there is another good solution...</p>&#xA;&#xA;<pre><code>"aggs": {&#xA;    "ip_subnet": {&#xA;      "terms": {&#xA;        "script": "ip=doc['ip'].value &amp; 0xffffff00;octet3 = (int) ((ip &gt;&gt; 24) % 256);octet2 = (int) ((ip &gt;&gt; 16) % 256);octet1 = (int) ((ip &gt;&gt; 8) % 256);octet0 = (int) ((ip) % 256);ipstr=octet3 + '.' + octet2 + '.' + octet1 + '.' + octet0;return ipstr+\"/24\";"&#xA;      }&#xA;    }&#xA;  },&#xA;</code></pre>&#xA;
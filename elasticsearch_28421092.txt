28421092
elasticsearch not attaching a default
<p>I have tried a lot of iterations of this but it simply won't work. I am looking to have _timestamp or @timestamp attached to each document automatically.&#xA;can't seem to get this to work.</p>&#xA;&#xA;<p>although the documents are being ingested properly</p>&#xA;&#xA;<pre><code>curl -XPOST 'http://X.X.X.X:9200/associations' -d '{&#xA;"settings" : {&#xA;    "number_of_shards" : 1&#xA;},&#xA;"mappings" : {&#xA;    "_default_":{&#xA;        "_timestamp" : {&#xA;            "enabled" : true,&#xA;            "store" : true,&#xA;             "path" : "post_date"&#xA;        }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>i have also tried setting this directly within my index</p>&#xA;&#xA;<pre><code>curl -XPUT 'http://X.X.X.X:9200/associations' -d  '{&#xA;    "mappings": {&#xA;       "_timestamp" :&#xA;       {&#xA;           "enabled":true,&#xA;           "store": "yes",&#xA;           "path" : "post_date",&#xA;           "type": "date",&#xA;           "format" : "yyyy-MM-dd HH:mm:ss"&#xA;&#xA;       }&#xA;     }&#xA;}'&#xA;</code></pre>&#xA;
<p>The first code block you have seems to work for me. If I use it to define an index:</p>&#xA;&#xA;<pre><code>DELETE /test_index&#xA;&#xA;PUT /test_index&#xA;{&#xA;   "settings": {&#xA;      "number_of_shards": 1,&#xA;      "number_of_replicas": 0&#xA;   },&#xA;   "mappings": {&#xA;      "_default_": {&#xA;         "_timestamp": {&#xA;            "enabled": true,&#xA;            "store": true,&#xA;            "path": "post_date"&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Then add a couple of docs to a new type:</p>&#xA;&#xA;<pre><code>PUT /test_index/doc/1&#xA;{&#xA;    "post_date": "2015-1-25"&#xA;}&#xA;&#xA;PUT /test_index/doc/2&#xA;{&#xA;    "post_date": "2015-1-15"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I can see the timestamp in the new mapping now:</p>&#xA;&#xA;<pre><code>GET /test_index/_mapping&#xA;...&#xA;{&#xA;   "test_index": {&#xA;      "mappings": {&#xA;         "_default_": {&#xA;            "_timestamp": {&#xA;               "enabled": true,&#xA;               "store": true,&#xA;               "path": "post_date"&#xA;            },&#xA;            "properties": {}&#xA;         },&#xA;         "doc": {&#xA;            "_timestamp": {&#xA;               "enabled": true,&#xA;               "store": true,&#xA;               "path": "post_date"&#xA;            },&#xA;            "properties": {&#xA;               "post_date": {&#xA;                  "type": "date",&#xA;                  "format": "dateOptionalTime"&#xA;               }&#xA;            }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>and I can search against the type, and ask for <code>"_timestamp"</code> in my <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-fields.html#search-request-fields" rel="nofollow">fields</a>, I get back the timestamps in the results:</p>&#xA;&#xA;<pre><code>POST /test_index/doc/_search&#xA;{&#xA;    "fields": [&#xA;       "_timestamp",&#xA;       "post_date"&#xA;    ]&#xA;}&#xA;...&#xA;{&#xA;   "took": 1,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 1,&#xA;      "successful": 1,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 2,&#xA;      "max_score": 1,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "1",&#xA;            "_score": 1,&#xA;            "fields": {&#xA;               "post_date": [&#xA;                  "2015-1-25"&#xA;               ],&#xA;               "_timestamp": 1422144000000&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "test_index",&#xA;            "_type": "doc",&#xA;            "_id": "2",&#xA;            "_score": 1,&#xA;            "fields": {&#xA;               "post_date": [&#xA;                  "2015-1-15"&#xA;               ],&#xA;               "_timestamp": 1421280000000&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is the code I used:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/1ab1ecb73d3e87cffe0052ce1706e7985d197fad" rel="nofollow">http://sense.qbox.io/gist/1ab1ecb73d3e87cffe0052ce1706e7985d197fad</a></p>&#xA;&#xA;<p>I'm running Elasticsearch version 1.3.4, by the way.</p>&#xA;
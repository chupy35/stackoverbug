28602719
Delete elasticsearch records by query
<p>I have a code that find records what I need:</p>&#xA;&#xA;<pre><code>curl -XGET "http://localhost:9200/one/two/_search" -d '&#xA;{&#xA;  "query" : {&#xA;    "range" : {&#xA;        "timestamp" : { "gte" : "2014-09-01T00:00:00.000Z", "lt" : "2014-09-01T00:00:00.000Z||+1M"}&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>Now I want to transform it to code that will delete these records.</p>&#xA;&#xA;<p>According to <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/1.x/docs-delete-by-query.html#docs-delete-by-query" rel="nofollow">this doc</a> I tried to change <em>_search</em> to <em>query</em> and got:</p>&#xA;&#xA;<pre><code>{"_index":"one","_type":"two","_id":"_query","found":false}&#xA;</code></pre>&#xA;&#xA;<p>I tried to change <em>XGET</em> to <em>XDELETE</em>:</p>&#xA;&#xA;<pre><code>{"found":false,"_index":"one","_type":"two","_id":"_search","_version":1}&#xA;</code></pre>&#xA;&#xA;<p>Elasticsearch version:</p>&#xA;&#xA;<pre><code>"version" : {&#xA;    "number" : "1.0.3",&#xA;    "build_hash" : "61bfb72d845a59a58cd9910e47515665f6478a5c",&#xA;    "build_timestamp" : "2014-04-16T14:43:11Z",&#xA;    "build_snapshot" : false,&#xA;    "lucene_version" : "4.6"&#xA;  }&#xA;</code></pre>&#xA;&#xA;<p>What is the right query to delete these records?</p>&#xA;
<p>Yes you can use delete by query to delete documents which match your query, but instead of using _search you need to say _query</p>&#xA;&#xA;<pre><code>curl -XDELETE "http://localhost:9200/one/two/_query" -d '&#xA;{&#xA;  "query" : {&#xA;    "range" : {&#xA;        "timestamp" : { "gte" : "2014-09-01T00:00:00.000Z", "lt" : "2014-09-01T00:00:00.000Z||+1M"}&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;
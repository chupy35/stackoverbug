29365727
Ranged Query with ElasticSearch
<p>I'm testing with ElasticSearch and I'm having problems with ranged queries.&#xA;Consider the following document that I've inserted:</p>&#xA;&#xA;<pre><code>curl -XPUT 'localhost:9200/test/test/test?pretty' -d '&#xA;{&#xA;  "name": "John Doe",&#xA;  "duration" : "10",&#xA;  "state" : "unknown"&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>And now I'me trying to do a ranged query that catches all documents whose duration is between 5 and 15:</p>&#xA;&#xA;<pre><code>curl -XPOST 'localhost:9200/test/_search?pretty' -d '&#xA;{&#xA;  "query": {&#xA;    "range": {&#xA;      "duration": {&#xA;        "gte": "5",&#xA;        "lte": "15"&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>This returns no hits however if I run the Query like this:</p>&#xA;&#xA;<pre><code>curl -XPOST 'localhost:9200/test/_search?pretty' -d '&#xA;{&#xA;  "query": {&#xA;    "range": {&#xA;      "duration": {&#xA;        "gte": "10"&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>It returns the Document I've inserted earlier. How can I query ElasticSearch for documents with the duration value between 5 and 15.</p>&#xA;
<p>The problem is that you are indexing your values as strings. This causes the range query not to work. Try indexing and querying as follows:</p>&#xA;&#xA;<pre><code>curl -XPUT 'localhost:9200/test/test/test?pretty' -d '&#xA;{&#xA;  "name": "John Doe",&#xA;  "duration" : 10,&#xA;  "state" : "unknown"&#xA;}'&#xA;&#xA;curl -XPOST 'localhost:9200/test/_search?pretty' -d '&#xA;{&#xA;  "query": {&#xA;    "range": {&#xA;      "duration": {&#xA;        "gte": 5,&#xA;        "lte": 15&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>This wil yield the following result:</p>&#xA;&#xA;<pre><code>{&#xA;  "took" : 2,&#xA;  "timed_out" : false,&#xA;  "_shards" : {&#xA;    "total" : 5,&#xA;    "successful" : 5,&#xA;    "failed" : 0&#xA;  },&#xA;  "hits" : {&#xA;    "total" : 1,&#xA;    "max_score" : 1.0,&#xA;    "hits" : [ {&#xA;      "_index" : "test",&#xA;      "_type" : "test",&#xA;      "_id" : "test",&#xA;      "_score" : 1.0,&#xA;      "_source":&#xA;{&#xA;  "name": "John Doe",&#xA;  "duration" : 10,&#xA;  "state" : "unknown"&#xA;}&#xA;    } ]&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
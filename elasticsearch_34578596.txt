34578596
Including and excluding indexes in Elasticsearch query
<p>I have the following Elasticsearch query.</p>&#xA;&#xA;<pre><code>GET /index1,index2/type1,type2/_search?q=programming&#xA;</code></pre>&#xA;&#xA;<p>Let's say that I want to exclude <code>index2</code> from this search query. The <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-index.html#multi-index" rel="nofollow">documentation states the following</a>:</p>&#xA;&#xA;<blockquote>&#xA;  <p>It also support wildcards, for example: test*, and the ability to&#xA;  "add" (+) and "remove" (-), for example: +test*,-test3.</p>&#xA;</blockquote>&#xA;&#xA;<p>As far as I understand, I should be able to do the following.</p>&#xA;&#xA;<pre><code>GET /+index1,-index2/type1,type2/_search?q=programming&#xA;</code></pre>&#xA;&#xA;<p>However, I get the below error.</p>&#xA;&#xA;<pre><code>{&#xA;  "error": {&#xA;    "root_cause": [&#xA;      {&#xA;        "type": "index_not_found_exception",&#xA;        "reason": "no such index",&#xA;        "resource.type": "index_or_alias",&#xA;        "resource.id": " index1",&#xA;        "index": " index1"&#xA;      }&#xA;    ],&#xA;    "type": "index_not_found_exception",&#xA;    "reason": "no such index",&#xA;    "resource.type": "index_or_alias",&#xA;    "resource.id": " index1",&#xA;    "index": " index1"&#xA;  },&#xA;  "status": 404&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>If I remove the plus and minus signs, the query runs fine. If I add a wildcard, it seems to work, e.g. the below query.</p>&#xA;&#xA;<pre><code>GET /index1,-*index2/type1,type2/_search?q=programming&#xA;</code></pre>&#xA;&#xA;<p>However, that's not really what I want.</p>&#xA;&#xA;<p>Why is my query not working when I use plus and minus signs to include or exclude indexes as the documentation states? Am I misunderstanding something?</p>&#xA;&#xA;<p>I am using Elasticsearch 2.1.</p>&#xA;
<p>You need to <strong>encode</strong> the <code>+</code> sign as it is considered <code>space</code> in URL string. See there is <code>space</code> in <code>"resource.id": " index1",</code></p>&#xA;&#xA;<p>This will work</p>&#xA;&#xA;<pre><code>GET /%2Bindex1,-index2/type1,type2/_search?q=programming&#xA;</code></pre>&#xA;&#xA;<p>Hope this helps!!</p>&#xA;
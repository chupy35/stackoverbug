33462116
Elasticsearch no disk space available
<p>I have a 3 nodes Elasticsearch cluster that exhausted the disk space in each node. Each node is an EC2 instance. The cluster is now completely irresponsive.</p>&#xA;&#xA;<p>What solutions do I have to free up space?</p>&#xA;&#xA;<p>Would adding a node in cluster free up space in the other node because now the cluster will re-distribute the information over the other nodes?</p>&#xA;&#xA;<p>Or is my only solution but definitely not the preferred ones is to create a larger cluster on the side and migrate over the data from the first cluster?</p>&#xA;&#xA;<p>Any other ideas/solutions is more than welcome.</p>&#xA;&#xA;<p>The cluster configuration on each node(elasticsearch.yml) looks as follows:</p>&#xA;&#xA;<pre><code>cluster.name: AutoSearchCluster&#xA;node.name: i-asd4352&#xA;plugin.mandatory: cloud-aws&#xA;discovery.zen.ping.multicast.enabled: false&#xA;discovery.type: ec2&#xA;cloud.aws.region: us-west-2&#xA;discovery.ec2.groups: prod-group&#xA;gateway.recover_after_nodes: 2&#xA;gateway.expected_nodes: 3&#xA;gateway.recover_after_time: 5m&#xA;indices.fielddata.cache.size: 40%&#xA;</code></pre>&#xA;&#xA;<p>Thx in advance.</p>&#xA;
<p>you can add a new node to the cluster and rearrange the shards, reroute/move the shards to new node, but before proceeding take a backup of your data.&#xA;Also you can mount network attached hard disk to your EC2 and configure your ES to different storage paths.</p>&#xA;
<p>EC2 root instance volume may not come with a great amount of disk space, so before adding new nodes, check your EC2 AMI specs (what AMI id are you using?), to see what is device root storage (EBS vs Internal). After that, if required, any new node you add should be defined with an EBS volume of the required size attached where ES is going to store the data (or an increased EBS root volume)</p>&#xA;&#xA;<p>In the short term, if the number of shards defined for the index (by default 5) is greater than 3, yes, you can add as many nodes as the number of shards, and there will be some improvement (because some of the shards, that are currently in the existing nodes, would go to the new node). </p>&#xA;&#xA;<p>Also if you have 1 or more replicas (shards * replicas > nodes), adding a new node will get you some improvements (because some of the replicas would go to the new node). </p>&#xA;&#xA;<p>However, if you're index has i.e. 3 shard and zero replicas, adding a new node won't do anything. </p>&#xA;
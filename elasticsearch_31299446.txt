31299446
In Elasticsearch, can I search for all documents with > *N* nested child documents?
<p>Let's say I've got a social network with the following mapping:</p>&#xA;&#xA;<pre><code>{&#xA;  “users” : {&#xA;    “properties” : {&#xA;      “username” : {“type” : “string”, "index": "not_analyzed”},&#xA;      “full_name” : {“type” : “string”},&#xA;      “friends” : {&#xA;        “type” : “nested”,&#xA;        “properties” : {&#xA;          “username” : {“type” : “string”, "index": "not_analyzed”},&#xA;          “date_friended” : {“type” : “date”},&#xA;        }&#xA;      }&#xA;    } &#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Can I search for all users with > 5 friends?  As of right now, I'm maintaining a separate count of the children in the parent document.</p>&#xA;&#xA;<p>Can I do this as a filtered query?  Do I need to use aggregations instead?</p>&#xA;&#xA;<p>Thanks in advance!</p>&#xA;
32334295
What is the performance impact of using a Match All filter in elastic search?
<p>As part of query optimization for a project, I'm considering replacing a date range filter (cached and is returning everything like match all) with a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-all-filter.html" rel="nofollow">match all filter</a>. I'm wondering if this will improve performance?</p>&#xA;&#xA;<p>My assumption is that upon execution the system would simply ignore this filter and I can get improvements in memory usage (removed the cached filter) as well as some execution time. Is this correct?</p>&#xA;
<p>If this filter matches most or all records, removing it is definitely a good optimization. However, the memory benefits might be smaller than you expect, since filters that match all records are quite optimized. </p>&#xA;
<p>Digging into the source code for elastic 1.7, I found my answer -</p>&#xA;&#xA;<p>A Match_All filter has <strong>RAM usage of size of int</strong> and it simply <strong>returns a bitset of the size of maxdocId</strong> parameter (i.e. number of records). &#xA;No requirement to cache this was an additional plus point.</p>&#xA;&#xA;<p>This bitset should be the same as that generated by range filter under the assumption that all records did have the field on which range was applied (which was the case for me). </p>&#xA;&#xA;<p>Note: Answer provided by imotov was a starting point, but I'm adding mine for complete details.</p>&#xA;&#xA;<p><em>References:</em></p>&#xA;&#xA;<p><a href="https://github.com/elastic/elasticsearch/blob/1.7/src/main/java/org/elasticsearch/common/lucene/search/MatchAllDocsFilter.java" rel="nofollow">https://github.com/elastic/elasticsearch/blob/1.7/src/main/java/org/elasticsearch/common/lucene/search/MatchAllDocsFilter.java</a></p>&#xA;&#xA;<p><a href="https://github.com/elastic/elasticsearch/blob/1.7/src/main/java/org/elasticsearch/common/lucene/docset/AllDocIdSet.java" rel="nofollow">https://github.com/elastic/elasticsearch/blob/1.7/src/main/java/org/elasticsearch/common/lucene/docset/AllDocIdSet.java</a></p>&#xA;
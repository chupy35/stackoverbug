31272483
MapperParsingException when re-indexing data
<p>I am trying to re-index data to correct date formats, however, I am encountering a MapperParsingException when parsing a date field in the format  <strong>'Thu Jan 01 02:00:00 SAST 1970'</strong>. I used the dateOptionalTime mapping, which I guess is wrong. </p>&#xA;&#xA;<p>None of the built in formats on the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html" rel="nofollow">Elasticsearch Date Format</a> reference seems to fit the bill though. Is this something I must specifically customize or can a built in Date Format version be used?  </p>&#xA;&#xA;<p><strong>EDIT 1: mappings</strong></p>&#xA;&#xA;<pre><code>{&#xA;    "mappings": {&#xA;        "users": {&#xA;            "properties": {&#xA;                "creationdate": {&#xA;                    "type": "date",&#xA;                    "format": "dateOptionalTime"&#xA;                },&#xA;                "email": {&#xA;                    "type": "string"&#xA;                },&#xA;                "firstlogin": {&#xA;                    "type": "boolean"&#xA;                },&#xA;                "firstname": {&#xA;                    "type": "string"&#xA;                },&#xA;                "lastloggedin": {&#xA;                    "type": "date",&#xA;                    "format": "dateOptionalTime"&#xA;                },&#xA;                "lastname": {&#xA;                    "type": "string"&#xA;                },&#xA;                "lastprofileupdate": {&#xA;                    "type": "date",&#xA;                    "format": "dateOptionalTime"&#xA;                },&#xA;                "userid": {&#xA;                    "type": "string"&#xA;                },&#xA;                "username": {&#xA;                    "type": "string",&#xA;                    "fields": {&#xA;                        "raw": {&#xA;                            "type": "string",&#xA;                            "index": "not_analyzed"&#xA;                        }&#xA;                    },&#xA;                    "copy_to": [&#xA;                        "username.raw"&#xA;                    ]&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
<p>Try this mapping instead</p>&#xA;&#xA;<pre><code>{&#xA;    "mappings": {&#xA;        "users": {&#xA;            "properties": {&#xA;                "creationdate": {&#xA;                    "type": "date",&#xA;                    "format": "E MMM d H:m:s z Y"&#xA;                },&#xA;                "email": {&#xA;                    "type": "string"&#xA;                },&#xA;                "firstlogin": {&#xA;                    "type": "boolean"&#xA;                },&#xA;                "firstname": {&#xA;                    "type": "string"&#xA;                },&#xA;                "lastloggedin": {&#xA;                    "type": "date",&#xA;                    "format": "E MMM d H:m:s z Y"&#xA;                },&#xA;                "lastname": {&#xA;                    "type": "string"&#xA;                },&#xA;                "lastprofileupdate": {&#xA;                    "type": "date",&#xA;                    "format": "E MMM d H:m:s z Y"&#xA;                },&#xA;                "userid": {&#xA;                    "type": "string"&#xA;                },&#xA;                "username": {&#xA;                    "type": "string",&#xA;                    "fields": {&#xA;                        "raw": {&#xA;                            "type": "string",&#xA;                            "index": "not_analyzed"&#xA;                        }&#xA;                    },&#xA;                    "copy_to": [&#xA;                        "username.raw"&#xA;                    ]&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
<p>As you suspected you would need to use the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.6/mapping-date-format.html#custom" rel="nofollow noreferrer">custom date format</a>.</p>&#xA;&#xA;<p>Unfortunately though the above example uses <a href="https://stackoverflow.com/questions/4498274/why-joda-datetimeformatter-cannot-parse-timezone-names-z">timezone names</a> i.e "<em>z</em>" which is not supported by JODA. </p>&#xA;&#xA;<p>If it is possible for you to change the format of time zone to use <a href="http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTimeZone.html" rel="nofollow noreferrer">zone id</a>&#xA;you could use custom format as follows :</p>&#xA;&#xA;<pre><code>Example Date: "Thu Jan 10 02:00:00 Africa/Johannesburg 1970"    &#xA;lastloggedin" : {&#xA;                "type": "date",&#xA;                "format" : "EEE MMM dd HH:mm:ss ZZZ y"              &#xA;            },&#xA;</code></pre>&#xA;
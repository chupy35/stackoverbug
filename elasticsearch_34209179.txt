34209179
ElasticSearch query not returning expected results
<p>The following query and index do not return the expected results. I don't understand, given the mapping constraint, when I search for "ICD9" it also returns results for "I9" and "9" among others. Any ideas?</p>&#xA;&#xA;<pre><code>Here is the index mapping:&#xA;{&#xA;  "mappings": {&#xA;    "mymap": {&#xA;      "dynamic_templates": [&#xA;        {&#xA;           "codingstandard": {&#xA;              "match": "*.CodingStandard",&#xA;              "mapping": {&#xA;                 "type": "string",&#xA;                 "index": "not_analyzed"&#xA;              }&#xA;           }&#xA;        }&#xA;      ]&#xA;    }&#xA;  }&#xA;}&#xA;&#xA;Here is my query:&#xA;{&#xA;  "fields": [&#xA;    "Diagnosis.CodingStandard"&#xA;  ],&#xA;  "query": {&#xA;    "query_string": {&#xA;      "query": "Diagnosis.CodingStandard:ICD9"&#xA;    }&#xA;  }&#xA;}&#xA;&#xA;Here are some of my results:&#xA;"hits": {&#xA;  "total": 9778,&#xA;  "max_score": 3.501487,&#xA;  "hits": [&#xA;     {&#xA;        "_index": "myindex",&#xA;        "_type": "mymapping",&#xA;        "_id": "264235",&#xA;        "_score": 3.501487,&#xA;        "fields": {&#xA;           "Diagnosis.CodingStandard": [&#xA;              "I9"&#xA;           ]&#xA;        }&#xA;     },&#xA;     {&#xA;        "_index": "myindex",&#xA;        "_type": "mymapping",&#xA;        "_id": "264261",&#xA;        "_score": 3.501487,&#xA;        "fields": {&#xA;           "Diagnosis.CodingStandard": [&#xA;              "9"&#xA;           ]&#xA;        }&#xA;     },&#xA;etc...    &#xA;</code></pre>&#xA;
<p>Yes because you are using query_string, elasticsearch doing fuzzy search by default for query_string.</p>&#xA;&#xA;<p>if you want to do exact search you can do filter instead of query_string</p>&#xA;&#xA;<pre><code>{&#xA;   "query":{&#xA;      "filtered":{&#xA;          "filter":{&#xA;             "term":{&#xA;                "Diagnosis.CodingStandard": "ICD9"&#xA;             }&#xA;          }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;
34471506
Elastic search returning wrong results
<p>I am running a query against elastic search but the results returned are wrong. The idea is that I can check against a range of fields with individual queries. But when I pass the following query, items which don't have the included lineup are returned.</p>&#xA;&#xA;<pre><code>query: {&#xA;  bool: {&#xA;    must: [&#xA;      {match:{"lineup.name":{query:"The 1975"}}}&#xA;    ]&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The objects are events which looks like.</p>&#xA;&#xA;<pre><code>{&#xA;  title: 'Glastonbury'&#xA;  country: 'UK',&#xA;  lineup: [&#xA;    {&#xA;      name: 'The 1975',&#xA;      genre: 'Indie',&#xA;      headliner: false&#xA;    }&#xA;  ]&#xA;},&#xA;{&#xA;  title: 'Reading'&#xA;  country: 'UK',&#xA;  lineup: [&#xA;    {&#xA;      name: 'The Strokes',&#xA;      genre: 'Indie',&#xA;      headliner: true&#xA;    }&#xA;  ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>In my case both of these events are returned.</p>&#xA;&#xA;<p>The mapping can be seen here:&#xA;<a href="https://jsonblob.com/567e8f10e4b01190df45bb29" rel="nofollow">https://jsonblob.com/567e8f10e4b01190df45bb29</a></p>&#xA;
<p>You need to use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html#query-dsl-match-query-phrase" rel="nofollow">match_phrase</a> query, <code>match</code> query is looking for either <em>The</em> or <em>1975</em> and it find <em>The</em> in <em>The strokes</em> and it gives you that result.</p>&#xA;&#xA;<p>Try</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "bool": {&#xA;      "must": [&#xA;        {&#xA;          "match": {&#xA;            "lineup.name": {&#xA;              "query": "The 1975",&#xA;              "type": "phrase"&#xA;            }&#xA;          }&#xA;        }&#xA;      ]&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
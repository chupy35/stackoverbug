32824588
Minimum should match on filtered query
<p>Is it possible to have a query like this</p>&#xA;&#xA;<pre><code>  "query": {&#xA;  "filtered": {&#xA;     "filter": {&#xA;        "terms": {&#xA;           "names": [&#xA;             "Anna",&#xA;             "Mark",&#xA;             "Joe"&#xA;           ],&#xA;           "execution" : "and"&#xA;        }&#xA;      }&#xA;    }&#xA;  } &#xA;</code></pre>&#xA;&#xA;<p>With the <code>"minimum_should_match": "2"</code> statement?</p>&#xA;&#xA;<p>I know that I can use a simple query (I've tried, it works) but I don't need the score to be computed. My goal is just to filter documents which contains 2 of the values.</p>&#xA;&#xA;<p>Does the score generally heavily impact the time needed to retrieves document?</p>&#xA;&#xA;<p>Using this query:</p>&#xA;&#xA;<pre><code>  "query": {&#xA;  "filtered": {&#xA;     "filter": {&#xA;        "terms": {&#xA;           "names": [&#xA;             "Anna",&#xA;             "Mark",&#xA;             "Joe"&#xA;           ],&#xA;           "execution" : "and",&#xA;           "minimum_should_match": "2"&#xA;        }&#xA;      }&#xA;    }&#xA;  } &#xA;</code></pre>&#xA;&#xA;<p>I got this error:</p>&#xA;&#xA;<pre><code>QueryParsingException[[my_db] [terms] filter does not support [minimum_should_match]]&#xA;</code></pre>&#xA;
<p>Minimum should match is not a parameter for the <code>terms filter</code>. If that is the functionality you are looking for, I might rewrite your query like this, to use the <code>bool query</code> wrapped in a <code>query filter</code>:</p>&#xA;&#xA;<pre><code>{&#xA;   "filter": {&#xA;      "query": {&#xA;         "bool": {&#xA;            "must": [&#xA;               {&#xA;                  "term": {&#xA;                     "names": "Anna"&#xA;                  }&#xA;               },&#xA;               {&#xA;                  "term": {&#xA;                     "names": "Mark"&#xA;                  }&#xA;               },&#xA;               {&#xA;                  "term": {&#xA;                     "name": "Joe"&#xA;                  }&#xA;               }&#xA;            ],&#xA;            "minimum_number_should_match": 2&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>You will get documents matching preferably exactly all three, but the query will also match document with exactly two of the three terms. The <code>must</code> is an implicit and. We also do not compute score, as we have executed the query as a filter.</p>&#xA;
34304703
elasticsearch returning Incorrect value_count on fields
<p>I have 6 simple documents:</p>&#xA;&#xA;<pre><code>{"id":1,"sid":"adf6eb4f-35a0-4099-95d4-00ce3d984cf2","asid":"577ce6b0-b8b7-49af-8528-4e4797027a12","_tid":"21"}&#xA;{"id":1,"sid":"adf6eb4f-35a0-4099-95d4-00ce3d984cf2","asid":"577ce6b0-b8b7-49af-8528-4e4797027a12","_tid":"21"}&#xA;{"id":2,"sid":"abcdef","asid":"fedcba","_tid":"21"}&#xA;{"id":3,"sid":"ghijk","asid":"kjihg","_tid":"21"}&#xA;{"id":4,"sid":"lmnop","asid":"ponml","_tid":"21"}&#xA;{"id":5,"sid":"prstuv","asid":"vutsrp","_tid":"21"}&#xA;</code></pre>&#xA;&#xA;<p>I am running a value_count aggregation on this dataset using:</p>&#xA;&#xA;<pre><code>curl -XGET 'http://poc02.transerainc.com:9200/test/csrs/_search' -d '{"size":0,"aggregations":{"SUMMARY_0_sid":{"value_count":{"field":"sid"}}}}'&#xA;</code></pre>&#xA;&#xA;<p>I am expecting the results to be 6 but I am getting 14!</p>&#xA;&#xA;<pre><code>{"took":3,"timed_out":false,"shards":{"total":5,"successful":5,"failed":0},"hits":{"total":6,"maxscore":0.0,"hits":[]},"aggregations":{"SUMMARY_0_sid":{"value":14}}}&#xA;</code></pre>&#xA;&#xA;<p>this seems to be an obvious error but what am I missing here?</p>&#xA;
<p>you should check your elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping-intro.html" rel="nofollow">mapping</a> setting for <code>sid</code>, is <code>sid</code> an <code>analyzed</code> field (it most likely is by default)? if it is being treated as an <code>analyzed</code> field then "adf6eb4f-35a0-4099-95d4-00ce3d984cf2" would be broken up into 5 different pieces. so total count accumulates to 5+5+1+1+1+1=14</p>&#xA;
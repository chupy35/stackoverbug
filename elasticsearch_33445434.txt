33445434
Elastic - with_positions and with_positions_offsets
<p>What's the difference between <code>with_positions</code> and <code>with_positions_offsets</code> with regard to the <code>term_vector</code> in Elasticsearch?</p>&#xA;
<ul>&#xA;<li><code>with_positions</code> will instruct Elasticsearch (Lucene) to, also, index the position of the terms in the original text</li>&#xA;</ul>&#xA;&#xA;<p>This helps with the order of terms inside a field, for example for the other question you had <a href="https://stackoverflow.com/questions/33435670/elasticsearch-layered-ordering">here</a>.</p>&#xA;&#xA;<ul>&#xA;<li><code>with_positions_offsets</code> will instruct Elasticsearch (Lucene) to, also, index the position of the terms in the original text <strong>and</strong> the character offset information about each term (the start position and end position for each term, at the character level)</li>&#xA;</ul>&#xA;&#xA;<p>This helps in cases when the original text that was indexed was <em>"changed"</em> during the analysis phase, for example, by changing terms in it by their synonyms. These synonyms can have multiple words, thus changing the whole "structure" (positions <strong>and</strong> offsets) of the original text.</p>&#xA;&#xA;<hr>&#xA;&#xA;<p>In both cases the size of the index on disk will increase. The increase will be smaller for <code>with_positions</code> than <code>with_positions_offsets</code>.</p>&#xA;&#xA;<p><code>term_vector</code> options are a must for <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-request-highlighting.html" rel="nofollow noreferrer">highlighting</a>!</p>&#xA;&#xA;<hr>&#xA;&#xA;<p>A great example demonstrating <code>positions</code> and <code>offsets</code> can be found on this Lucene and Elasticsearch committer <a href="http://blog.jpountz.net/post/41301889664/putting-term-vectors-on-a-diet" rel="nofollow noreferrer">blog post</a>:</p>&#xA;&#xA;<p><a href="https://i.stack.imgur.com/JgFYq.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/JgFYq.png" alt="Sample text"></a></p>&#xA;&#xA;<p>For this sample text, this is how the list of positions for each term and the character offsets look like:</p>&#xA;&#xA;<p><a href="https://i.stack.imgur.com/hGpaB.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/hGpaB.png" alt="enter image description here"></a></p>&#xA;
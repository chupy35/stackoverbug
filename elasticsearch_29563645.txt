29563645
In ElasticSearch how can I check if the values in an array match
<p>In ElasticSearch I have the following document structure...</p>&#xA;&#xA;<pre><code>{&#xA;    name: "bob",&#xA;    permissions: [&#xA;        2,&#xA;        4,&#xA;        6&#xA;    ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I need to be able to perform a search which will check if the permissions for "bob" are contained within a given array.</p>&#xA;&#xA;<p>e.g I have an array with contents</p>&#xA;&#xA;<pre><code>[1,2,3,4,5,6]&#xA;</code></pre>&#xA;&#xA;<p>I need the "bob" document to be returned because my array contains 2,4,6 and so does "bob"</p>&#xA;&#xA;<p>If my array contained 1,3,4,5,6 "bob" should not be selected because my array does not contain "2"</p>&#xA;&#xA;<p>Essentially I want to match any documents whose permission entries are all contained in my array.</p>&#xA;
<p>Your use case is, basically, "for a set of permissions (which a particular user has), find all the documents that only require permissions in that set."</p>&#xA;&#xA;<p>One solution would be to provide an implementation which does "for a set of permissions, find all the documents which don't require any other permission."</p>&#xA;&#xA;<p>Provided all possible values for permission can be retrieved at any time*, you can get that list, remove the values possessed by the current user, and put each of the remaining values in a "must_not" term of a bool filter.</p>&#xA;&#xA;<p>Even for a large number of possible permissions, the search operation would be quite fast, as those term filters would be cached.</p>&#xA;&#xA;<p>*If no other method of finding all possible values of permission is reliable, you could do a terms aggregation on permission to find all currently indexed values.</p>&#xA;
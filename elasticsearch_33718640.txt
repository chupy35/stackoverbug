33718640
ElasticSearch cluster behavior - Define all nodes to update together
<p>After I insert a document to ElasticSearch I immediately go and retrieve it with a query. &#xA;I am polling the request several times so if it isn't completely indexed it will return in the second or third try.</p>&#xA;&#xA;<p>Sometimes, &#xA;in a clustered environment, I have noticed that I can get the request and a milisecond later the same request is returned empty. </p>&#xA;&#xA;<p>I assume that it goes to another node in the cluster - that is not yet indexed. </p>&#xA;&#xA;<p>If this is it, I really need to define the cluster to return a value only after all nodes are updated with it.</p>&#xA;&#xA;<ol>&#xA;<li>Was what I described true? Is it possible that not all nodes are updated together? </li>&#xA;<li>Is it a cluster configuration issue ? Is it solvable with configuration?</li>&#xA;</ol>&#xA;&#xA;<p>Thanks. </p>&#xA;
<p>What you're experiencing is normal given Elasticsearch works in "near-real" time. By default, the cluster is refreshed every second, but you can change that in the configuration if you need to perform refreshes more often. Doing so you run the risk of putting your cluster under a heavy load.</p>&#xA;&#xA;<p>An alternative way if you want the result of your indexing operation to be available for the next call, is to explicitly <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/near-real-time.html#refresh-api" rel="nofollow">refresh</a> your cluster and only then issue a search request.</p>&#xA;&#xA;<ol>&#xA;<li>index your document <code>PUT /my_index/doc/1</code></li>&#xA;<li>call refresh <code>POST /my_index/_refresh</code></li>&#xA;<li>send your request <code>POST /my_index/_search</code></li>&#xA;</ol>&#xA;
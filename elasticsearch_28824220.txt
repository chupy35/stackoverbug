28824220
How to restrict certain indices to a set of machines in an Elasticsearch cluster
<p>We have 2x64GB machines and 2x16GB machines in a cluster and we are creating one index per day. The requirement is to move the new index to the  64 GB machines and the old ones to the 16GB machines. How can this be done with elasticsearch?</p>&#xA;
<p>You need to "tag" your nodes and specify which is which by using a <code>node.tag</code> property: <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/index-modules-allocation.html#shard-allocation-filtering" rel="nofollow">http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/index-modules-allocation.html#shard-allocation-filtering</a>.</p>&#xA;&#xA;<p>And you specify <code>node.tag: large1</code> and <code>node.tag: large2</code> for each 64GB nodes (one for each).</p>&#xA;&#xA;<p>Then, when you create your index you specify how you want it to be allocated by using <code>"index.routing.allocation.include.tag" : "large1,large2"</code> (these are the 64GB nodes). When you decide to move the index from two nodes to the other two nodes, then you update the property above and specify <code>"small1,small2"</code> for example (smaller 16GB nodes).</p>&#xA;&#xA;<p>I would suggest having a look at <a href="https://github.com/elasticsearch/curator/wiki/Routing-Allocation" rel="nofollow">Curator</a>, as well, that can help you change these settings.</p>&#xA;
<p>This is a 2 step process</p>&#xA;&#xA;<ol>&#xA;<li>Tag your node with key value pairs. For eg: , for lesser machines tag them as boxType:small and for better machine tag them as boxType:big. </li>&#xA;<li>Next apply the <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/index-modules-allocation.html#shard-allocation-filtering" rel="nofollow noreferrer">index filter rule</a> using the settings API as below - </li>&#xA;</ol>&#xA;&#xA;<blockquote>&#xA;<pre><code>  curl -XPUT localhost:9200/index-name/_settings -d '{&#xA;        "index.routing.allocation.include.tag" : "big"&#xA;    }'&#xA;</code></pre>&#xA;</blockquote>&#xA;
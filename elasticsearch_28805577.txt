28805577
What's the difference between source filtering and the fields option in the elasticsearch get API?
<p>I'm confused between <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-get.html#get-source-filtering" rel="noreferrer">source filtering</a> (i.e. using the _source_include parameter) and the <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-get.html#get-fields" rel="noreferrer">fields</a> option of the GET API in elasticsearch. How are they different in terms of performance? When are they supposed to be used?</p>&#xA;
<p><strong>Update</strong>: re: <code>fields</code> </p>&#xA;&#xA;<p><em>Note that this is the 1.x documentation if you just arrived here from the future.</em></p>&#xA;&#xA;<blockquote>&#xA;  <p>For backwards compatibility, if the fields parameter specifies fields which are not stored (store mapping set to false), it will load the _source and extract it from it. This functionality has been replaced by the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-request-source-filtering.html" rel="nofollow noreferrer">source filtering</a> parameter.</p>&#xA;  &#xA;  <p>-- <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-request-fields.html#search-request-fields" rel="nofollow noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-request-fields.html#search-request-fields</a></p>&#xA;</blockquote>&#xA;&#xA;<hr>&#xA;&#xA;<p>AFAICT:</p>&#xA;&#xA;<p><code>_source</code> tells elasticsearch whether to include the <em>source</em> of matched documents in the response. The "source" is the data in the document as it was inserted.</p>&#xA;&#xA;<p><code>fields</code> tells elasticsearch to include <em>source</em>, but <strong>only</strong> include the defined <em>fields</em>.</p>&#xA;&#xA;<p>Permformance: Unless you have low bandwidth to the Elasticsearch server, it might be negligible.</p>&#xA;
<p>I had the same doubt, <a href="https://www.elastic.co/blog/found-managing-elasticsearch-fields-when-searching" rel="nofollow">here</a> I found what can be the answer.</p>&#xA;&#xA;<p><strong>fields</strong> restricts the fields whose contents are <strong>parsed and returned</strong> </p>&#xA;&#xA;<p><strong>_source_filtering</strong> restricts the fields which are <strong>returned</strong></p>&#xA;&#xA;<p>Another way of seeing it is to think that <em>fields</em> is used to optimize data transfer and CPU usage while <em>_source_filtering</em> only optimizes data transfer</p>&#xA;&#xA;<blockquote>&#xA;  <p>Source filtering allows us to control which parts of the original JSON document are returned for each hit[...]It's worth keeping in mind that this only saves us on bandwidth costs between the nodes participating in the search as well as the client, not CPU or Disk, as was the case when using fields.</p>&#xA;</blockquote>&#xA;&#xA;<p>In addition:</p>&#xA;&#xA;<blockquote>&#xA;  <p>One feature about fields that's not commonly known is the ability to select metadata-fields as well. Of particular note is its ability to select the _ttl-field, which actually returns the number of milliseconds until the document expires, not the original lifespan of the document. A very handy feature indeed. </p>&#xA;</blockquote>&#xA;
<p>The <code>fields</code> parameter applies only to <code>stored</code> fields. From the 2.3 documentation:</p>&#xA;&#xA;<blockquote>&#xA;  <p>Besides indexing the values of a field, you can also choose to  store&#xA;  the original field value for later retrieval. Users with a Lucene&#xA;  background use stored fields to choose which fields they would like to&#xA;  be able to return in their search results. In fact the  _source field&#xA;  is a stored field. In Elasticsearch, setting individual document&#xA;  fields to be stored is usually a false optimization. The whole&#xA;  document is already stored as the  _source field. It is almost always&#xA;  better to just extract the fields that you need using the  _source&#xA;  parameter.</p>&#xA;</blockquote>&#xA;&#xA;<p>See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-source-filtering.html" rel="nofollow">source filetring</a> for how to limit the fields returned from <code>_source</code></p>&#xA;
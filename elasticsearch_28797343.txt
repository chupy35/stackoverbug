28797343
Elasticsearch UTF-8 characters in search
<p>I have indexed record:</p>&#xA;&#xA;<p>"žiema"</p>&#xA;&#xA;<p>Elastic search settings:</p>&#xA;&#xA;<h1>index:</h1>&#xA;&#xA;<pre><code>cmpCategory: {type: string, analyzer: like_analyzer}&#xA;</code></pre>&#xA;&#xA;<h1>Analyzer</h1>&#xA;&#xA;<pre><code>analysis:&#xA;    char_filter:&#xA;        lt_characters:&#xA;            type: mapping&#xA;            mappings: ["ą=&gt;a","Ą=&gt;a","č=&gt;c","Č=&gt;c","ę=&gt;e","Ę=&gt;e","ė=&gt;e","Ė=&gt;e","į=&gt;i","Į=&gt;i","š=&gt;s","Š=&gt;s","ų=&gt;u","Ų=&gt;u","ū=&gt;u","ž=&gt;z", "Ū=&gt;u"]&#xA;    analyzer:&#xA;        like_analyzer:&#xA;            type: snowball&#xA;            tokenizer: standard&#xA;            filter   : [lowercase,asciifolding]&#xA;            char_filter : [lt_characters]&#xA;</code></pre>&#xA;&#xA;<p>What I want: </p>&#xA;&#xA;<p>By keyword "<code>žiema</code>" found record "<code>žiema</code>" AND by keyword "<code>ziema</code>" also found record "<code>žiema</code>", how to do that ? </p>&#xA;&#xA;<p>I try execute characters replace and filter <code>asciifolding</code></p>&#xA;&#xA;<p>What am I doing wrong? </p>&#xA;
<p>You can try indexing your field twice like it is shown in the <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/asciifolding-token-filter.html#_retaining_meaning" rel="nofollow">documentation</a>.</p>&#xA;&#xA;<pre><code>PUT /my_index/_mapping/my_type&#xA;{&#xA;  "properties": {&#xA;    "cmpCategory": { &#xA;      "type":           "string",&#xA;      "analyzer":       "standard",&#xA;      "fields": {&#xA;        "folded": { &#xA;          "type":       "string",&#xA;          "analyzer":   "like_analyzer"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>so the <code>cmpCategory</code> field is indexed as standard with diacritics, and the <code>cmpCategory.folded</code> field is indexed <em>without</em> diacritics.</p>&#xA;&#xA;<p>And while searching, you do the search on <em>both</em> indexes as such:</p>&#xA;&#xA;<pre><code>GET /my_index/_search&#xA;{&#xA;  "query": {&#xA;    "multi_match": {&#xA;      "type":     "most_fields",&#xA;      "query":    "žiema",&#xA;      "fields": [ "cmpCategory", "cmpCategory.folded" ]&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Also, I'm not sure if the <code>char_filter</code> is necessary since the <code>asciifolding</code> filter already does that transformation.</p>&#xA;
30323837
match_query is not working in elasticsearch
<p>I am new ElasticSearch.Recently we started using ElasticSearch in my project.&#xA;I am trying to get data based on first_name and last_name by using match_query.&#xA;I write query like this</p>&#xA;&#xA;<pre><code>{&#xA;"query":{&#xA;  "multi_match" : {&#xA;    "query": "michkel",&#xA;    "fields": [ "last_name"] &#xA;&#xA;  }&#xA;}&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>My index name is employee and it contains below documents</p>&#xA;&#xA;<pre><code>{&#xA;   "first_name":"smith",&#xA;"last_name":"michkel",&#xA;"age":25,&#xA;"doj":"2015-05-2"&#xA;},&#xA;{&#xA;   "first_name":"john",&#xA;"last_name":"smith",&#xA;"age":46,&#xA;"doj":"1989-03-25"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>when run the above query i am getting total records but my requirement is if i give  "query": "michkel" like this, then only one record is match with my documents.&#xA;Give me solutions as soon as possible &#xA;And one more question &#xA;I want to search based on user given date.My user will give date like this 1989-04-15.for this i write like below&#xA;    {&#xA;    "query":{&#xA;      " query_string" : {&#xA;        "query": "1989-04-15",</p>&#xA;&#xA;<pre><code>  }&#xA;}&#xA;}&#xA;{"error":"SearchPhaseExecutionException[Failed to execute phase [query_fetch], all shards failed; shardFailures {[du1Tb7U8QLWSnXO2m9ATCg][employee][0]: SearchParseException[[employee][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\n\"query\":{\n  \" query_string\" : {\n    \"query\": \"1989-04-15\",\n\n  }\n}\n}]]]; nested: QueryParsingException[[employee] No query registered for [ query_string]]; }]","status":400}&#xA;</code></pre>&#xA;
<p>Instead of <code>multi_match</code> use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-bool-filter.html" rel="nofollow">bool</a> filter as below :</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "filtered": {&#xA;            "query": {&#xA;                "bool": {&#xA;                    "must": [&#xA;                        {&#xA;                            "match": {&#xA;                                "last_name": "michkel"&#xA;                            }&#xA;                        }&#xA;                    ]&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>As per your edited question you should use same above in match replace as <code>"doj": "1989-04-15"</code> and if you want to find out combing both <code>last_name</code> and <code>doj</code> then use query as below :</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "filtered": {&#xA;            "query": {&#xA;                "bool": {&#xA;                    "should": [&#xA;                        {&#xA;                            "query_string": {&#xA;                                "query": "1989-04-15"&#xA;                            }&#xA;                        }&#xA;                    ],&#xA;                    "must": [&#xA;                        {&#xA;                            "match": {&#xA;                                "last_name": "michkel"&#xA;                            }&#xA;                        }&#xA;                    ]&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
28498233
Queries on ElasticSearch
<p>I have a document which look like this,  </p>&#xA;&#xA;<pre><code>{&#xA;    "_index": "w3-commsvc",&#xA;    "_type": "message",&#xA;    "_id": "h98yv662",&#xA;    "_score": 1,&#xA;    "_source": {&#xA;        "messageId": "h98yv662",&#xA;        "campaignName": "src_checkoutAbandon",&#xA;        "campaignId": "cId_w3_website",&#xA;        "states": [&#xA;            {&#xA;                "Delivered": 790709218&#xA;            },&#xA;            {&#xA;                "open": 1288775055&#xA;            },&#xA;            {&#xA;                "click": 319518555&#xA;            },&#xA;            {&#xA;                "DEFERRED": 2137606534&#xA;            }&#xA;        ],&#xA;        "clientName": "w3_website",&#xA;        "templateId": "test",&#xA;        "opens": [&#xA;            {&#xA;                "url": "www.something.com",&#xA;                "id": "t26jj783",&#xA;                "userAgent": {&#xA;                    "browser": {&#xA;                        "family": "IE",&#xA;                        "version": "11.0",&#xA;                        "major": "11",&#xA;                        "minor": "0",&#xA;                        "patch": null&#xA;                    },&#xA;                    "os": {&#xA;                        "family": "Windows_XP",&#xA;                        "version": null,&#xA;                        "versionPopularName": null,&#xA;                        "major": null,&#xA;                        "minor": null,&#xA;                        "patch": null,&#xA;                        "patchMinor": null&#xA;                    },&#xA;                    "device": {&#xA;                        "family": "Other",&#xA;                        "type": "Computer"&#xA;                    }&#xA;                },&#xA;                "timestamp": "1372366437"&#xA;            },&#xA;            {&#xA;                "url": "www.something.com",&#xA;                "id": "t98ef285",&#xA;                "userAgent": {&#xA;                    "browser": {&#xA;                        "family": "IE",&#xA;                        "version": "11.0",&#xA;                        "major": "11",&#xA;                        "minor": "0",&#xA;                        "patch": null&#xA;                    },&#xA;                    "os": {&#xA;                        "family": "Windows_XP",&#xA;                        "version": null,&#xA;                        "versionPopularName": null,&#xA;                        "major": null,&#xA;                        "minor": null,&#xA;                        "patch": null,&#xA;                        "patchMinor": null&#xA;                    },&#xA;                    "device": {&#xA;                        "family": "Other",&#xA;                        "type": "Computer"&#xA;                    }&#xA;                },&#xA;                "timestamp": "717918284"&#xA;            }&#xA;        ],&#xA;        "clicks": [&#xA;            {&#xA;                "url": "www.something.com",&#xA;                "id": " j60te707",&#xA;                "userAgent": {&#xA;                    "browser": {&#xA;                        "family": "IE",&#xA;                        "version": "11.0",&#xA;                        "major": "11",&#xA;                        "minor": "0",&#xA;                        "patch": null&#xA;                    },&#xA;                    "os": {&#xA;                        "family": "Windows_XP",&#xA;                        "version": null,&#xA;                        "versionPopularName": null,&#xA;                        "major": null,&#xA;                        "minor": null,&#xA;                        "patch": null,&#xA;                        "patchMinor": null&#xA;                    },&#xA;                    "device": {&#xA;                        "family": "Other",&#xA;                        "type": "Computer"&#xA;                    }&#xA;                },&#xA;                "timestamp": "1293320728"&#xA;            },&#xA;            {&#xA;                "url": "www.something.com",&#xA;                "id": " c63bc623",&#xA;                "userAgent": {&#xA;                    "browser": {&#xA;                        "family": "IE",&#xA;                        "version": "11.0",&#xA;                        "major": "11",&#xA;                        "minor": "0",&#xA;                        "patch": null&#xA;                    },&#xA;                    "os": {&#xA;                        "family": "Windows_XP",&#xA;                        "version": null,&#xA;                        "versionPopularName": null,&#xA;                        "major": null,&#xA;                        "minor": null,&#xA;                        "patch": null,&#xA;                        "patchMinor": null&#xA;                    },&#xA;                    "device": {&#xA;                        "family": "Other",&#xA;                        "type": "Computer"&#xA;                    }&#xA;                },&#xA;                "timestamp": "624917313"&#xA;            },&#xA;            {&#xA;                "url": "www.something.com",&#xA;                "id": " f10qm",&#xA;                "userAgent": {&#xA;                    "browser": {&#xA;                        "family": "Firefox",&#xA;                        "version": "11.0",&#xA;                        "major": "11",&#xA;                        "minor": "0",&#xA;                        "patch": null&#xA;                    },&#xA;                    "os": {&#xA;                        "family": "Windows_XP",&#xA;                        "version": null,&#xA;                        "versionPopularName": null,&#xA;                        "major": null,&#xA;                        "minor": null,&#xA;                        "patch": null,&#xA;                        "patchMinor": null&#xA;                    },&#xA;                    "device": {&#xA;                        "family": "Other",&#xA;                        "type": "Computer"&#xA;                    }&#xA;                },&#xA;                "timestamp": "334734507"&#xA;            }&#xA;        ]&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Now using the above documents i need the following answer for the following queries,  </p>&#xA;&#xA;<p>1 - I need the terms count of each state for a certain clientName.<br>&#xA;2 - Total sum of length of each opens array in the document.<br>&#xA;3 - Open and click stats for each browsers.</p>&#xA;
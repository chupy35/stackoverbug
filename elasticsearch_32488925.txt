32488925
get count of items not listed in a parent-child relationship model in elasticsearch
<p>Let's say that we have employee &amp; department types stored in an elasticsearch index. I have to get the following queries:</p>&#xA;&#xA;<ol>&#xA;<li>Count the number of employees that are assigned to any particular department (not a specific department). Note that the employee should just be assigned to some department that's it.</li>&#xA;<li>Count the number of employees that aren't assigned to any department yet</li>&#xA;</ol>&#xA;&#xA;<p>I am just over simplifying my question with a toy example to give more clarity on what is needed. </p>&#xA;&#xA;<p>Any thoughts/help on this is appreciated.</p>&#xA;
<ol>&#xA;<li>Assume that your employees type has a field like this&#xA;<code>{ "department" : "departmentXYZ" }</code>&#xA;Then you can use aggregation to get employees assigned to each department as so</li>&#xA;</ol>&#xA;&#xA;<p><code>{&#xA;    "aggs" :{&#xA;        "employees_per_department" : {&#xA;            "terms" : {&#xA;                "field" : "department"&#xA;            }&#xA;        }&#xA;    }&#xA;}</code></p>&#xA;&#xA;<ol start="2">&#xA;<li>This depends on how you store non-assign value for "department". In case it's empty string then take a look at this&#xA;<a href="https://stackoverflow.com/questions/25561981/find-documents-with-empty-string-value-on-elasticsearch">Find documents with empty string value on elasticsearch</a></li>&#xA;</ol>&#xA;
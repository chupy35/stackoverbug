28429930
Elastic search date range max, min date
<p>Hi my elastic search mapping as below </p>&#xA;&#xA;<pre><code>[&#xA;    {&#xA;    "runTimeMilliSeconds": {&#xA;        "type": "long"&#xA;    },&#xA;    "syslogMessage": {&#xA;        "properties": {&#xA;            "DATE": {&#xA;                "type": "string"&#xA;            },&#xA;            "FACILITY": {&#xA;                "type": "string"&#xA;            },&#xA;            "FILE_NAME": {&#xA;                "type": "string"&#xA;            },&#xA;            "HOST": {&#xA;                "type": "string"&#xA;            },&#xA;            "HOST_FROM": {&#xA;                "type": "string"&#xA;            },&#xA;            "ISODATE": {&#xA;                "type": "date",&#xA;                "format": "dateOptionalTime"&#xA;            },&#xA;            "LEGACY_MSGHDR": {&#xA;                "type": "string"&#xA;            },&#xA;            "MESSAGE": {&#xA;                "type": "string"&#xA;            },&#xA;            "PID": {&#xA;                "type": "string"&#xA;            },&#xA;            "PRIORITY": {&#xA;                "type": "string"&#xA;            },&#xA;            "PROGRAM": {&#xA;                "type": "string"&#xA;            },&#xA;            "SOURCE": {&#xA;                "type": "string"&#xA;            }&#xA;        }&#xA;    }&#xA;    }&#xA;]&#xA;</code></pre>&#xA;&#xA;<p>Now I want to find out last six hours data so I write following query </p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;    "match_all": {&#xA;    }&#xA;    },&#xA;    "aggs": {&#xA;    "last_6_hours": {&#xA;        "filter": {&#xA;            "range": {&#xA;                "ISODATE": {&#xA;                    "gte": "now-6h",&#xA;                    "lte": "now"&#xA;                }&#xA;            }&#xA;        },&#xA;        "aggs": {&#xA;            "date_wise_logs_counts": {&#xA;                "date_histogram": {&#xA;                    "field": "ISODATE",&#xA;                    "interval": "1h"&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I return results as below </p>&#xA;&#xA;<pre><code>{&#xA;    "aggregations": {&#xA;    "last_6_hours": {&#xA;        "doc_count": 1933,&#xA;        "date_wise_logs_counts": {&#xA;            "buckets": [&#xA;                {&#xA;                    "key_as_string": "2015-02-10T04: 00: 00.000Z",&#xA;                    "key": 1423540800000,&#xA;                    "doc_count": 342&#xA;                },&#xA;                {&#xA;                    "key_as_string": "2015-02-10T05: 00: 00.000Z",&#xA;                    "key": 1423544400000,&#xA;                    "doc_count": 1591&#xA;                }&#xA;            ]&#xA;        }&#xA;    }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>But my problem Is that I want to find out max and min time , for example in above output <code>doc_count = 342</code> so I want the range from date where this count generate so my desired output as below </p>&#xA;&#xA;<pre><code>{&#xA;    "aggregations": {&#xA;    "last_6_hours": {&#xA;        "doc_count": 1933,&#xA;        "date_wise_logs_counts": {&#xA;            "buckets": [&#xA;                {&#xA;                    "key_as_string": "2015-02-10T04: 00: 00.000Z",&#xA;                    "key": 1423540800000,&#xA;                    "doc_count": 342,&#xA;                    "max": 1423540800000,&#xA;                    "min": 1423537239000&#xA;                },&#xA;                {&#xA;                    "key_as_string": "2015-02-10T05: 00: 00.000Z",&#xA;                    "key": 1423544400000,&#xA;                    "doc_count": 1591,&#xA;                    "max": 1423544400000,&#xA;                    "min": 1423540800000&#xA;                }&#xA;            ]&#xA;        }&#xA;    }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>From above output I predict that <code>doc_count = 342</code> coming from time intrval from <code>1423540800000</code> to  <code>1423537239000</code>. And I used elastic search version 1.4.0</p>&#xA;
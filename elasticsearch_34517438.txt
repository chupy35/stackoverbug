34517438
Elasticsearch tags aggregation with specific keys
<p>I have an array field with tags and fixed list of 10 most popular tags (I got it from previous terms aggregations call).</p>&#xA;&#xA;<p>Can I determine document counts for current search exactly with this keys (tags from my array)? Like terms aggregation, but for specific keys only.</p>&#xA;&#xA;<p>Thanks!</p>&#xA;
<p>Take a look at <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html#_filtering_values_2" rel="nofollow">filtering terms aggregations</a>, especially the <code>include</code> parameter. It would be easier to show you if you provided a specific example of your problem, but here is the example from the docs that should help you figure out how to solve your problem:</p>&#xA;&#xA;<pre><code>{&#xA;    "aggs" : {&#xA;        "JapaneseCars" : {&#xA;             "terms" : {&#xA;                 "field" : "make",&#xA;                 "include" : ["mazda", "honda"]&#xA;             }&#xA;         },&#xA;        "ActiveCarManufacturers" : {&#xA;             "terms" : {&#xA;                 "field" : "make",&#xA;                 "exclude" : ["rover", "jensen"]&#xA;             }&#xA;         }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
<p>You can use <strong>include</strong> or <strong>exclude</strong> keywords inside <strong>aggregations</strong> to filter your keys.</p>&#xA;&#xA;<pre><code>{&#xA;  "size": 0,&#xA;  "aggs": {&#xA;    "my_agg": {&#xA;      "terms": {&#xA;        "field": "agg_field",&#xA;        "include": [key1,key2,key3]&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
30757282
Elasticsearch. Nested field type and raw string subfield
<p>I has mapping:</p>&#xA;&#xA;<pre>&#xA;&#xA;    {&#xA;       "properties":{&#xA;          <i>/*some fields ommited*/,</i>&#xA;          "properties":{&#xA;             "type":"nested",&#xA;             "properties":{&#xA;                "FieldA":{&#xA;                   "type":"string",&#xA;                   "fields":{&#xA;                      "raw":{&#xA;                         "index":"not_analyzed",&#xA;                         "type":"string"&#xA;                      }&#xA;                   }&#xA;                }&#xA;             }&#xA;          }&#xA;       }&#xA;    }&#xA;&#xA;</pre>&#xA;&#xA;<p>and some documents:</p>&#xA;&#xA;<pre>&#xA;&#xA;    {&#xA;      <i>/*some fields ommited*/,</i>&#xA;       "properties":{&#xA;          "FieldA":"one"&#xA;       }&#xA;    }&#xA;&#xA;    {&#xA;      <i>/*some fields ommited*/,</i>&#xA;       "properties":{&#xA;          "FieldA":"two"&#xA;       }&#xA;    }&#xA;&#xA;</pre>&#xA;&#xA;<p>and so on.</p>&#xA;&#xA;<p>I try to make query:</p>&#xA;&#xA;<pre>&#xA;&#xA;    {&#xA;      "query": {&#xA;        "nested": {&#xA;          "query": {&#xA;            "term": {&#xA;              "FieldA.raw": "one"&#xA;            }&#xA;          },&#xA;          "path": "properties"&#xA;        }&#xA;      }&#xA;    }&#xA;&#xA;</pre>&#xA;&#xA;<p>There are no results found. If i try to use the same query by field with other type (not string, and without <strong>raw</strong> subfield) it works. How should i write query for that case? Thanks!</p>&#xA;&#xA;<p>P.S. field "FieldA" has subfield <strong>raw</strong> because i need this field to be analyzed and not analyzed at the same time</p>&#xA;
<p>You just need to specify the full path to the nested field:</p>&#xA;&#xA;<pre><code>{&#xA;   "query": {&#xA;      "nested": {&#xA;         "path": "properties",&#xA;         "query": {&#xA;            "term": {&#xA;               "properties.FieldA.raw": "one"&#xA;            }&#xA;         }&#xA;      }&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here is some code I used to test it:</p>&#xA;&#xA;<p><a href="http://sense.qbox.io/gist/f2d9e5eae7496ca0fce8d2d23e17bf4d72d9300a" rel="nofollow">http://sense.qbox.io/gist/f2d9e5eae7496ca0fce8d2d23e17bf4d72d9300a</a></p>&#xA;
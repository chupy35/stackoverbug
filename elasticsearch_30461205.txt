30461205
ElasticSearch Unassigned Shard
<p>I have 2 nodes in elastic search cluster with 8 CPU and 16 GB RAM. I have set ES_HEAP_SIZE to 10 GB.</p>&#xA;&#xA;<p>In my yml configuration file on both machines i have set </p>&#xA;&#xA;<pre><code>index.number_of_shards: 5&#xA;index.number_of_replicas: 1&#xA;</code></pre>&#xA;&#xA;<p>And both machines are allowed as master/data true.Now problem is my 0th shard of node 1 is unassigned after restart.I tried</p>&#xA;&#xA;<pre><code>for shard in $(curl -XGET http://localhost:9201/_cat/shards | grep UNASSIGNED | awk '{print $2}'); do&#xA;    echo "processing $shard"&#xA;    curl -XPOST 'localhost:9201/_cluster/reroute' -d '{&#xA;        "commands" : [ {&#xA;              "allocate" : {&#xA;                  "index" : "inxn", &#xA;                  "shard" : '$shard', &#xA;                  "node" : "node1", &#xA;                  "allow_primary" : true&#xA;              }&#xA;            }&#xA;        ]&#xA;    }'&#xA;done&#xA;</code></pre>&#xA;&#xA;<p>it does not give any error and says acknowledged true and show status of shard to initialize but when i view shard its still uninitialized.</p>&#xA;&#xA;<p>Am I doing anything wrong in setting? Should I make both node as master/data true and on both machines set shard:5 and replica:1</p>&#xA;&#xA;<p>Any help or suggestion would be greatly appreciated.</p>&#xA;&#xA;<p>Thanks</p>&#xA;
<p>I did a trick to solve the same , I renamed 0 folder under indices on node1 and did a force full assign 0th shard on node1 and it worked for me.</p>&#xA;&#xA;<pre><code>curl -XPOST 'localhost:9201/_cluster/reroute' -d '{&#xA;        "commands" : [ {&#xA;              "allocate" : {&#xA;                  "index" : "inxc", &#xA;                  "shard" : 0, &#xA;                  "node" : "node1", &#xA;                  "allow_primary" : true&#xA;              }&#xA;            }&#xA;        ]&#xA;    }'&#xA;</code></pre>&#xA;
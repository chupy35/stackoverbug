34351094
Elasticsearch date match in index name doesn't work
<ul>&#xA;<li>Elasticsearch: <code>2.1</code></li>&#xA;<li>Timezone: <code>+0800</code></li>&#xA;<li>Index: <code>nginx-2015.12.18</code></li>&#xA;<li>Current Time: <code>2015-12-18 16:08</code></li>&#xA;</ul>&#xA;&#xA;<p>According to <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/date-math-index-names.html" rel="nofollow">doc</a> following query will resolve to index <code>nginx-2015.12.18</code></p>&#xA;&#xA;<p><code>curl -XGET 'localhost:9200/&lt;nginx-{now/d}&gt;/_search'</code> </p>&#xA;&#xA;<p>But, in reality it gives</p>&#xA;&#xA;<pre><code>{"error":{"root_cause":[{"type":"index_not_found_exception","reason":"no such index","resource.type":"index_or_alias","resource.id":"&lt;nginx-now","index":"&lt;nginx-now"}],"type":"index_not_found_exception","reason":"no such index","resource.type":"index_or_alias","resource.id":"&lt;nginx-now","index":"&lt;nginx-now"},"status":404}&#xA;</code></pre>&#xA;&#xA;<hr>&#xA;&#xA;<p>curl 'localhost:9200/_cat/indices?v'</p>&#xA;&#xA;<blockquote>&#xA;  <p>â‹Š> ~ curl 'localhost:9200/_cat/indices?v'                                                                                                                                                                                             16:31:35</p>&#xA;</blockquote>&#xA;&#xA;<pre><code>health status index              pri rep docs.count docs.deleted store.size pri.store.size &#xA;yellow open   nginx                5   1         18            0    120.7kb        120.7kb &#xA;yellow open   wx-data-2015.12.18   5   1          2            0      9.6kb          9.6kb &#xA;yellow open   nginx-2015.12.18     5   1          5            0       33kb           33kb&#xA;</code></pre>&#xA;
<p>As it turns out, this is a <a href="https://github.com/elastic/elasticsearch/issues/13665" rel="nofollow">known issue</a>, This is what @javanna said,</p>&#xA;&#xA;<blockquote>&#xA;  <p>we had initially treated this as a bug and fixed it, but afterwards we&#xA;  found out that the fix introduced a regression (<a href="https://github.com/elastic/elasticsearch/issues/14177" rel="nofollow">#14177</a>), which made us&#xA;  take a step back. Any slash that should not be used as a path&#xA;  separator in a uri should be properly escaped, and it is wrong to try&#xA;  and make distinctions between the different slashes on the server side&#xA;  depending on what surrounds them, that heuristic is not going to fly&#xA;  (in fact it didn't :) )</p>&#xA;  &#xA;  <p>We are going to revert the initial fix then, the solution to this&#xA;  problem is to <strong>escape the '/' in the url</strong> like this: curl -XGET&#xA;  <code>'localhost:9200/&lt;logstash-{now%2Fd}&gt;/animals/1'</code>. That is going to work&#xA;  and didn't require any fix in the first place.</p>&#xA;</blockquote>&#xA;&#xA;<p>I also had to escape the <code>{}</code>, This worked for me on <code>ES 2.0</code></p>&#xA;&#xA;<pre><code>curl -XGET 'localhost:9200/&lt;nginx-\{now%2Fd\}&gt;/_search'&#xA;</code></pre>&#xA;&#xA;<p>Does this help?</p>&#xA;
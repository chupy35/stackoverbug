34020138
Elastic search query according to MySQL Group by clause
<p>I am using Elasticsearch I want to write a query for getting unique record on the basis of query and group:</p>&#xA;&#xA;<pre><code>SELECT * from users where name='%john%', age='21', location='New York' group by name&#xA;</code></pre>&#xA;&#xA;<p>Could you please let me know how to write the query in elasticsearch with query.</p>&#xA;
<p>It would go something like this. You need a filtered query with a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-query-string-query.html" rel="nofollow"><code>query_string</code></a> in the query part to match <code>*john*</code> and then two filters in the <code>filter</code> part to match the <code>age</code> and the <code>location</code>. Finally, the grouping is achieved using a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-aggregations-bucket-terms-aggregation.html" rel="nofollow"><code>terms</code></a> aggregation.</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "query": {&#xA;      "query_string": {&#xA;        "query": "*john*",&#xA;        "default_field": "name"&#xA;      }&#xA;    },&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "bool": {&#xA;          "must": [&#xA;            {&#xA;              "term": {&#xA;                "age": 21&#xA;              }&#xA;            },&#xA;            {&#xA;              "term": {&#xA;                "location": "New York"&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  },&#xA;  "aggs": {&#xA;    "group_by_name": {&#xA;      "terms": {&#xA;        "field": "name"&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
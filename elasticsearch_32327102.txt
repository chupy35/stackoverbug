32327102
Retrieving a document at replica shard while it is not yet updated data
<p>I have a question with Elasticsearch as below:</p>&#xA;&#xA;<p>In mode replication is async, while a document is being indexed, the document will already be present on the primary shard but not yet copied to the replica shards. At this time, a GET request for this document is forwarded to a replica shard. </p>&#xA;&#xA;<p>How does Elasticsearch handle this in the cases the document is not yet indexed on the replica shards or the document is not yet updated on the replica shards ?</p>&#xA;&#xA;<p>A fail request will be returned in the case indexing a new document or a old document returned in the case updating a document? Or requesting node will re-forward to the primary shard to get data?</p>&#xA;
<p>First of all, I wouldn't recommend using the async mode. It doesn't really provides any benefits that you couldn't achieve in a safer way but creates issues when in comes to reliability. Because of this, this feature was deprecated in v1.5 and completely <a href="https://github.com/elastic/elasticsearch/issues/10114" rel="nofollow">removed</a> in v2.0 of elasticsearch.</p>&#xA;&#xA;<p>Saying that, if you still want to use async and care about getting the latest results, you have to use it with <code>primary</code> <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html#preference" rel="nofollow">preference</a>.</p>&#xA;&#xA;<p>In case of <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html" rel="nofollow">update</a> operation, you don't have to do anything. Update is always performed on the primary shard first and then the result of the operation is replicated to all replicas.</p>&#xA;
33262699
Aggregation of absolute values in ElasticSeach
<p>How to write query to aggregate absolute values in Elasticsearch. For example, aggregation of absolute values of the field <code>grade</code>:</p>&#xA;&#xA;<pre><code>{&#xA;"aggs" : {&#xA;    "avg_grade" : { "avg" : { "field" : "grade" } }&#xA;   }&#xA;</code></pre>&#xA;&#xA;<p>}&#xA;This computes the average of numeric values in <code>grade</code> like this:</p>&#xA;&#xA;<pre><code>{&#xA;...&#xA;&#xA;"aggregations": {&#xA;    "avg_grade": {&#xA;        "value": 75&#xA;     }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>How to include <code>abs(grade)</code> to cater for negative <code>grade</code></p>&#xA;
<p>I can see 2 solutions:</p>&#xA;&#xA;<ul>&#xA;<li>Use transform  script in mappings to make your values positive <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-transform.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-transform.html</a></li>&#xA;<li>Use scripted  aggregation <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-scripted-metric-aggregation.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-scripted-metric-aggregation.html</a></li>&#xA;</ul>&#xA;
33950981
Finding duplicate documents
<p>I have some documents whose ids are randomly generated. The issue here is I need to find the duplicates amongst these documents. I have three fields which should not be identical for two documents. So how to check for duplicates based on multiple fields?</p>&#xA;&#xA;<p>Sample documents</p>&#xA;&#xA;<pre><code>document 1 = {&#xA;"process" : "business",&#xA;"processId" : 5433321,&#xA;"country" : "US"&#xA;}&#xA;&#xA;document 2 = {&#xA;"process" : "operations",&#xA;"processId" : 334233,&#xA;"country" : "UK"&#xA;}&#xA;&#xA;document 3 = {&#xA;"process" : "business",&#xA;"processId" : 5433321,&#xA;"country" : "US"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Here as you can see, document 1 and document 3 are the same, but they are having different Ids in my database,so exist as separate documents. So on run I need to find the above as duplicates and if possible keep only one.</p>&#xA;
<p>The best option here would be to model your document around doc ID. Now for each unique document , create a docID which is a hash of the content of the document. This makes sure that only one unique document exists across the index. Next use _create API to create documents. This will fail all requests on over write document with same document ID.</p>&#xA;&#xA;<p>You can further read about other duplication issues and its solutions <a href="https://qbox.io/blog/minimizing-document-duplication-in-elasticsearch" rel="nofollow">here</a>.</p>&#xA;
31329180
Elasticsearch - equivalent of LEFT JOIN
<p>I have 20,000,000 line items in Elasticsearch that I am happily searching (it's working amazingly well).</p>&#xA;&#xA;<p>There is an added dimension though that I don't know how to solve:</p>&#xA;&#xA;<p>A user can "buy" those items (in batches of 1,000 to 100,000) and I need my search to only return the items that they have not previously "bought". I'd solve this with a LEFT JOIN in SQL.</p>&#xA;&#xA;<p>I could add a boughtBy[] field to each item, but then I would need to update lots of documents every time a user buys. Feels kind of wrong?</p>&#xA;
<p>Elasticsearch uses Lucene which supports blockjoin. In Elasticsearch that is <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/parent-child.html" rel="nofollow">Parent-Child Relationships</a>. It gives you a join but it also comes with limitations (it's no longer possible to arbitrarily distribute documents across nodes, memory requirements can explode in certain scenarios).</p>&#xA;&#xA;<p>Elasticsearch documentation gives you <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/relations.html" rel="nofollow">a nice overview of the relationship modelling options</a>.</p>&#xA;&#xA;<p>If you need deep joins, more complex relationships, etc., you might consider looking into the <a href="http://siren.solutions/siren/overview/" rel="nofollow">SIREn plugin</a>.</p>&#xA;&#xA;<p><em>(disclaimer: I currently work for the company that develops SIREn)</em></p>&#xA;
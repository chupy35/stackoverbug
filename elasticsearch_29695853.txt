29695853
Combine search terms automatically when with Elasticssearch?
<p>Using elasticsearch for searching our documents we discovered that when we search for "wave board" we get no good results, because documents containing "waveboard" are not at the top of the results. Google does this kind of "term combining". Is there a simple way to do this in ES?</p>&#xA;
<p>Found a good solution: Create a custom anaylzer with a shingle filter using "" as a token separator and use that in a query (use bool query to combine with standard queries)</p>&#xA;
<p>To do this at analysis time, you can also use what is know as a "decompounding"&#xA;token filter. Here is an example to decompound the text "catdogmouse" into the&#xA;tokens "cat", "dog", and "mouse":</p>&#xA;&#xA;<pre><code>POST /decom&#xA;{&#xA;  "settings": {&#xA;    "index": {&#xA;      "analysis": {&#xA;        "analyzer": {&#xA;          "decom_analyzer": {&#xA;            "type": "custom",&#xA;            "tokenizer": "standard",&#xA;            "filter": ["decom_filter"]&#xA;          }&#xA;        },&#xA;        "filter": {&#xA;          "decom_filter": {&#xA;            "type": "dictionary_decompounder",&#xA;            "word_list": ["cat", "dog", "mouse"]&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  },&#xA;  "mappings": {&#xA;    "doc": {&#xA;      "properties": {&#xA;        "body": {&#xA;          "type": "string",&#xA;          "analyzer": "decom_analyzer"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And then you can see how they are applied to certain terms:</p>&#xA;&#xA;<pre><code>POST /decom/_analyze?field=body&amp;pretty&#xA;racecatthings&#xA;{&#xA;  "tokens" : [ {&#xA;    "token" : "racecatthings",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 14,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "cat",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 14,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  } ]&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>And another: (you should be able to extrapolate this to separate "waveboard"&#xA;into "wave" and "board")</p>&#xA;&#xA;<pre><code>POST /decom/_analyze?field=body&amp;pretty&#xA;catdogmouse&#xA;{&#xA;  "tokens" : [ {&#xA;    "token" : "catdogmouse",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 12,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "cat",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 12,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "dog",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 12,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  }, {&#xA;    "token" : "mouse",&#xA;    "start_offset" : 1,&#xA;    "end_offset" : 12,&#xA;    "type" : "&lt;ALPHANUM&gt;",&#xA;    "position" : 1&#xA;  } ]&#xA;}&#xA;</code></pre>&#xA;
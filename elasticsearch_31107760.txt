31107760
Score documents based on missing fields in elasticsearch
<p>I have two fields rank and attendance. If rank field is missing , show those documents first and if attendance is missing , show them before the other one. So order would be , first one with both attendance and ranking missing. Second set with any of them missing. &#xA;How can I do this using script?</p>&#xA;
<p>This query should do it:</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "bool": {&#xA;      "should": [&#xA;        {&#xA;          "filtered": {&#xA;            "filter": {"missing": {&#xA;              "field": "rank"&#xA;            }}&#xA;          }&#xA;        },&#xA;        {&#xA;          "filtered": {&#xA;            "filter": {"missing": {&#xA;              "field": "attendance"&#xA;            }}&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_all": {}&#xA;        }&#xA;      ]&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The basic idea is that the <code>should</code>s conditions of a boolean query will each add something to the score of the document. If one field is missing, then an additional score is added up, if another field is missing the score increases. If none of them matches, then just the <code>match_all</code> query is considered for scoring.</p>&#xA;&#xA;<p>The order is the default one: after score, ascending. The more fields missing the better the score.</p>&#xA;
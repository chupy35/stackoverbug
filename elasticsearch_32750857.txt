32750857
Inconsistent total count for Elasticsearch phrase_prefix match query
<p>We have an elasticsearch cluster with 2 nodes, each node containing a total of 10 shards (5 primary, 5 replica). Both the nodes are in sync with each other.</p>&#xA;&#xA;<p>When we execute a phrase_prefix match query (similar to the one mentioned below) multiple times, we get up to 4 different total hits in the response.</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "query": {&#xA;        "bool": {&#xA;          "must": [&#xA;            {&#xA;              "match": {&#xA;                "field.subfield": {&#xA;                  "query": "11",&#xA;                  "type": "phrase_prefix"&#xA;                }&#xA;              }&#xA;            }&#xA;          ]&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>There is no special mapping for the field we are querying, it is just a string.</p>&#xA;&#xA;<p>I'm trying to figure out why the total hits would vary, without any changes in the index. Is there something obvious that I have missed?</p>&#xA;&#xA;<p>Any ideas about why this could happen?</p>&#xA;&#xA;<p>Cheers.</p>&#xA;
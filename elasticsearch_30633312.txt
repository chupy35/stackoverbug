30633312
How to get distinct results in ElasticSearch if a field is the same
<p>I have an ElasticSearch service version 1.4 with an index 40M record of data.</p>&#xA;&#xA;<p>I have data that has the same parent field. I would like to extract 1 unique result out of the same parent only.</p>&#xA;&#xA;<p>Ex: </p>&#xA;&#xA;<pre><code>{&#xA;    "id": "7835",&#xA;    "isbn": "3985",&#xA;    "parent_id": "7819",&#xA;},&#xA;{&#xA;    "id": "1835",&#xA;    "isbn": "4935",&#xA;    "parent_id": "7719",&#xA;},&#xA;{&#xA;    "id": "2835",&#xA;    "isbn": "9985",&#xA;    "parent_id": "7819",&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>The expected result that I would like to have is:</p>&#xA;&#xA;<pre><code>{&#xA;    "id": "7835",&#xA;    "isbn": "3985",&#xA;    "parent_id": "7819",&#xA;},&#xA;{&#xA;    "id": "1835",&#xA;    "isbn": "4935",&#xA;    "parent_id": "7719",&#xA;},&#xA;</code></pre>&#xA;&#xA;<p>I have checked out aggregations:&#xA;<a href="https://stackoverflow.com/questions/25465215/elasticsearch-return-unique-values">ElasticSearch - Return Unique Values</a></p>&#xA;&#xA;<pre><code>{&#xA;    "aggs" : {&#xA;    "parentId" : {&#xA;        "terms" : { "field" : "parent_id" }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>However the response I get - show the 3 items (so the last one doesn't get ignored), and I have term buckets with the key afterwards inside the aggregations response, which to me is not useful as it seems to tell me how many occurrence per key inside the doc, which is not the desired output.</p>&#xA;
<p>In order not to search for original document, you should add <code>"size":0</code> above aggregation.</p>&#xA;&#xA;<p>You can see only the number of documents per each <code>parent_id</code> in <code>buckets</code> field of response.</p>&#xA;&#xA;<pre><code>{&#xA;    "size" : 0,&#xA;    "aggs" : {&#xA;    "parentId" : {&#xA;        "terms" : { "field" : "parent_id" }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;
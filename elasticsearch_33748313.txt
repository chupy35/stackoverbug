33748313
Elasticsearch - what's the best way to search conditions with both suggester and other filters?
<p>How to convert query condition from a relational database like:</p>&#xA;&#xA;<p><code>select ... from ... where name like 'ABC%' and grade = 3 and city = 'Munich'</code></p>&#xA;&#xA;<p>To ElasticSearch query string?</p>&#xA;&#xA;<p>The <code>name like 'ABC%'</code> is a prefix search, which I prefer use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters-completion.html" rel="nofollow">Completion Suggester</a>. While it seems cannot add other filters to <code>Completion Suggester</code>. How to handle <code>grade = 3 and city = 'Munich'</code> conditions?</p>&#xA;&#xA;<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/suggester-context.html" rel="nofollow">Context Suggester</a> does not help because <code>grade</code> and <code>city</code> options are too many.</p>&#xA;
<p>How about this query?</p>&#xA;&#xA;<pre><code>{&#xA;  "query": {&#xA;    "bool": {&#xA;      "must": [&#xA;        {&#xA;          "match": {&#xA;            "city": "Munich"&#xA;          }&#xA;        },&#xA;        {&#xA;          "term": {&#xA;            "grade": {&#xA;              "value": "2"&#xA;            }&#xA;          }&#xA;        },&#xA;        {&#xA;          "match_phrase_prefix": {&#xA;            "name": "abc"&#xA;          }&#xA;        }&#xA;      ]&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I think you can simulate sql like with <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html#query-dsl-match-query-phrase-prefix" rel="nofollow">match_phrase_prefix</a></p>&#xA;&#xA;<p>Does this help?</p>&#xA;
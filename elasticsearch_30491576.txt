30491576
ElasticSearch aggregation query customized field
<p>I am just wondering for a aggregation query in ES, is that possible to utilize the returned bucket for your own purpose. For example if I have response result like this:</p>&#xA;&#xA;<pre><code>        {&#xA;           "key": "test",&#xA;           "doc_count": 2000,&#xA;           "child": {&#xA;              "value": 1000&#xA;           }&#xA;        }&#xA;</code></pre>&#xA;&#xA;<p>And I want to get the ratio of doc_count and value, so I am looking for a way to generate another field/aggregation to do the math of those two fields, like this:</p>&#xA;&#xA;<pre><code>        {&#xA;           "key": "test",&#xA;           "doc_count": 2000,&#xA;           "child": {&#xA;              "value": 1000&#xA;           },&#xA;           "ratio" : 2&#xA;        }&#xA;</code></pre>&#xA;&#xA;<p>or</p>&#xA;&#xA;<pre><code>        {&#xA;           "key": "test",&#xA;           "doc_count": 1997,&#xA;           "child": {&#xA;              "value": 817&#xA;           },&#xA;           "buckets": [&#xA;              {&#xA;               "key": "ratio",&#xA;               "value": 2&#xA;              }&#xA;            ]&#xA;        }&#xA;</code></pre>&#xA;
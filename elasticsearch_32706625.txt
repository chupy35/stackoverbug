32706625
Elastic search indexing document
<p>Im a newbie to Elasticsearch and trying to understand the basics of it.</p>&#xA;&#xA;<p>I followed the tutorial and installed ES. Now, Im trying to index a document as mentioned here - </p>&#xA;&#xA;<pre><code>https://www.elastic.co/guide/en/elasticsearch/guide/current/_indexing_employee_documents.html&#xA;</code></pre>&#xA;&#xA;<p>but it throws me error.</p>&#xA;&#xA;<p>Should I create my index first before I try to index the document?</p>&#xA;&#xA;<p>Also, What commands are being used here? Are those CURL commands?</p>&#xA;&#xA;<pre><code>import requests&#xA;r = requests.get('http://localhost:9200/megacorp')&#xA;&#xA;print r.status_code&#xA;print r.text&#xA;r = requests.get('http://localhost:9200/twitter')&#xA;&#xA;print r.status_code&#xA;print r.text&#xA;~            &#xA;</code></pre>&#xA;&#xA;<p>response</p>&#xA;&#xA;<pre><code>200&#xA;{"megacorp":{"aliases":{},"mappings":{"employee":{"properties":{"first_name":{"type":"string"},"last_name":{"type":"string"}}}},"settings":{"index":{"creation_date":"1442881963974","uuid":"5bISz0kqTdyjYgz-Hv548Q","number_of_replicas":"1","number_of_shards":"5","version":{"created":"1070299"}}},"warmers":{}}}&#xA;200&#xA;{"twitter":{"aliases":{},"mappings":{},"settings":{"index":{"creation_date":"1443018283701","uuid":"3DS6RZPYTWuX0-ah18e-Ww","number_of_replicas":"2","number_of_shards":"3","version":{"created":"1070299"}}},"warmers":{}}}&#xA;</code></pre>&#xA;&#xA;<p>Error in logs:</p>&#xA;&#xA;<pre><code>SearchRequest@2e5f4063] lastShard [true]&#xA;org.elasticsearch.search.SearchParseException: [megacorp][3]: from[-1],size[-1]: Parse Failure [Failed to parse source [{"facets":{"0":{"date_histogram":{"key_field":"@timestamp","value_field":"primaries.indexing.index_total","interval":"1y"},"global":true,"facet_filter":{"fquery":{"query":{"filtered":{"query":{"query_string":{"query":"_type:indices_stats"}},"filter":{"bool":{"must":[{"match_all":{}}]}}}}}}}},"size":50,"query":{"filtered":{"query":{"query_string":{"query":"_type:cluster_event OR _type:node_event"}},"filter":{"bool":{"must":[{"match_all":{}}]}}}},"sort":[{"@timestamp":{"order":"desc","ignore_unmapped":true}},{"@timestamp":{"order":"desc","ignore_unmapped":true}}]}]]&#xA;    at org.elasticsearch.search.SearchService.parseSource(SearchService.java:747)&#xA;    at org.elasticsearch.search.SearchService.createContext(SearchService.java:572)&#xA;    at org.elasticsearch.search.SearchService.createAndPutContext(SearchService.java:544)&#xA;    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:306)&#xA;    at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:231)&#xA;    at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:228)&#xA;    at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:559)&#xA;    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&#xA;    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&#xA;    at java.lang.Thread.run(Thread.java:745)&#xA;Caused by: org.elasticsearch.search.facet.FacetPhaseExecutionException: Facet [0]: (key) field [@timestamp] not found&#xA;    at org.elasticsearch.search.facet.datehistogram.DateHistogramFacetParser.parse(DateHistogramFacetParser.java:172)&#xA;    at org.elasticsearch.search.facet.FacetParseElement.parse(FacetParseElement.java:93)&#xA;    at org.elasticsearch.search.SearchService.parseSource(SearchService.java:731)&#xA;</code></pre>&#xA;
<p>You can use curl to execute those commands, just watch all the quotes, etc. For example, here is the first PUT command from that tutorial with some fields removed:</p>&#xA;&#xA;<p>curl -X PUT -d "{ \"first_name\": \"John\", \"last_name\": \"Smith\" }" localhost:9200/megacorp/employee/1</p>&#xA;&#xA;<p>It will create the index and add the document.</p>&#xA;&#xA;<p>If you go to <a href="http://localhost:9200/_plugin/head/" rel="nofollow">http://localhost:9200/_plugin/head/</a> you should be able to see your index. The Browser tab on that page will let you see what is in your index.</p>&#xA;&#xA;<p>The megacorp index and the employee mapping will be created using sensible defaults, in some applications you may want to define those explicitly if you disagree with the defaults. </p>&#xA;&#xA;<p>Forgot to mention... if this doesn't solve your problem, please post the error you are getting.</p>&#xA;
<p>You have to create an index first, before indexing documents. For creating an index, you can issue a POST request. An example curl request for creating an index is </p>&#xA;&#xA;<pre><code>curl -XPOST "http://localhost:9200/test_index"&#xA;</code></pre>&#xA;&#xA;<p>This will return an acknowledge of true.&#xA;Now you can index document like</p>&#xA;&#xA;<pre><code>curl -XPOST "http://localhost:9200/test_index/test_type" -d "{\"name\" : \"This is my name\", \"age\" : 25}"&#xA;</code></pre>&#xA;
31542155
How to model this mysql table relationship in elastic search
<p>I have a large amount of shop items imported into elastic search and I can query them.</p>&#xA;&#xA;<p>I am wondering how best to model the following mysql table relationship into elastic search:</p>&#xA;&#xA;<p>Shop items can have different offers. There are different offer types. And in some shops an item may be on offer, in other shops the item may not be on offer or have a different offer type. Items don't have to have offers. I model this below:</p>&#xA;&#xA;<h2>Items table</h2>&#xA;&#xA;<pre><code>item_id&#xA;</code></pre>&#xA;&#xA;<h2>Offers table</h2>&#xA;&#xA;<pre><code>shop_id, item_id, offer_type, user_id&#xA;</code></pre>&#xA;&#xA;<p>Where user_id is the id of the user who created the offer.</p>&#xA;&#xA;<p>So as an example, item_id 1 and shop_id's 1,2 and offer_types premium and featured.</p>&#xA;&#xA;<p>Then the offers table could look like:</p>&#xA;&#xA;<pre><code>shop_id, item_id, offer_type, user_id&#xA;1,1,featured,45&#xA;2,1,premium,33&#xA;2,1,featured,45&#xA;</code></pre>&#xA;&#xA;<p>But it's not the case that every item is on offer. And even if item_id 1 is on offer in shops 1 and 2, it might not be on offer in other shops.</p>&#xA;&#xA;<p>I want to be able to query my /items type and it will only be for one shop at a time but for that shop I want to get all the items in e.g. a certain price range and of a certain category (that i can do all ready), but I need to know for each item in the results what offer they have if any (e.g. if featured, premium or whatever offer_type).</p>&#xA;&#xA;<p>How can I best model this behaviour in elastic search? </p>&#xA;
<p>One approach is Nested Object relationship - Shop contains set of items with id as your shop id</p>&#xA;&#xA;<p>For your cases &#xA;1) Get all items of a shop - GET: <a href="http://host/your_index/shops_type/shopid" rel="nofollow">http://host/your_index/shops_type/shopid</a></p>&#xA;&#xA;<p>This will give you all items in a shop along with offer_type. you can filter in your program logic </p>&#xA;
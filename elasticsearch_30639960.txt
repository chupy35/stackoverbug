30639960
Error when creating an index using mappings file
<p>I installed Elasticsearch 1.5.2 on CentOS as a service.&#xA;I tried to add mappings using PUT:</p>&#xA;&#xA;<pre><code>curl -XPUT $ES_HOST/my_index -d'&#xA;{&#xA;  "mappings": {&#xA;    "my_type": {&#xA;      "properties": {&#xA;        "field": {&#xA;          "type": "nested"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>That request works fine and creates new index with correct mappings. &#xA;Instead of putting mappings manually I want to store mappings on server in config files. For that I created file <code>/etc/elasticsearch/mappings/my_index/all_mappings.json</code> with the same content as previous request body. After that I'm trying to create index <code>curl -XPUT $ES_HOST/my_index</code> but the error occurs </p>&#xA;&#xA;<pre><code>{&#xA;    "error": "MapperParsingException[mapping [all_mappings]]; nested: &#xA;                MapperParsingException[Root type mapping not empty after parsing! &#xA;                Remaining fields:   [mappings : {my_type={properties={field={type=nested}}}}]]; ",&#xA;    "status": 400&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>I tried to remove <code>mappings</code> field in config json but nothing changed.</p>&#xA;
<p>The name of the file is the mapping name. So, for <code>/mappings/my_index/all_mappings.json</code> you should have the index <code>my_index</code> and the <code>type</code> called <code>all_mappings</code>.</p>&#xA;&#xA;<p>Also, the content of the file should be:</p>&#xA;&#xA;<pre><code>   {&#xA;     "properties": {&#xA;        "field": {&#xA;          "type": "nested"&#xA;        }&#xA;      }&#xA;    }&#xA;</code></pre>&#xA;&#xA;<p>These being said, do the following:</p>&#xA;&#xA;<ul>&#xA;<li>create a <code>my_type.json</code> file under <code>/etc/elasticsearch/mappings/my_index</code> folder</li>&#xA;<li>put inside that file the following:</li>&#xA;</ul>&#xA;&#xA;&#xA;&#xA;<pre><code>   {&#xA;     "properties": {&#xA;        "field": {&#xA;          "type": "nested"&#xA;        }&#xA;      }&#xA;    }&#xA;</code></pre>&#xA;&#xA;<ul>&#xA;<li>call <code>PUT /test_my_index</code></li>&#xA;<li>check the mapping: <code>GET /test_my_index/_mapping</code></li>&#xA;</ul>&#xA;
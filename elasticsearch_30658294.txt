30658294
How to sort the fields when the numbers are entered as strings,in elasticsearch?
<p>This is a sample of the document I have indexed using elasticsearch.</p>&#xA;&#xA;<pre><code>{&#xA;&#xA;"itemName": "refridgirator"&#xA;"brand": "samsung"&#xA;"price": "1600"&#xA;"emi": "40"&#xA;"location":"Brisbane"&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>As you can see from the above document that,all the numerical fields such as "price" and "emi" are entered as strings. Now as I need to sort my indexed documents in the basis of this value,Im not able to do that. How can I make it done?</p>&#xA;
<p>In the mapping , you need to specify this as long or int.&#xA;That way , the number would be stored as long in the reverse index and field data cache and actual number sort will work out - </p>&#xA;&#xA;<pre><code>curl -X PUT "http://$hostname:9200/your_index/your_type/_mapping" -d '{&#xA;  "yout_type": {&#xA;    "properties": {&#xA;      "price": {&#xA;        "type": "long"&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>You can find more info <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-core-types.html" rel="nofollow">here</a>.&#xA;Also an alternate method by parsing string values have been discussed in detail in this <a href="http://blog.qbox.io/elasticsearch-scripting-sorting" rel="nofollow">blog</a></p>&#xA;
<p>In your mapping, you need to declare the <code>price</code> and <code>emi</code> fields as <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-core-types.html#number" rel="nofollow">number type</a> (double, float, integer, etc) like this:</p>&#xA;&#xA;<pre><code>// remove the current index&#xA;curl -XDELETE localhost:9200/your_index&#xA;&#xA;// create the index anew&#xA;curl -XPUT localhost:9200/your_index -d '&#xA;{&#xA;  "mappings": {&#xA;    "your_type": {&#xA;      "properties": {&#xA;        "itemName": {&#xA;          "type": "string"&#xA;        },&#xA;        "brand": {&#xA;          "type": "string"&#xA;        },&#xA;        "price": {&#xA;          "type": "double"&#xA;        },&#xA;        "emi": {&#xA;          "type": "integer"&#xA;        },&#xA;        "location": {&#xA;          "type": "string"&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>And then when you re-index your documents, make sure the <code>price</code> and <code>emi</code> fields in your JSON are numbers as well and not strings (i.e. without the double quotes):</p>&#xA;&#xA;<pre><code>curl -XPOST localhost:9200/your_index/your_type/123 -d '&#xA;{&#xA;  "itemName": "refridgirator",&#xA;  "brand": "samsung",&#xA;  "price": 1600,&#xA;  "emi": 40,&#xA;  "location": "Brisbane"&#xA;}'&#xA;</code></pre>&#xA;
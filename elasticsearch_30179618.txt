30179618
Include Child Documents in Elastic Search Query
<p>I am trying to include child documents into a query with elastic search, but I cannot figure it out. I have an entity called posts that has an optional parent to support a parent child hierarchy. I am hoping to do a query on the parent or top level items and include the top child with the results, preventing doing multiple calls to elastic search.</p>&#xA;&#xA;<p>Mapping</p>&#xA;&#xA;<pre><code>{&#xA;  "mappings": {&#xA;    "post": {&#xA;      "_parent": {&#xA;        "type": "post"&#xA;      },&#xA;      "id": { "type": "integer"},&#xA;      "text": { "type": "string"},&#xA;      "parent_id": { "type": "integer"},&#xA;      "rank": { "type": "integer"}&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Desired Response</p>&#xA;&#xA;<pre><code>{&#xA;  "hits": {&#xA;    "total": 10,&#xA;    "max_score": null,&#xA;    "hits": [&#xA;      {&#xA;        "id": 1,&#xA;        "text": "test",&#xA;        "parent_id": null,&#xA;        "rank": 10,&#xA;        "topResponse": {&#xA;          "id": 2,&#xA;          "text": "test response",&#xA;          "parent_id": null,&#xA;          "rank": 4&#xA;        }&#xA;      },&#xA;      {&#xA;        "id": 1,&#xA;        "text": "test 2",&#xA;        "parent_id": null,&#xA;        "rank": 8,&#xA;        "topResponse": {&#xA;          "id": 2,&#xA;          "text": "test response",&#xA;          "parent_id": null,&#xA;          "rank": 3&#xA;        }&#xA;      },&#xA;      {&#xA;        "id": 1,&#xA;        "text": "test 3",&#xA;        "parent_id": null,&#xA;        "rank": 6,&#xA;        "topResponse": {&#xA;          "id": 2,&#xA;          "text": "test response",&#xA;          "parent_id": null,&#xA;          "rank": 1&#xA;        }&#xA;      }&#xA;    ]&#xA;  }&#xA;}&#xA;</code></pre>&#xA;
32497482
Valid value range(not query range) for date format in Elasticsearch
<p>What is the valid value range? For example, is it like Epoch Timestamp or we could add values like 1536-22-05?</p>&#xA;&#xA;<h2>What have I tried so far?</h2>&#xA;&#xA;<p>Well it's not a matter of trying. I've just started to work with elasticsearch, and I'm working on my schema. For the date part, I was wondering if it would compare dates which were for hundreds of years ago, and no matter how much I searched I didn't find a straight answer. So I felt like there should be an answer to this question somewhere, thus I asked it here, just for the sake of having it somewhere.</p>&#xA;&#xA;<p>To answer the above question I added the following values:</p>&#xA;&#xA;<pre><code>{&#xA;   "took": 3,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 3,&#xA;      "max_score": 1,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "pezeshkyab",&#xA;            "_type": "test",&#xA;            "_id": "1",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "mydate": "1369-05-09"&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "pezeshkyab",&#xA;            "_type": "test",&#xA;            "_id": "2",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "mydate": "1379-05-09"&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "pezeshkyab",&#xA;            "_type": "test",&#xA;            "_id": "3",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "mydate": "1990-05-09"&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>and then executed this query:</p>&#xA;&#xA;<pre><code>POST /pezeshkyab/test/_search&#xA;{&#xA;    "query": {&#xA;        "range": {&#xA;            "mydate": {&#xA;                "gt": "1359-01-01",&#xA;                "lt": "1399-12-12"&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>and got this:</p>&#xA;&#xA;<pre><code>{&#xA;   "took": 74,&#xA;   "timed_out": false,&#xA;   "_shards": {&#xA;      "total": 5,&#xA;      "successful": 5,&#xA;      "failed": 0&#xA;   },&#xA;   "hits": {&#xA;      "total": 2,&#xA;      "max_score": 1,&#xA;      "hits": [&#xA;         {&#xA;            "_index": "pezeshkyab",&#xA;            "_type": "test",&#xA;            "_id": "1",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "mydate": "1369-05-09"&#xA;            }&#xA;         },&#xA;         {&#xA;            "_index": "pezeshkyab",&#xA;            "_type": "test",&#xA;            "_id": "2",&#xA;            "_score": 1,&#xA;            "_source": {&#xA;               "mydate": "1379-05-09"&#xA;            }&#xA;         }&#xA;      ]&#xA;   }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>So the answer is pretty obvious, I just wanted to put the answer somewhere so that future searches by other people would yield some result.</p>&#xA;
<p>The problem is most likely that your "mydate" field is not being stored in ES as a date.  </p>&#xA;&#xA;<p>Here is a sample that explicitly sets "f2" as a date in ES, this will allow for proper querying/filtering.</p>&#xA;&#xA;<pre><code>PUT test&#xA;&#xA;PUT /test/_mapping/type1&#xA;{&#xA;    "type1" : {&#xA;        "properties" : {&#xA;            "f1" : {"type" : "string"},&#xA;            "f2" : {"type" : "date"}&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;--verify the mapping&#xA;GET test/type1/_mapping&#xA;&#xA;POST test/type1&#xA;{&#xA;  "f1": "record 1",&#xA;  "f2": "2000-01-01"&#xA;}&#xA;&#xA;POST test/type1&#xA;{&#xA;  "f1": "record 2",&#xA;  "f2": "1500-01-01"&#xA;}&#xA;&#xA;GET test/type1/_search&#xA;{&#xA;  "query": {&#xA;    "filtered": {&#xA;      "filter": {&#xA;        "range": {&#xA;          "f2": {&#xA;            "gte": "1500-01-01",&#xA;            "lte": "1999-01-01"&#xA;          }&#xA;        }&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>With this sample code "record 2" is correctly returned while "record 1" is excluded.</p>&#xA;
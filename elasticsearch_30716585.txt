30716585
Specify multifield on an array item - elasticsearch
<p>How do I specify a multifield index mapping that targets a property inside an array?</p>&#xA;&#xA;<p>For example</p>&#xA;&#xA;<pre><code> Document&#xA; --------&#xA; ID: 1&#xA; Title: Some title goes here&#xA; Content: Some content goes here&#xA; SubDocuments:[{"Title:"Some title"},{"Title:"Some title"}]&#xA;</code></pre>&#xA;&#xA;<p>How can I specify an index mapping that targets Title inside SubDocuments to have touched and untouched variations?</p>&#xA;&#xA;<p>Thanks</p>&#xA;
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-array-type.html" rel="nofollow">Arrays</a> are supported out of the box by Elasticsearch and they don't need a specific mapping. You simply need to map the <code>SubDocuments</code> field as an <code>object</code> (or <code>nested</code> object) and then the <code>Title</code> field as a multi-field in that object.</p>&#xA;&#xA;<pre><code>{&#xA;    "your_type" : {&#xA;        "properties" : {&#xA;            "ID" : {"type" : "long"},&#xA;            "Title" : {"type" : "string"},&#xA;            "Content" : {"type" : "string"},&#xA;            "SubDocuments" : {&#xA;                "properties" : {&#xA;                    "Title" : {&#xA;                        "type" : "string",&#xA;                        "fields": {&#xA;                            "raw": {&#xA;                                "type" : "string",&#xA;                                "index" : "not_analyzed",&#xA;                            }&#xA;                        }&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>It is worth noting that if you envision to add other fields to <code>SubDocuments</code> and you need to query on those <code>SubDocuments</code> fields, it might be wiser to map <code>SubDocuments</code> as <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-nested-type.html" rel="nofollow"><code>nested</code> type</a>, like this:</p>&#xA;&#xA;<pre><code>{&#xA;    "your_type" : {&#xA;        "properties" : {&#xA;            "ID" : {"type" : "long"},&#xA;            "Title" : {"type" : "string"},&#xA;            "Content" : {"type" : "string"},&#xA;            "SubDocuments" : {&#xA;                "type": "nested",           &lt;---- add this&#xA;                "properties" : {&#xA;                    "Title" : {&#xA;                        "type" : "string",&#xA;                        "fields": {&#xA;                            "raw": {&#xA;                                "type" : "string",&#xA;                                "index" : "not_analyzed",&#xA;                            }&#xA;                        }&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Then, in your documents, <code>SubDocuments.Title</code> will be the field containing the analyzed variation and <code>SubDocuments.Title.raw</code> will be another field containing the exact and non-analyzed string value.</p>&#xA;
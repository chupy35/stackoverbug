30388698
To get hits inside aggregations,in elasticsearch
<p>I have a date field inside my data. I did a date histogram aggregation on it,with interval set as month. Now it returns,the number of documents per month,interval.&#xA;Here is the query I used:</p>&#xA;&#xA;<pre><code>{&#xA;    "aggs": {&#xA;        "dateHistogram": {&#xA;            "date_histogram": {&#xA;                "field": "currentDate",&#xA;                "interval": "day"&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Below the exact response I have received.</p>&#xA;&#xA;<pre><code>  {&#xA;      "aggregations": {&#xA;          "dateHistogram": {&#xA;              "buckets": [{&#xA;                  "key_as_string": "2015-05-06",&#xA;                  "key": 1430870400000,&#xA;                  "doc_count": 10&#xA;              }, {&#xA;                  "key_as_string": "2015-04-06",&#xA;                  "key": 1430870500000,&#xA;                  "doc_count": 14&#xA;              }]&#xA;          }&#xA;      }&#xA;  }&#xA;</code></pre>&#xA;&#xA;<p>From the above response it is clear that,there are 10 documents under the key "1430870400000" and 14 documents under the key "1430870500000". But despite from the document count,the individual documents are not shown. I want them to be shown in the response,so that I can take values out from it. How do I achieve this in elasticsearch?</p>&#xA;
<p>As per my understanding you want to fetch all documents and used that documents for <code>aggregations</code> so you should use match query with aggregation as below :</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "bool": {&#xA;            "must": [&#xA;                {&#xA;                    "match_all": {}&#xA;                }&#xA;            ]&#xA;        }&#xA;    },&#xA;    "aggs": {&#xA;        "date_wise_logs_counts": {&#xA;            "date_histogram": {&#xA;                "field": "currentDate",&#xA;                "interval": "day"&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>Above return default <code>10</code> documents in <code>hit array</code>, use  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-from-size.html#search-request-from-size" rel="nofollow">size</a>  <code>size=BIGNUMBER</code> to get more than 10 items. (where BIGNUMBER equals a number you believe is bigger than your dataset). But you should use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-search-type.html" rel="nofollow">scan and scroll</a> instead of <code>size</code></p>&#xA;
<p>The easy method for this is using the "top-hits" aggregation. You can find the usage of "top-hits" <a href="https://stackoverflow.com/questions/30388698/to-get-hits-inside-aggregations-in-elasticsearch">here</a></p>&#xA;&#xA;<p>Top-hits aggregation will give you the relevant data inside the aggregation you have done and also there are options to specify from which result you want to fetch,and the size of the data you want to be taken and also sort options.</p>&#xA;
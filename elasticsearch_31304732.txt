31304732
Trying to understand how to update a mapping without requiring a complete rebuild of the index?
<p>From this page: <a href="https://www.elastic.co/blog/changing-mapping-with-zero-downtime" rel="nofollow">https://www.elastic.co/blog/changing-mapping-with-zero-downtime</a> it states:</p>&#xA;&#xA;<blockquote>&#xA;  <p>I don't care about old data&#xA;  What if you want to change the datatype for a single field, and you don't care about the fact that the old data is not searchable? In this case, you have a few options:</p>&#xA;  &#xA;  <p>Delete the mapping&#xA;  If you delete the mapping for a specific type, then you can use the put_mapping API. to create a new mapping for that type in the existing index.</p>&#xA;</blockquote>&#xA;&#xA;<p>...</p>&#xA;&#xA;<p>My situation is, I have a column that was a string, and I want to change it to a long...  According to that document, it sounds like I should just be able to do:</p>&#xA;&#xA;<pre><code>curl -X DELETE localhost:9200/my_index/_mapping/property_to_change&#xA;</code></pre>&#xA;&#xA;<p>and then do</p>&#xA;&#xA;<pre><code>curl -XPUT 'http://localhost:9200/my_index/_mapping/property_to_change' -d '&#xA;{&#xA;    "my_index" : {&#xA;        "properties" : {&#xA;            "property_to_change" : {"type" : "long", "store" : true }&#xA;        }&#xA;    }&#xA;}&#xA;'&#xA;</code></pre>&#xA;&#xA;<p>Am I misunderstanding this?  Do I really have to go through the trouble of creating an alias?   is there not a simple way I can just change this one property's type?</p>&#xA;&#xA;<p>I find the documentation regarding this topic high confusing and contradictory.. for example this page <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping-intro.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping-intro.html</a>&#xA;says:</p>&#xA;&#xA;<blockquote>&#xA;  <p>You can specify the mapping for a type when you first create an index. Alternatively, you can add the mapping for a new type (or update the mapping for an existing type) later, using the /_mapping endpoint.</p>&#xA;</blockquote>&#xA;&#xA;<p>Which sounds like -- ok cool. that's exactly what I want to do.</p>&#xA;&#xA;<p>But then the next paragraph says:</p>&#xA;&#xA;<blockquote>&#xA;  <p>Although you can add to an existing mapping, you canâ€™t change it. If a field already exists in the mapping, the data from that field probably has already been indexed. If you were to change the field mapping, the already indexed data would be wrong and would not be properly searchable.</p>&#xA;</blockquote>&#xA;&#xA;<p>I thought it just said you can update the mapping?  now it says you can't change it?  Sooo confused.</p>&#xA;&#xA;<p>Can anyone please shed some light on this?</p>&#xA;
<p>You can't change mappings for existing fields. In Elasticsearch parlance, a <em>type</em> is a class of similar documents for which you can put an updated mapping (which adds new field mappings) but you can't change an existing mapping for a field.</p>&#xA;&#xA;<p>For example, given a <code>documents</code> type which contains mapping for <code>title</code> and <code>tags</code> fields, you could PUT an updated mapping for the type which adds a mapping for an <code>author</code> field, but you couldn't change <code>tags</code> from one type to another, or change the mapping options or whatnot.</p>&#xA;&#xA;<p>If you want to change your field from a string to a long, you're going to need to drop the index (or the mapping for the type, which is equivalent if the index only contains the one type), create a new index with your desired mapping, and then reindex your data into it.</p>&#xA;
<blockquote>&#xA;  <p>Alternatively, you can add the mapping for a new type (or update the mapping for an existing type) later, using the /_mapping endpoint.</p>&#xA;</blockquote>&#xA;&#xA;<p><code>Update</code> here <strong>doesn't</strong> mean you can do whatever you want with that field, implicitly changing the type. There are very few things that you can change to an existing field. For example, one of them is described in the <a href="https://www.elastic.co/blog/changing-mapping-with-zero-downtime" rel="nofollow">sub-section called "Upgrade to a multi-field"</a>.</p>&#xA;&#xA;<p>But, if you want to change the type from <code>string</code> to <code>long</code> or vice-versa or change the <code>index</code> from <code>analyzed</code> to <code>not_analyzed</code> or any other change that will potentially affect how the field content is being kept in the index itself, this is not possible.</p>&#xA;
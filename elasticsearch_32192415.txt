32192415
change _score in elasticsearch to make equal to doc's score field
<p>I have score (integer) field in data, I'm getting data from api, and posting it directly to localhost:9200//listings/&#xA;And I want the item _score to be equal to score field in data.</p>&#xA;&#xA;<p>For now a solution is to add <code>?sort=score:desc</code> to url</p>&#xA;
<p>One solution is to use a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html" rel="nofollow"><code>function_score</code></a> query, where you replace the default <code>_score</code> using a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html#function-field-value-factor" rel="nofollow"><code>field_value_factor</code></a> score function. It goes like this:</p>&#xA;&#xA;<pre><code>curl -XPOST localhost:9200/listings/_search -d '{&#xA;  "query": {&#xA;    "function_score": {&#xA;      "functions": [&#xA;        {&#xA;          "field_value_factor": {&#xA;              "field": "score",         &lt;---- we use the score field instead&#xA;              "factor": 1,              &lt;---- take the exact same score&#xA;              "missing": 1              &lt;---- use 1 as score if the score field is missing&#xA;          }&#xA;        }&#xA;      ],&#xA;      "query": {&#xA;        "match_all": {}&#xA;      },&#xA;      "boost_mode": "replace"           &lt;---- we're replacing the default _score&#xA;    }&#xA;  }&#xA;}'&#xA;</code></pre>&#xA;&#xA;<p>So we're basically computing the score using the <code>score</code> field multiplied by 1 and if any document doesn't have the <code>score</code> field we just assume the score to be 1 (you can change that to whatever makes more sense in your case).</p>&#xA;&#xA;<p><strong>UPDATE</strong></p>&#xA;&#xA;<p>According to your comment, you need the <code>_score</code> to be multiplied by the document's <code>score</code> field. You can achieve it simply by removing the <code>boost_mode</code> parameter, the default <code>boost_mode</code> is to <code>multiply</code> the <code>_score</code> with whatever value comes out of the <code>field_value_factor</code> function.</p>&#xA;&#xA;<p>If you need to completely replace the default scoring mechanism to be based on your <code>score</code> field instead, there's a more complex way using the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-similarity.html" rel="nofollow"><code>similarity</code> module</a>, where you can define another similarity algorithm solely for your <code>score</code> field. There is a great <a href="https://www.elastic.co/blog/found-similarity-in-elasticsearch" rel="nofollow">blog post</a> explaining the nitty gritty details of the similarity module.</p>&#xA;
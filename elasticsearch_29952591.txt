29952591
Elasticsearch doesn't return results for a specific term search
<p>I am attempting to do a query where I filter on term for a specific term. This is the query I am attempting to run:</p>&#xA;&#xA;<pre><code>{&#xA;    "query": {&#xA;        "filtered": {&#xA;            "filter": {&#xA;                "term": {&#xA;                    "tags": "sports"&#xA;                }&#xA;            }&#xA;        }&#xA;    },&#xA;    "sort": {&#xA;        "timestamp": "desc"&#xA;    }&#xA;}&#xA;</code></pre>&#xA;&#xA;<p>When I run the same query with a different field <code>(ex: "type": "blog_post")</code> it works, so I am confident in the syntax.</p>&#xA;&#xA;<p>I checked to make sure that <code>tags</code> was properly mapped (I checked at "<a href="http://server_name/index/_mapping" rel="nofollow">http://server_name/index/_mapping</a>") and it was.</p>&#xA;&#xA;<p>I also checked that there are documents with <code>"tags" : "sports"</code> in Elasticsearch.</p>&#xA;&#xA;<p>Any ideas what the issue could be? It is only that field, all others work, and <code>"tags"</code> is indexed.</p>&#xA;
<p>Based on a use case you've described I assume <code>tags</code> is mapped as an array of values. That said, <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.3/query-dsl-term-filter.html" rel="nofollow"><code>term filter</code></a> can only be used for <strong>exact matches</strong>.</p>&#xA;&#xA;<p>What I would try is to use <a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-terms-filter.html" rel="nofollow"><code>terms filter</code></a> or <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.3/query-dsl-exists-filter.html" rel="nofollow"><code>exist filter</code></a> instead and change the query to this:</p>&#xA;&#xA;<pre><code>"terms" : { "tags" : "sports" }&#xA;</code></pre>&#xA;&#xA;<p>or this</p>&#xA;&#xA;<pre><code>"exists" : { "tags" : "sports" }&#xA;</code></pre>&#xA;
<p>What is the mapping/analyzer you have defined for the field "tags"? If you have not defined any analyzer then it will be analysed using the standard analyzer which in turn will give stemmed token "sport" instead of "sports"</p>&#xA;&#xA;<p>If you do a term search or term filter the input is not analyzed, and will try to search for an exact match. So search for term "sports" won't match.</p>&#xA;&#xA;<p>You should either change the mapping for tags to "not_analyzed" or change the search query to something other than term, like <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.x/query-dsl-query-string-query.html" rel="nofollow">query string query</a>.</p>&#xA;
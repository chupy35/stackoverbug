32224578
filtering values in elasticsearch
<p>I want to get the counts for two items in a column from my indexer in elastic search. There is a column called "category" in my indexer and it contains multiple entries. In which I am interested to get 'billing' and 'expenditure' for multiple dates. For which, I have written the below query and it is not working for two values. I can pull a single value either "billing" or "expenditure" but not two at once.</p>&#xA;&#xA;<pre><code> {"dates": &#xA;{"date_histogram": &#xA;    {"field": "createdDateTime",&#xA;        "interval": "day"},&#xA;&#xA;        "aggs": {"fields": &#xA;            {"term": &#xA;                {"field": "type",&#xA;                  "include": ["billing", "expenditure"]&#xA;&#xA;&#xA;&#xA;                }}}}}&#xA;</code></pre>&#xA;&#xA;<p>The above code is not working in this case, to make it work I need to change the "include" line to </p>&#xA;&#xA;<pre><code>"include": "billing"&#xA;</code></pre>&#xA;&#xA;<p>or&#xA;    "include": "expenditure"</p>&#xA;&#xA;<p>It would be great help, if someone look into this and help.:)</p>&#xA;&#xA;<p>Below answers are working for my post above, now I have come across one more problem with the above post that:</p>&#xA;&#xA;<p>In my 'type' field, I want to filter one more value called "spent on". Here the problem is -- ES considers this two worded word as two terms and the result is not as expected. Please help in this. Just want to filter this two worded word as a single word instead of two.</p>&#xA;
<p>The <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html#_filtering_values" rel="nofollow">include</a> expects a regex pattern. As @jgr pointed out this is true only for versions of elasticsearch &lt; 1.5.0. So for the example provided in query&#xA;would look something as below for versions &lt; 1.5.0 :</p>&#xA;&#xA;<pre><code>   "aggs": {&#xA;      "aggterm": {&#xA;         "terms": {&#xA;            "field": "type",&#xA;            "include" : "billing|expenditure"&#xA;         }&#xA;      }&#xA;   }&#xA;</code></pre>&#xA;&#xA;<p>If not the example you have in the OP should work</p>&#xA;
<p>From ES docs( <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.5/search-aggregations-bucket-terms-aggregation.html?q=terms%20agg#_filtering_values" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/1.5/search-aggregations-bucket-terms-aggregation.html?q=terms%20agg#_filtering_values</a>):</p>&#xA;&#xA;<blockquote>&#xA;  <p>It is possible to filter the values for which buckets will be created.&#xA;  This can be done using the include and exclude parameters which are&#xA;  based on regular expression strings or arrays of exact values [1.5.0]&#xA;  Added in 1.5.0. support for arrays of values.</p>&#xA;</blockquote>&#xA;&#xA;<p>So its possible to use array since 1.5 version</p>&#xA;&#xA;<pre><code>  "aggs": {&#xA;      "aggterm": {&#xA;         "terms": {&#xA;            "field": "type",&#xA;            "include" : ["billing", "expenditure"]&#xA;         }&#xA;      }&#xA;   }&#xA;</code></pre>&#xA;